---
layout: post
title:   Claude 使用笔记
date:   2025-12-29 16:52:00
categories: 大模型
tags: claude skill mcp
excerpt: Claude 使用笔记
mathjax: true
permalink: /claude
---

* content
{:toc}

# Claude 使用笔记

## Claude Code

Claude Code 是 Anthropic 推出的Agent编码工具，支持在终端运行，理解代码库，并通过自然语言命令帮助用户更快的编写代码，功能和Cursor类似。

Claude Code 可直接在终端运行：自动收集并理解项目上下文，再按需遍历整个代码库，无须手动将文件加入上下文。

更令人惊喜的是，Claude Code在处理跨文件编辑方面的能力几乎无人能敌。

### 安装

Mac 安装

```sh
# MacOS（Homebrew）：
brew install --cask claude-code
# MacOS、Linux、WSL：
curl -fsSL https://claude.ai/install.sh | bash
# npm 安装
# 【2025-12-29】报错
# npm ERR! code UNABLE_TO_GET_ISSUER_CERT_LOCALLY
# npm ERR! unable to get local issuer certificate
# 解决：临时忽略 SSL 验证，通过关闭 SSL 验证来解决此问题，但请注意这可能会降低安全性。
npm config set strict-ssl false
# 安装完成后，建议恢复为 true：
npm config set strict-ssl true

# 设置代理
npm config set proxy http://127.0.0.1:2080
npm config set https-proxy http://127.0.0.1:2080
# 安装
npm install -g @anthropic-ai/claude-code

# 验证是否安装成功：
claude-code --version # 2.0.76 (Claude Code)
claude-code --help
```

设置 ANTHROPIC_API_KEY

需要设置 Anthropic API 密钥作为环境变量：

方法 A：临时设置（当前会话有效）

export ANTHROPIC_API_KEY="your-api-key-here"

方法 B：永久设置（添加到 shell 配置文件）

打开终端并确定使用的 shell：echo $SHELL

根据 shell 类型编辑相应的配置文件：
- 对于 bash：`~/.bash_profile` 或 `~/.bashrc`
- 对于 zsh：`~/.zshrc`


在配置文件末尾添加以下行：export ANTHROPIC_API_KEY="your-api-key-here"
重新加载配置文件：`source ~/.zshrc` # 或 `source ~/.bash_profile`

方法 C：使用配置文件
- 创建配置文件 `~/.anthropic/config.json`：

```json
{
  "api_key": "your-api-key-here"
}
```

2. 可选环境变量
- ANTHROPIC_API_BASE：自定义 API 端点（如果需要）
- CLAUDE_CODE_MODEL：指定默认使用的模型（如：claude-3-5-sonnet-20241022）


#### 国内使用

如何在国内合法、安全地使用上 Claude Code? 

```sh
npm install -g https://gaccode.com/claudecode/install --registry=https://registry.npmmirror.com
```

报错

```sh
npm error code UNABLE_TO_GET_ISSUER_CERT_LOCALLY
npm error errno UNABLE_TO_GET_ISSUER_CERT_LOCALLY
```

启动 claude，报错：
>  Failed to connect to api.anthropic.com: UNABLE_TO_GET_ISSUER_CERT_LOCALLY

【2025-12-29】实践有效，解法：
- 在 ~/.claude.json 中添加：

```json
"hasCompletedOnboarding": true,
```


### 使用命令

基本使用命令

```sh
# 1. 初始化配置
claude-code init
# 2. 交互式对话
claude-code chat
# 3. 代码分析
claude-code analyze [文件或目录路径]
# 4. 文件操作
# 读取文件
claude-code read [文件路径]
# 编辑文件
claude-code edit [文件路径]
# 5. 项目分析
# 分析整个项目
claude-code project [项目目录]
# 搜索代码
claude-code search "搜索模式" [目录]
# 6. 获取帮助
# 查看所有命令
claude-code --help
# 查看特定命令帮助
claude-code [命令] --help
```


### 原理

框架 
1. 收集上下文——理解错误指向什么、代码库的哪部分受影响、哪些文件相关。
2. 制定计划——决定如何解决问题，比如修改代码并运行测试验证修复。
3. 执行操作——实际实施方案，通过更新文件和运行命令。

关键点: 第一步和最后一步都要求助手与外部世界交互——读取文件、获取文档、运行命令或编辑代码

![](https://priv-sdn-001.mowen.cn/mo/file/meta/14/90/31/2004186061168033793.png)

Claude 系列模型（Opus、Sonnet、Haiku）在理解工具作用并高效使用工具来完成复杂任务方面尤其强。

强工具使用的好处
- 解决更难的任务——Claude 能组合不同工具处理复杂工作，并能使用它未见过的工具。
- 可扩展的平台——你可以轻松为 Claude Code 添加新工具，Claude 会随你的工作流演进而适应使用。
- 更好的安全性——Claude Code 能在无需索引的情况下导航代码库，通常意味着不必把整个代码库发送到外部服务器。


### 使用

【2025-12-25】[Claude Code 实战](https://note.mowen.cn/detail/1_ZEnLT5BCYVsix54iB77)
- 官方 [Claude-code-in-action](https://anthropic.skilljar.com/claude-code-in-action)


- 第一部分介绍什么是Claude Code;
  - 用 Claude Code 执行软件开发任务，涵盖 AI 编码助手的底层架构、实用落地技巧，以及高级集成策略
- 第二部分主要介绍了如何上手去操作；
- 第三部分介绍了进阶操作：Hooks And SDK。

#### 什么是 Claude Code

内容
1. 理解编码助手架构：了解 AI 助手如何通过工具集成与代码库交互，以及支撑代码分析与修改的技术基础。
2. 探索 Claude Code 的工具系统：学习如何组合使用多种工具，处理各类开发场景中的复杂、多步骤编程任务。
3. 掌握上下文管理技巧：学习在对话中保持相关上下文，并有效引用项目资源以获得最佳 AI 协助。
4. 实现可视化沟通工作流：理解如何使用视觉输入沟通界面改动，并在复杂代码库修改中利用高级规划功能。
5. 创建自定义自动化：探索如何构建可复用的自定义命令与自动化，简化重复性开发任务。
6. 用 MCP 服务器扩展能力：学习集成外部工具与服务，实现如浏览器自动化与专用开发工作流等增强能力。
7. 集成 GitHub 工作流：理解如何搭建自动化代码审查流程，将 AI 协助融入现有版本控制工作流。
8. 应用思考与规划模式：学习在不同复杂度的编程挑战中何时、如何使用不同的推理方式。




# 结束
