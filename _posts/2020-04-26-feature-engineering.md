---
layout: post
title:  "ç‰¹å¾å·¥ç¨‹-Fearture Engineering"
date:   2020-04-26 21:50:00
categories: æœºå™¨å­¦ä¹ 
tags: æ·±åº¦å­¦ä¹  ç‰¹å¾å·¥ç¨‹ tensorflow sklearn ç‰¹å¾ å¯è§£é‡Š
excerpt: ç‰¹å¾å·¥ç¨‹ç‚¹ç‚¹æ»´æ»´ï¼ŒåŠscikit-learnå®ç°
author: é¹¤å•¸ä¹å¤©
mathjax: true
---

* content
{:toc}

# æ€»ç»“

`ç‰¹å¾å·¥ç¨‹`å’Œ`ç‰¹å¾é€‰æ‹©`å¯¹äºç»“æœçš„å½±å“æ¯”æœºå™¨å­¦ä¹ æ¨¡å‹çš„é€‰æ‹©æ›´ä¸ºé‡è¦ã€‚
- æ–¯å¦ç¦å¤§å­¦æ•™æˆï¼ŒCoursera ä¸Šè‘—åçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ä¸»è®²è€å¸ˆ `Andrew Ng` å°±æ›¾ç»è¡¨ç¤ºï¼šâ€œåŸºæœ¬ä¸Šï¼Œæ‰€è°“æœºå™¨å­¦ä¹ åº”ç”¨ï¼Œå°±æ˜¯è¿›è¡Œç‰¹å¾å·¥ç¨‹ã€‚â€

æ±Ÿæ¹–åè¨€ï¼š<font color='red' size=5 face='é»‘ä½“'>æ•°æ®å’Œç‰¹å¾å†³å®šäº†æœºå™¨å­¦ä¹ çš„ä¸Šé™ï¼Œè€Œæ¨¡å‹å’Œç®—æ³•åªæ˜¯é€¼è¿‘è¿™ä¸ªä¸Šé™è€Œå·²</font>
- [img](http://images2015.cnblogs.com/blog/927391/201606/927391-20160628112051062-1290708859.jpg)
- ![](http://images2015.cnblogs.com/blog/927391/201606/927391-20160628112051062-1290708859.jpg)


## å‚è€ƒèµ„æ–™

- çŸ¥ä¹ï¼š[ç‰¹å¾å·¥ç¨‹åˆ°åº•æ˜¯ä»€ä¹ˆ](https://www.zhihu.com/question/29316149)
- [ä½¿ç”¨sklearnåšç‰¹å¾å·¥ç¨‹](http://www.cnblogs.com/jasonfreak/p/5448385.html)
- [ä½¿ç”¨pythonè¿›è¡Œæè¿°æ€§ç»Ÿè®¡](http://www.cnblogs.com/jasonfreak/p/5441512.html)
- [ä½¿ç”¨sklearnä¼˜é›…çš„è¿›è¡Œæ•°æ®æŒ–æ˜](http://www.cnblogs.com/jasonfreak/p/5448462.html)
- ä½¿ç”¨sklearnè¿›è¡Œé›†æˆå­¦ä¹ :[ç†è®º](http://www.cnblogs.com/jasonfreak/p/5657196.html),[å®è·µ](http://www.cnblogs.com/jasonfreak/p/5720137.html)
- ã€2021-1-2ã€‘[Amazing-Feature-Engineering](https://github.com/ashishpatel26/Amazing-Feature-Engineering)ï¼Œç‰¹å¾å·¥ç¨‹å’Œç‰¹å¾é€‰æ‹©ä»£ç å®æˆ˜ï¼ˆåŒ…å«å¤šä¸ªnotebookï¼‰
  - A Short Guide for Feature Engineering and Feature Selection
Feature engineering and selection is the art/science of converting data to the best way possible, which involve an elegant blend of domain expertise, intuition and mathematics. This guide is a concise reference for beginners with most simple yet widely used techniques for feature engineering and selection. Any comments and commits are most welcome.
- ã€2021-5-27ã€‘[æ¨ç†æ€§èƒ½æå‡ä¸€å€ï¼ŒTensorFlow Feature Column æ€§èƒ½ä¼˜åŒ–å®è·µ](https://blog.csdn.net/weixin_38753262/article/details/116810950)ï¼Œåœ¨ CTR(Click Through Rate) ç‚¹å‡»ç‡é¢„ä¼°çš„æ¨èç®—æ³•åœºæ™¯ï¼ŒTensorFlow Feature Column è¢«å¹¿æ³›åº”ç”¨åˆ°å®è·µä¸­ã€‚è¿™ä¸€æ–¹é¢å¸¦æ¥äº†æ¨¡å‹ç‰¹å¾å¤„ç†çš„ä¾¿åˆ©ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¸¦æ¥äº†ä¸€äº›çº¿ä¸Šæ¨ç†æœåŠ¡çš„æ€§èƒ½é—®é¢˜ã€‚
- ![](https://img-blog.csdnimg.cn/img_convert/cf98e84681aaacadc02f7023fe966c2e.png)
- Feature Column æ˜¯ TensorFlow æä¾›çš„ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ®çš„å·¥å…·ï¼Œæ˜¯å°†æ ·æœ¬ç‰¹å¾æ˜ å°„åˆ°ç”¨äºè®­ç»ƒæ¨¡å‹ç‰¹å¾çš„æ¡¥æ¢ã€‚å®ƒæä¾›äº†å¤šç§ç‰¹å¾å¤„ç†æ–¹æ³•ï¼Œè®©ç®—æ³•äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“å°†å„ç§åŸå§‹ç‰¹å¾è½¬æ¢ä¸ºæ¨¡å‹çš„è¾“å…¥ï¼Œæ¥è¿›è¡Œæ¨¡å‹å®éªŒã€‚
- æ‰€æœ‰ Feature Column éƒ½æºè‡ª FeatureColumn ç±»ï¼Œå¹¶ç»§æ‰¿äº†ä¸‰ä¸ªå­ç±» CategoricalColumnã€DenseColumn å’Œ SequenceDenseColumnï¼Œåˆ†åˆ«å¯¹åº”ç¨€ç–ç‰¹å¾ã€ç¨ å¯†ç‰¹å¾ã€åºåˆ—ç¨ å¯†ç‰¹å¾ã€‚ç®—æ³•äººå‘˜å¯ä»¥æŒ‰ç…§æ ·æœ¬ç‰¹å¾çš„ç±»å‹æ‰¾åˆ°å¯¹åº”çš„æ¥å£ç›´æ¥é€‚é…ã€‚
- ![](https://img-blog.csdnimg.cn/img_convert/779703f3920ecde96972cd2f1614417d.png)

# ç‰¹å¾å·¥ç¨‹

ã€2022-8-30ã€‘çŸ¥ä¹ä¸“é¢˜ï¼š[ç‰¹å¾å·¥ç¨‹å¦‚ä½•æ‰¾æœ‰æ•ˆçš„ç‰¹å¾ï¼Ÿ](https://www.zhihu.com/question/349860940/answer/2499614543)

## ä¸ºä»€ä¹ˆè¦ç²¾åšç‰¹å¾å·¥ç¨‹

åœ¨å®Œæ•´çš„æœºå™¨å­¦ä¹ æµæ°´çº¿ä¸­ï¼Œ**ç‰¹å¾å·¥ç¨‹**é€šå¸¸å æ®äº†æ•°æ®ç§‘å­¦å®¶å¾ˆå¤§ä¸€éƒ¨åˆ†çš„ç²¾åŠ›
- ç‰¹å¾å·¥ç¨‹èƒ½å¤Ÿæ˜¾è‘—æå‡æ¨¡å‹æ€§èƒ½ï¼Œé«˜è´¨é‡çš„ç‰¹å¾èƒ½å¤Ÿå¤§å¤§ç®€åŒ–æ¨¡å‹å¤æ‚åº¦ï¼Œè®©æ¨¡å‹å˜å¾—é«˜æ•ˆä¸”æ˜“ç†è§£ã€æ˜“ç»´æŠ¤ã€‚
  - åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œâ€œGarbage In, Garbage Outâ€æ˜¯ä¸šç•Œçš„å…±è¯†ï¼Œå¯¹äºä¸€ä¸ªæœºå™¨å­¦ä¹ é—®é¢˜ï¼Œæ•°æ®å’Œç‰¹å¾å†³å®šäº†æœºå™¨å­¦ä¹ çš„ä¸Šé™ï¼Œè€Œæ¨¡å‹å’Œç®—æ³•åªæ˜¯é€¼è¿‘è¿™ä¸ªä¸Šé™è€Œå·²ã€‚
  - ![](https://pic1.zhimg.com/80/v2-a429bf4612cb115e25ba39d6c41807bc_1440w.jpg?source=1940ef5c)
  - åœ¨ä¸€ä¸ªå®Œæ•´çš„æœºå™¨å­¦ä¹ æµæ°´çº¿ä¸­ï¼Œç‰¹å¾å·¥ç¨‹å¤„äºä¸Šæ¸¸ä½ç½®ï¼Œå› æ­¤**ç‰¹å¾å·¥ç¨‹çš„å¥½åç›´æ¥å½±å“åç»­çš„æ¨¡å‹ä¸ç®—æ³•çš„è¡¨ç°**ã€‚
- å¦å¤–ï¼Œç‰¹å¾å·¥ç¨‹ä¹Ÿæ˜¯ç¼–ç é¢†åŸŸ**ä¸“å®¶ç»éªŒ**çš„é‡è¦æ‰‹æ®µã€‚

### ç‰¹å¾å·¥ç¨‹è¯¯åŒº

ç‰¹å¾å·¥ç¨‹çš„ä¸‰ä¸ªè¯¯åŒºï¼š
1. è¯¯åŒºä¸€ï¼š<font color='blue'>æ·±åº¦å­¦ä¹ æ—¶ä»£ä¸éœ€è¦ç‰¹å¾å·¥ç¨‹</font>
  - æ·±åº¦å­¦ä¹ æŠ€æœ¯åœ¨è®¡ç®—æœºè§†è§‰ã€è¯­éŸ³ã€NLPé¢†åŸŸçš„æˆåŠŸï¼Œä½¿å¾—åœ¨è¿™äº›é¢†åŸŸæ‰‹å·¥åšç‰¹å¾å·¥ç¨‹çš„é‡è¦æ€§å¤§å¤§é™ä½ï¼Œå› æ­¤æœ‰äººè§‰å¾—æ·±åº¦å­¦ä¹ æ—¶ä»£ä¸å†éœ€è¦äººå·¥åšç‰¹å¾å·¥ç¨‹ã€‚ç„¶åï¼Œåœ¨æœç´¢ã€æ¨èã€å¹¿å‘Šç­‰é¢†åŸŸï¼Œç‰¹å¾æ•°æ®ä¸»è¦ä»¥å…³ç³»å‹ç»“æ„ç»„ç»‡å’Œå­˜å‚¨ï¼Œåœ¨å…³ç³»å‹æ•°æ®ä¸Šçš„ç‰¹å¾ç”Ÿæˆå’Œå˜æ¢æ“ä½œä¸»è¦æœ‰ä¸¤å¤§ç±»å‹
    - ä¸€ç§æ˜¯åŸºäº**è¡Œ**ï¼ˆrow-basedï¼‰çš„ç‰¹å¾å˜æ¢ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªæ ·æœ¬çš„ä¸åŒç‰¹å¾ä¹‹é—´çš„å˜æ¢æ“ä½œï¼Œæ¯”å¦‚ç‰¹å¾ç»„åˆï¼›
    - å¦ä¸€ç§æ˜¯åŸºäº**åˆ—**ï¼ˆcolumn-basedï¼‰çš„ç‰¹å¾å˜æ¢ï¼Œæ¯”å¦‚ç±»åˆ«å‹ç‰¹å¾çš„åˆ†ç»„ç»Ÿè®¡å€¼ï¼Œå¦‚æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ã€ä¸­ä½æ•°ç­‰ã€‚
  -  <img src="https://pic1.zhimg.com/50/v2-4e06a49c7e4d4c082e2e0b671b1aebd1_720w.jpg" > 
  - æ¨¡å‹å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå­¦ä¹ åˆ°**row**-basedçš„ç‰¹å¾å˜æ¢ï¼Œæ¯”å¦‚PNNã€DCNã€DeepFMã€xDeepFMã€AutoIntç­‰æ¨¡å‹éƒ½å¯ä»¥å»ºæ¨¡ç‰¹å¾çš„äº¤å‰ç»„åˆæ“ä½œã€‚å°½ç®¡å¦‚æ­¤ï¼Œ<font color='red'>æ¨¡å‹å´å¾ˆéš¾å­¦ä¹ åˆ°åŸºäºåˆ—çš„ç‰¹å¾å˜æ¢</font>
  - å› ä¸ºæ·±åº¦æ¨¡å‹ä¸€æ¬¡åªèƒ½æ¥å—ä¸€ä¸ª**å°æ‰¹æ¬¡**çš„æ ·æœ¬ï¼Œæ— æ³•å»ºæ¨¡åˆ°**å…¨å±€**çš„ç»Ÿè®¡èšåˆä¿¡æ¯ï¼Œè€Œè¿™äº›ä¿¡æ¯å¾€å¾€æ˜¯å¾ˆé‡è¦çš„ã€‚
  - ç»¼ä¸Šï¼Œå³ä½¿æ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ä¹Ÿæ˜¯éœ€è¦ç²¾å‡†ç‰¹å¾å·¥ç¨‹çš„ã€‚
2. è¯¯åŒºäºŒï¼š<font color='blue'>æœ‰äº†AutoFEå·¥å…·å°±ä¸å†éœ€è¦æ‰‹å·¥åšç‰¹å¾å·¥ç¨‹</font>
  - AutoFEå·¥å…·å°™å¤„äºåˆçº§é˜¶æ®µ
  - ç‰¹å¾å·¥ç¨‹éå¸¸ä¾èµ–äºæ•°æ®ç§‘å­¦å®¶çš„ä¸šåŠ¡çŸ¥è¯†ã€ç›´è§‰å’Œç»éªŒ
  - <img src="https://picx.zhimg.com/50/v2-dc2ea388246599af2bdfd5daf65ace20_720w.jpg">
3. è¯¯åŒºä¸‰ï¼š<font color='blue'>ç‰¹å¾å·¥ç¨‹æ˜¯æ²¡æœ‰æŠ€æœ¯å«é‡çš„è„æ´»ç´¯æ´»</font>
  - å¾ˆå¤šå­¦ç”Ÿå’Œå·¥ä½œä¸ä¹…çš„åŒäº‹ä¼šæœ‰ä¸€ç§åè§: **ç®—æ³•æ¨¡å‹**æ‰æ˜¯é«˜å¤§ä¸Šçš„æŠ€æœ¯ï¼Œ**ç‰¹å¾å·¥ç¨‹**æ˜¯è„æ´»ç´¯æ´»ï¼Œæ²¡æœ‰æŠ€æœ¯å«é‡ã€‚
  - å› æ­¤ï¼Œå¾ˆå¤šäººæŠŠå¤§é‡ç²¾åŠ›æŠ•å…¥åˆ°ç®—æ³•æ¨¡å‹çš„å­¦ä¹ å’Œç§¯ç´¯ä¸­ï¼Œè€Œå¾ˆå°‘åŒ–æ—¶é—´å’Œç²¾åŠ›å»ç§¯ç´¯ç‰¹å¾å·¥ç¨‹æ–¹é¢çš„ç»éªŒã€‚
  - å…¶å®ï¼Œç®—æ³•æ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹å°±å¥½æ¯”æ˜¯è¥¿è¥¿å¼—æ–¯æ¨ç€çŸ³å¤´ä¸Šå±±ï¼ŒçŸ³å¤´æœ€ç»ˆè¿˜ä¼šæ»šè½ä¸‹æ¥ï¼Œè¿™æ˜¯å› ä¸ºç®—æ³•æ¨¡å‹çš„æ›´æ–°è¿­ä»£é€Ÿåº¦å¤ªå¿«äº†ï¼Œæ€»ä¼šæœ‰æ•ˆç‡æ›´é«˜ã€æ•ˆæœæ›´å¥½çš„æ¨¡å‹è¢«æå‡ºï¼Œä»è€Œè®©ä¹‹å‰çš„ç§¯ç´¯å˜å¾—æ— ç”¨ã€‚
  - å¦ä¸€æ–¹é¢ï¼Œç‰¹å¾å·¥ç¨‹çš„ç»éªŒæ²‰æ·€å°±å¥½æ¯”æ˜¯ä¸€ä¸ª**æ»šé›ªçƒ**çš„è¿‡ç¨‹ï¼Œé›ªçƒä¼šè¶Šæ»šè¶Šå¤§ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¼šæˆä¸ºä¸€ä¸ªä¸šåŠ¡çš„é¢†åŸŸä¸“å®¶ï¼Œå¯¹ä¸šåŠ¡è´¡çŒ®æ— å¯ä»£æ›¿çš„ä»·å€¼ã€‚
  - <img src="https://picx.zhimg.com/50/v2-7a40c2577fe10cf7c2ea374c032385b7_720w.jpg">
  - æœºå™¨å­¦ä¹ å·¥ä½œæµå°±å¥½æ¯”æ˜¯ä¸€ä¸ªå¨å¸ˆåšèœçš„è¿‡ç¨‹ï¼Œç®€å•æ¥è¯´ï¼Œæ¸…æ´—é£Ÿæå¯¹åº”äº†æ¸…æ´—æ•°æ®ï¼Œé£Ÿæçš„å»çš®ã€åˆ‡ç‰‡å’Œæ­é…å°±å¯¹äºäº†ç‰¹å¾å·¥ç¨‹çš„è¿‡ç¨‹ï¼Œé£Ÿç‰©çš„çƒ¹é¥ªå¯¹åº”äº†æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ã€‚å¦‚æœä½ è§‰å¾—æ•°æ®æ¸…æ´—å’Œç‰¹å¾å·¥ç¨‹ä¸é‡è¦ï¼Œè«éæ˜¯ä½ æƒ³åƒä¸€ä»½æ²¡æœ‰ç»è¿‡æ¸…æ´—ã€å»çš®ã€åˆ‡ç‰‡ã€è°ƒæ–™ï¼Œè€Œç›´æ¥æŠŠåŸå§‹çš„å¸¦ç€æ³¥æ²™çš„è”¬èœç“œæœæ”¾åœ¨å¤§é”…é‡Œä¹±ç‚–å‡ºæ¥çš„â€œèœâ€? å…ˆä¸è¯´å«ç”Ÿçš„é—®é¢˜ï¼Œèƒ½ä¸èƒ½å¼„ç†Ÿäº†éƒ½æ˜¯ä¸ªé—®é¢˜ã€‚


## ä¸ºä»€ä¹ˆè¦åšç‰¹å¾å½’ä¸€åŒ–/æ ‡å‡†åŒ–ï¼Ÿ

ã€2021-9-6ã€‘[ä¸ºä»€ä¹ˆè¦åšç‰¹å¾å½’ä¸€åŒ–/æ ‡å‡†åŒ–ï¼Ÿ](https://www.cnblogs.com/shine-lee/p/11779514.html)

Feature scalingï¼Œå¸¸è§çš„ææ³•æœ‰â€œç‰¹å¾å½’ä¸€åŒ–â€ã€â€œæ ‡å‡†åŒ–â€ï¼Œæ˜¯æ•°æ®é¢„å¤„ç†ä¸­çš„é‡è¦æŠ€æœ¯ï¼Œæœ‰æ—¶ç”šè‡³å†³å®šäº†ç®—æ³•èƒ½ä¸èƒ½workä»¥åŠworkå¾—å¥½ä¸å¥½ã€‚

è°ˆåˆ°feature scalingçš„å¿…è¦æ€§ï¼Œæœ€å¸¸ç”¨çš„2ä¸ªä¾‹å­å¯èƒ½æ˜¯ï¼š
- (1) ç‰¹å¾é—´çš„**å•ä½**ï¼ˆå°ºåº¦ï¼‰å¯èƒ½ä¸åŒï¼Œæ¯”å¦‚èº«é«˜å’Œä½“é‡ï¼Œæ¯”å¦‚æ‘„æ°åº¦å’Œåæ°åº¦ï¼Œæ¯”å¦‚æˆ¿å±‹é¢ç§¯å’Œæˆ¿é—´æ•°ï¼Œä¸€ä¸ªç‰¹å¾çš„å˜åŒ–èŒƒå›´å¯èƒ½æ˜¯[ 1000 , 10000 ]ï¼Œå¦ä¸€ä¸ªç‰¹å¾çš„å˜åŒ–èŒƒå›´å¯èƒ½æ˜¯[ âˆ’ 0.1 , 0.2 ]ï¼Œåœ¨è¿›è¡Œè·ç¦»æœ‰å…³çš„è®¡ç®—æ—¶ï¼Œ**å•ä½çš„ä¸åŒä¼šå¯¼è‡´è®¡ç®—ç»“æœçš„ä¸åŒ**ï¼Œå°ºåº¦å¤§çš„ç‰¹å¾ä¼šèµ·å†³å®šæ€§ä½œç”¨ï¼Œè€Œå°ºåº¦å°çš„ç‰¹å¾å…¶ä½œç”¨å¯èƒ½ä¼šè¢«å¿½ç•¥ï¼Œä¸ºäº†æ¶ˆé™¤ç‰¹å¾é—´å•ä½å’Œå°ºåº¦å·®å¼‚çš„å½±å“ï¼Œä»¥å¯¹æ¯ç»´ç‰¹å¾åŒç­‰çœ‹å¾…ï¼Œéœ€è¦å¯¹ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–ã€‚
- (2) åŸå§‹ç‰¹å¾ä¸‹ï¼Œå› å°ºåº¦å·®å¼‚ï¼Œå…¶æŸå¤±å‡½æ•°çš„ç­‰é«˜çº¿å›¾å¯èƒ½æ˜¯æ¤­åœ†å½¢ï¼Œæ¢¯åº¦æ–¹å‘å‚ç›´äºç­‰é«˜çº¿ï¼Œä¸‹é™ä¼šèµ°**zigzagè·¯çº¿**ï¼Œè€Œä¸æ˜¯æŒ‡å‘**local minimum**ã€‚é€šè¿‡å¯¹ç‰¹å¾è¿›è¡Œzero-mean and unit-varianceå˜æ¢åï¼Œå…¶æŸå¤±å‡½æ•°çš„ç­‰é«˜çº¿å›¾æ›´æ¥è¿‘åœ†å½¢ï¼Œæ¢¯åº¦ä¸‹é™çš„æ–¹å‘éœ‡è¡æ›´å°ï¼Œæ”¶æ•›æ›´å¿«
- ![andrew ng](https://s2.ax1x.com/2019/10/30/K4ZoHf.png)

é—®é¢˜ï¼š
- å¸¸ç”¨çš„feature scalingæ–¹æ³•éƒ½æœ‰å“ªäº›ï¼Ÿ
  - feature scalingçš„æ–¹æ³•å¯ä»¥åˆ†æˆ2ç±»ï¼Œ**é€è¡Œ**è¿›è¡Œå’Œ**é€åˆ—**è¿›è¡Œã€‚é€è¡Œæ˜¯å¯¹æ¯ä¸€ç»´ç‰¹å¾æ“ä½œï¼Œé€åˆ—æ˜¯å¯¹æ¯ä¸ªæ ·æœ¬æ“ä½œ
- ä»€ä¹ˆæƒ…å†µä¸‹è¯¥ä½¿ç”¨ä»€ä¹ˆfeature scalingæ–¹æ³•ï¼Ÿæœ‰æ²¡æœ‰ä¸€äº›æŒ‡å¯¼æ€æƒ³ï¼Ÿ
  - æ¶‰åŠæˆ–éšå«è·ç¦»è®¡ç®—çš„ç®—æ³•ï¼Œæ¯”å¦‚K-meansã€KNNã€PCAã€SVMç­‰ï¼Œä¸€èˆ¬éœ€è¦feature scaling
  - æŸå¤±å‡½æ•°ä¸­å«æœ‰æ­£åˆ™é¡¹æ—¶ï¼Œä¸€èˆ¬éœ€è¦feature scaling:
  - æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œéœ€è¦feature scalingã€‚æ”¶æ•›é€Ÿåº¦å–å†³äºï¼šå‚æ•°çš„åˆå§‹ä½ç½®åˆ°local minimaçš„è·ç¦»ï¼Œä»¥åŠå­¦ä¹ ç‡Î· \etaÎ·çš„å¤§å°ã€‚
- æ‰€æœ‰çš„æœºå™¨å­¦ä¹ ç®—æ³•éƒ½éœ€è¦feature scalingå—ï¼Ÿæœ‰æ²¡æœ‰ä¾‹å¤–ï¼Ÿ
  - ä¸è·ç¦»è®¡ç®—æ— å…³çš„æ¦‚ç‡æ¨¡å‹ï¼Œä¸éœ€è¦feature scalingï¼Œæ¯”å¦‚Naive Bayesï¼›
  - ä¸è·ç¦»è®¡ç®—æ— å…³çš„åŸºäºæ ‘çš„æ¨¡å‹ï¼Œä¸éœ€è¦feature scalingï¼Œæ¯”å¦‚å†³ç­–æ ‘ã€éšæœºæ£®æ—ç­‰ï¼Œæ ‘ä¸­èŠ‚ç‚¹çš„é€‰æ‹©åªå…³æ³¨å½“å‰ç‰¹å¾åœ¨å“ªé‡Œåˆ‡åˆ†å¯¹åˆ†ç±»æ›´å¥½ï¼Œå³åªåœ¨æ„ç‰¹å¾å†…éƒ¨çš„ç›¸å¯¹å¤§å°ï¼Œè€Œä¸ç‰¹å¾é—´çš„ç›¸å¯¹å¤§å°æ— å…³ã€‚
- æŸå¤±å‡½æ•°çš„ç­‰é«˜çº¿å›¾éƒ½æ˜¯æ¤­åœ†æˆ–åŒå¿ƒåœ†å—ï¼Ÿèƒ½ç”¨æ¤­åœ†å’Œåœ†æ¥ç®€å•è§£é‡Šfeature scalingçš„ä½œç”¨å—ï¼Ÿ
- å¦‚æœæŸå¤±å‡½æ•°çš„ç­‰é«˜çº¿å›¾å¾ˆå¤æ‚ï¼Œfeature scalingè¿˜æœ‰å…¶ä»–ç›´è§‚è§£é‡Šå—ï¼Ÿ

## æ·±åº¦å­¦ä¹ ä¸­çš„ç‰¹å¾å·¥ç¨‹

`æ·±åº¦å­¦ä¹ `å’Œä¸€èˆ¬`æœºå™¨å­¦ä¹ `æœ€å¤§çš„å·®åˆ«å°±æ˜¯ï¼š
- <span style='color:blue'>æ·±åº¦å­¦ä¹ æœ‰è¿›è¡Œâ€œç‰¹å¾å·¥ç¨‹â€çš„éƒ¨åˆ†</span>ï¼Œæ‰€æœ‰çš„ç‰¹å¾å·¥ç¨‹æ˜¯è‡ªå­¦çš„ï¼Œè€Œæ™®é€šæœºå™¨å­¦ä¹ çš„ç‰¹å¾ç»„åˆæ˜¯è¦äººè‚‰å‘ç°å¹¶ç»„åˆçš„ã€‚

å´æ©è¾¾çš„è¯¾æœ‰è¯´ä¸€ä¸ªç»å…¸çš„æˆ¿ä»·æ¨¡å‹ï¼Œå‡è®¾æˆ‘ä»¬å°±æœ‰ä¸‹é¢å‡ ä¸ªç‰¹å¾:
- æˆ¿å±‹å¤§å°
- å§å®¤æ•°é‡â€”â€”1å’Œ2ç»„åˆå¾—åˆ°æ–°ç‰¹å¾ï¼šå®¶åº­æˆå‘˜æ•°
- é‚®ç¼–
- å¯Œè£•ç¨‹åº¦â€”â€”3å’Œ4ç»„åˆå¾—åˆ°æ–°ç‰¹å¾ï¼šå¯Œè£•ç¨‹åº¦

ç›´æ¥ä¸¢è¿›æ¨¡å‹æ•ˆæœè‚¯å®šä¸€èˆ¬ï¼Œè¦æ˜¯è¿™ä¹ˆåšâ€œç‰¹å¾å·¥ç¨‹â€
- ç”¨ â€œæˆ¿å±‹å¤§å°â€ * â€œå§å®¤æ•°é‡â€å¾—åˆ°ä¸€ä¸ªæ–°ç‰¹å¾ï¼Œå°±å«ä»–â€œå®¶åº­æˆå‘˜æ•°â€ï¼Œè¿™ä¸ªæœ‰é“ç†å§ï¼Ÿ
- ç„¶åâ€œé‚®ç¼–â€ * â€œå¯Œè£•ç¨‹åº¦â€åˆæ˜¯ä¸€ä¸ªæ–°ç‰¹å¾ï¼Œå«å®ƒ"å­¦æ ¡è´¨é‡"ï¼Œä¸åŒçš„é‚®ç¼–ä»£è¡¨ä¸åŒçš„åœ°åŒºï¼Œä¸åŒåœ°åŒºçš„æ•™è‚²æ°´å¹³è‚¯å®šä¸ä¸€æ ·ï¼Œæœ‰é’±ä¸å¦å†³å®šäº†æ•™è‚²èµ·ç‚¹ï¼Œè¿™ä¸ªç‰¹å¾è‚¯å®šä¹Ÿæ˜¯æå¥½çš„ã€‚
- ç›¸ä¿¡ç”¨è¿™äº›æ–°ç»„æˆçš„ç‰¹å¾å’Œä»¥å‰çš„ç‰¹å¾æ•ˆæœè‚¯å®šæ¯”åªç”¨åŸºç¡€ç‰¹å¾å¥½çš„å¤šã€‚

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œäººèƒ½å‘ç°å¤šå°‘ç‰¹å¾ç»„åˆå‘¢ï¼Ÿå¦‚æœâ€œç‰¹å¾å·¥ç¨‹â€è®©æ¨¡å‹è‡ªå·±å»å°è¯•ï¼Œç»“æœä¼šå¥½å˜›ï¼Ÿ
- ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼

è¿™å°±æ˜¯ä¸ºå•¥AlphaGoç¢¾å‹äººç±»è€ŒAlpha Zeroç¢¾å‹AlphaGoçš„åŸå› â€”â€”ç«™åœ¨ä¸€ä¸ªæ²¡æ³•æƒ³è±¡çš„é«˜åº¦æ‹¿åˆ°äº†è‡ªå·±è®¤ä¸ºæœ€å±Œçš„ç‰¹å¾ï¼Œè¿™æ ·å¾—åˆ°æ–°çš„ç‰¹å¾åå†è¿›è¡Œå…¶ä»–æ­¥éª¤ï¼Œè‡ªç„¶äº‹åŠåŠŸå€ã€‚å…¶å®è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„`è¡¨ç¤ºå­¦ä¹ `ã€‚

ç”¨CNNæ¥â€œç”¨äººè¯â€è¯´æ˜ä¸€ä¸‹æ·±åº¦å­¦ä¹ çš„â€œç‰¹å¾å·¥ç¨‹â€æ˜¯åœ¨å¹²å•¥ã€‚
- CNNæœ‰å¾ˆå¤šå·ç§¯å±‚ï¼Œæ¯”å¦‚ç°åœ¨è¦ç”¨CNNè®­ç»ƒä¸€ä¸ªäººè„¸è¯†åˆ«æ¨¡å‹ï¼Œè¾“å…¥çš„ç‰¹å¾éƒ½æ˜¯åƒç´ ç‚¹å’ŒRGBä¸‰ä¸ªé€šé“ï¼Œç¥ç»ç½‘ç»œä¼šæ€ä¹ˆå¤„ç†è¿™äº›ç‰¹å¾å‘¢ã€‚
- åœ¨CNNå‰å‡ å±‚ï¼Œè¡¨ç¤ºçš„åŸºæœ¬ç²’åº¦ç”±åƒç´ å‡çº§ä¸ºè¾ƒæŠ½è±¡çš„**è¾¹**(edges), ç”±äºè¾¹æœ‰ä¼—å¤šä¸åŒè§’åº¦ï¼Œå¦‚æ°´å¹³ã€å‚ç›´ç­‰ï¼Œæ‰€ä»¥ä¼š**åˆ†è§£**(disentangle)ä¸ºå¤šä¸ª (è¾¹) ç‰¹å¾(å®é™…ä¸­è¿œå¤§äºä¸‰) ã€‚è€Œè¿™å±‚è¡¨ç¤ºçš„åŸºæœ¬ç²’åº¦è¾¹(edges)æ˜¯ç”±å¤šä¸ªæ˜æš—ç›¸é—´çš„åƒç´ ç»è¿‡ç»„åˆå˜æ¢å¾—åˆ°ã€‚é€šè¿‡è¿™äº›å±‚çš„å­¦ä¹ ï¼Œä½ å¯ä»¥æƒ³è±¡ç®€å•çš„åƒç´ ç‰¹å¾ç”Ÿæˆäº†â€œè¾¹ç¼˜â€ï¼Œå°±ç±»ä¼¼ç”»ç´ ææ‘¹äº†ä¸ªè½®å»“å‡ºæ¥ã€‚
- åœ¨ä¸­é—´å‡ å±‚ä¾æ¬¡ç±»æ¨ï¼Œä¸¤æ¡è¾¹äº¤å‰åç»„æˆäº†è§’corner, å¤šæ¡è¾¹äº¤å‰åç»„æˆäº†contour, è€Œå¤šä¸ªcorners/ contours åˆç»„æˆäº†äººè„¸çš„ä¼—å¤šéƒ¨åˆ†ï¼Œå¦‚é¼»å­ã€è€³æœµç­‰ç­‰ã€‚è¿™äº›ç»„åˆæˆçš„é¼»å­è€³æœµä¹Ÿæ˜¯æ¨¡å‹è‡ªå·±å­¦ä¹ åˆ°çš„ç‰¹å¾ã€‚æ¨¡å‹è§‰å¾—æˆ‘å­¦åˆ°é¼»å­çœ¼ç›å•¥çš„å°±å¯ä»¥æ›´å¥½çš„å¸®æˆ‘åŒºåˆ†ä¸åŒçš„äººäº†ï¼Œæˆ‘ä»¬äººç±»ä¸ä¹Ÿæ˜¯å¦‚æ­¤å’©ã€‚
- æœ€åï¼Œæ¯ä¸€å±‚çš„åŸºæœ¬è¡¨ç¤ºç²’åº¦éƒ½æ˜¯ç”±å‰ä¸€å±‚å¤šä¸ªå…ƒç´ ç»„åˆè€Œæˆã€‚å›¾ç‰‡åœ¨æ¯ä¸€å±‚ä¸­éƒ½æœ‰æ–°çš„è¡¨ç¤ºï¼Œè€Œç¬¬ä¸‰ä¸ªéšè—å±‚çš„è¡¨ç¤ºç»è¿‡ç®€å•çš„çº¿æ€§åˆ†ç±»å™¨å°±èƒ½è¾ƒå¥½åœ°é¢„æµ‹å›¾ç‰‡çš„ç±»åˆ«ã€‚

å‰é¢é‚£ä¹ˆå¤šéƒ¨åˆ†éƒ½æ˜¯åœ¨åšâ€œç‰¹å¾å·¥ç¨‹â€ï¼Œåšå¥½ç‰¹å¾å·¥ç¨‹å¼ï¼Œä¸€ä¸ªç®€å•çš„çº¿æ€§åˆ†ç±»å™¨å°±å¯ä»¥å¾ˆå¥½çš„é¢„æµ‹äº†ã€‚

ä½œè€…ï¼š[æ·±åœ³å´å½¦ç¥–](https://www.zhihu.com/question/29316149/answer/276974562)


## ç‰¹å¾åˆ†æ

è¯†åˆ«å„ä¸ªç‰¹å¾å¯¹ç›®æ ‡çš„å½±å“ç¨‹åº¦

ç‰¹å¾é‡è¦æ€§åˆ†æç”¨äºäº†è§£æ¯ä¸ªç‰¹å¾(å˜é‡æˆ–è¾“å…¥)å¯¹äºåšå‡ºé¢„æµ‹çš„æœ‰ç”¨æ€§æˆ–ä»·å€¼ã€‚
- ç›®æ ‡: ç¡®å®šå¯¹æ¨¡å‹è¾“å‡ºå½±å“æœ€å¤§æœ€é‡è¦çš„ç‰¹å¾ã€‚


### ä¸ºä»€ä¹ˆè¦åˆ†æç‰¹å¾

ç‰¹å¾é‡è¦æ€§åˆ†æå¯ä»¥è¯†åˆ«æœ€å…·ä¿¡æ¯é‡çš„ç‰¹å¾ï¼Œä»è€Œ:
- æ”¹è¿›æ¨¡å‹æ€§èƒ½
- å‡å°‘è¿‡åº¦æ‹Ÿåˆ
- æ›´å¿«è®­ç»ƒå’Œæ¨ç†
- å¢å¼ºå¯è§£é‡Šæ€§

### ä»€ä¹ˆæ˜¯å¥½çš„ç‰¹å¾å·¥ç¨‹

é«˜è´¨é‡ç‰¹å¾éœ€è¦æ»¡è¶³ä»¥ä¸‹æ ‡å‡†ï¼š
- æœ‰**åŒºåˆ†**æ€§ï¼ˆInformativeï¼‰
- ç‰¹å¾ä¹‹é—´ç›¸äº’**ç‹¬ç«‹**ï¼ˆIndependentï¼‰
- ç®€å•æ˜“äº**ç†è§£**ï¼ˆSimpleï¼‰
- ä¼¸ç¼©æ€§ï¼ˆ Scalable ï¼‰ï¼šæ”¯æŒå¤§æ•°æ®é‡ã€é«˜åŸºæ•°ç‰¹å¾
- é«˜æ•ˆç‡ï¼ˆ Efficient ï¼‰ï¼šæ”¯æŒé«˜å¹¶å‘é¢„æµ‹
- çµæ´»æ€§ï¼ˆ Flexible ï¼‰ï¼šå¯¹ä¸‹æ¸¸ä»»åŠ¡æœ‰ä¸€å®šçš„æ™®é€‚æ€§
- è‡ªé€‚åº”ï¼ˆ Adaptive ï¼‰ï¼šå¯¹æ•°æ®åˆ†å¸ƒçš„å˜åŒ–æœ‰ä¸€å®šçš„é²æ£’æ€§

è¡¡é‡ç‰¹å¾å¥½åçš„æŒ‡æ ‡å’Œæ–¹æ³•å¾ˆå¤š
- IVå€¼
- KS
- odds
- LRï¼Œrandom forestç®—æ³•éƒ½å¯ä»¥ç”¨æ¥åšç‰¹å¾ç­›é€‰
- grid searchçš„æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥æœç´¢ç‰¹å¾å¥½å


è¯¦æƒ…ï¼š[ä½•ä¸ºä¼˜ç§€çš„æœºå™¨å­¦ä¹ ç‰¹å¾](https://yangxudong.github.io/good-feature/)


### ç‰¹æ€§åˆ†ææ–¹æ³•

ç‰¹å¾é‡è¦æ€§åˆ†ææ–¹æ³•
- 1ã€æ’åˆ—é‡è¦æ€§: éšæœºæ’åˆ—æ¯ä¸ªç‰¹å¾çš„å€¼ï¼Œç›‘æ§æ¨¡å‹æ€§èƒ½ä¸‹é™ç¨‹åº¦
- 2ã€å†…ç½®ç‰¹å¾é‡è¦æ€§: ç›´æ¥è¾“å‡ºç‰¹å¾é‡è¦æ€§åˆ†æ•°
- 3ã€Leave-one-out: è¿­ä»£åˆ é™¤1ä¸ªç‰¹å¾å¹¶è¯„ä¼°å‡†ç¡®æ€§
- 4ã€ç›¸å…³æ€§åˆ†æ: è®¡ç®—å„ç‰¹å¾ä¸ç›®æ ‡å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§
- 5ã€é€’å½’ç‰¹å¾æ¶ˆé™¤: é€’å½’åˆ é™¤ç‰¹å¾å¹¶æŸ¥çœ‹å®ƒå¦‚ä½•å½±å“æ¨¡å‹æ€§èƒ½
- 6ã€XGBoosté‡è¦æ€§: è®¡ç®—1ä¸ªç‰¹æ€§ç”¨äºè·¨æ‰€æœ‰æ ‘æ‹†åˆ†æ•°æ®çš„æ¬¡æ•°
- 7ã€ä¸»æˆåˆ†åˆ†æ PCA: ä¸»æˆåˆ†åˆ†æï¼Œå¹¶æŸ¥çœ‹æ¯ä¸ªä¸»æˆåˆ†çš„**è§£é‡Šæ–¹å·®æ¯”**
- 8ã€æ–¹å·®åˆ†æ ANOVA: æ¯ä¸ªç‰¹å¾çš„**æ–¹å·®åˆ†æfå€¼**
- 9ã€å¡æ–¹æ£€éªŒ: æ¯ä¸ªç‰¹å¾çš„å¡æ–¹ç»Ÿè®¡ä¿¡æ¯

ä¸åŒçš„æ–¹æ³•ä¼šæ£€æµ‹åˆ°ä¸åŒçš„ç‰¹å¾

å› ä¸ºï¼š
- 1ã€ç”¨ä¸åŒæ–¹å¼è¡¡é‡é‡è¦æ€§:
  - æœ‰çš„ä½¿ç”¨ä¸åŒç‰¹ç‰¹å¾è¿›è¡Œé¢„æµ‹ï¼Œç›‘æ§ç²¾åº¦ä¸‹é™, åƒXGBOOSTæˆ–è€…å›å›½æ¨¡å‹ä½¿ç”¨å†…ç½®é‡è¦æ€§æ¥è¿›è¡Œç‰¹å¾çš„é‡è¦æ€§æ’åˆ—, è€ŒPCAç€çœ¼äºæ–¹å·®è§£é‡Š
- 2ã€ä¸åŒæ¨¡å‹æœ‰ä¸åŒæ¨¡å‹çš„æ–¹æ³•ï¼š
  - çº¿æ€§æ¨¡å‹å€¾å‘äº**çº¿æ€§å…³ç³»**ã€æ ‘æ¨¡å‹å€¾å‘äº**æ¥è¿‘æ ¹çš„ç‰¹å¾**
- 4ã€äº¤äº’ä½œç”¨:
  - æœ‰çš„æ–¹æ³•å¯ä»¥è·å–ç‰¹å¾ä¹‹é—´çš„**ç›¸äº’å·¦å³**ï¼Œè€Œæœ‰ä¸€äº›åˆ™ä¸è¡Œï¼Œè¿™å°±ä¼šå¯¼è‡´ç»“æœçš„å·®å¼‚
- 5ã€ä¸ç¨³å®š:
  - ä½¿ç”¨ä¸åŒçš„æ•°æ®å­é›†ï¼Œé‡è¦æ€§å€¼å¯èƒ½åœ¨åŒä¸€æ–¹æ³•çš„ä¸åŒè¿è¡Œä¸­æœ‰æ‰€ä¸åŒï¼Œè¿™æ˜¯å› ä¸ºæ•°æ®å·®å¼‚å†³å®šçš„
- 6ã€Hyperparameters:
  - é€šè¿‡è°ƒæ•´è¶…å‚æ•°ï¼Œå¦‚PCAç»„ä»¶æˆ–æ ‘æ·±åº¦ï¼Œä¹Ÿä¼šå½±å“ç»“æœ
  - æ‰€ä»¥ä¸åŒçš„å‡è®¾ã€åå·®ã€æ•°æ®å¤„ç†å’Œæ–¹æ³•çš„å¯å˜æ€§æ„å‘³ç€å®ƒä»¬å¹¶ä¸æ€»æ˜¯åœ¨æœ€é‡è¦çš„ç‰¹å¾ä¸Šä¿æŒä¸€è‡´ã€‚

ã€2023-9-20ã€‘[ç‰¹å¾é‡è¦æ€§åˆ†æçš„9ä¸ªå¸¸ç”¨æ–¹æ³•](https://blog.csdn.net/aobulaien001/article/details/133070867)


#### 1ã€æ’åˆ—é‡è¦æ€§ PermutationImportance

éšæœºæ’åˆ—æ¯ä¸ªç‰¹å¾çš„å€¼ï¼Œç›‘æ§æ¨¡å‹æ€§èƒ½ä¸‹é™ç¨‹åº¦
- inspection é‡Œçš„ permutation_importance

```py
from sklearn.datasets import load_breast_cancer  
from sklearn.ensemble import RandomForestClassifier  
from sklearn.inspection import permutation_importance  
from sklearn.model_selection import train_test_split  
import matplotlib.pyplot as plt  
   
cancer = load_breast_cancer()  
   
X_train, X_test, y_train, y_test = train_test_split(cancer.data, cancer.target, random_state=1)  
   
rf = RandomForestClassifier(n_estimators=100, random_state=1)  
rf.fit(X_train, y_train)  
   
baseline = rf.score(X_test, y_test)
# æ’åˆ—é‡è¦æ€§
result = permutation_importance(rf, X_test, y_test, n_repeats=10, random_state=1, scoring='accuracy')  
   
importances = result.importances_mean  
   
# Visualize permutation importances  
plt.bar(range(len(importances)), importances)  
plt.xlabel('Feature Index')  
plt.ylabel('Permutation Importance')  
plt.show()
```

#### 2ã€å†…ç½®ç‰¹å¾é‡è¦æ€§

å†…ç½®ç‰¹å¾é‡è¦æ€§ (coef_æˆ–feature_importances_)

ä¸€äº›æ¨¡å‹(å¦‚çº¿æ€§å›å½’å’Œéšæœºæ£®æ—)ç›´æ¥è¾“å‡ºç‰¹å¾é‡è¦æ€§åˆ†æ•°, æ˜¾ç¤ºæ¯ä¸ªç‰¹å¾å¯¹æœ€ç»ˆé¢„æµ‹çš„è´¡çŒ®ã€‚

```py
from sklearn.datasets import load_breast_cancer  
from sklearn.ensemble import RandomForestClassifier  
   
X, y = load_breast_cancer(return_X_y=True)  

rf = RandomForestClassifier(n_estimators=100, random_state=1)  
rf.fit(X, y)  

importances = rf.feature_importances_  
# Plot importances  
plt.bar(range(X.shape[1]), importances)  
plt.xlabel('Feature Index')  
plt.ylabel('Feature Importance')  
plt.show()
```


#### 3ã€Leave-one-out

è¿­ä»£åˆ é™¤1ä¸ªç‰¹å¾å¹¶è¯„ä¼°å‡†ç¡®æ€§ã€‚

```py
from sklearn.datasets import load_breast_cancer  
from sklearn.model_selection import train_test_split  
from sklearn.ensemble import RandomForestClassifier  
from sklearn.metrics import accuracy_score  
import matplotlib.pyplot as plt  
import numpy as np  
  
# Load sample data  
X, y = load_breast_cancer(return_X_y=True)  
  
# Split data into train and test sets  
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)  
  
# Train a random forest model  
rf = RandomForestClassifier(n_estimators=100, random_state=1)  
rf.fit(X_train, y_train)  
  
# Get baseline accuracy on test data  
base_acc = accuracy_score(y_test, rf.predict(X_test))  
  
# Initialize empty list to store importances  
importances = []  
  
# Iterate over all columns and remove one at a time  
for i in range(X_train.shape[1]):  
   X_temp = np.delete(X_train, i, axis=1)  
   rf.fit(X_temp, y_train)  
   acc = accuracy_score(y_test, rf.predict(np.delete(X_test, i, axis=1)))  
   importances.append(base_acc - acc)  
      
# Plot importance scores      
plt.bar(range(len(importances)), importances)  
plt.show()
```


#### 4ã€ç›¸å…³æ€§åˆ†æ

è®¡ç®—å„ç‰¹å¾ä¸ç›®æ ‡å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚
- ç›¸å…³æ€§è¶Šé«˜çš„ç‰¹å¾è¶Šé‡è¦ã€‚

```py
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
   
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
   
correlations = df.corrwith(df.y).abs()  
correlations.sort_values(ascending=False, inplace=True)  
correlations.plot.bar()
```


#### 5ã€é€’å½’ç‰¹å¾æ¶ˆé™¤ Recursive Feature Elimination

é€’å½’åˆ é™¤ç‰¹å¾å¹¶æŸ¥çœ‹å®ƒå¦‚ä½•å½±å“æ¨¡å‹æ€§èƒ½ã€‚åˆ é™¤æ—¶ä¼šå¯¼è‡´æ›´å¤§ä¸‹é™çš„ç‰¹å¾æ›´é‡è¦ã€‚

```py
from sklearn.ensemble import RandomForestClassifier  
from sklearn.feature_selection import RFE  
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
import matplotlib.pyplot as plt  
  
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
  
rf = RandomForestClassifier()  
  
rfe = RFE(rf, n_features_to_select=10)  
rfe.fit(X, y)  
  
print(rfe.ranking_)
```


#### 6ã€å†³ç­–æ ‘é‡è¦æ€§

è®¡ç®—1ä¸ªç‰¹æ€§ç”¨äºè·¨æ‰€æœ‰æ ‘æ‹†åˆ†æ•°æ®çš„æ¬¡æ•°ã€‚æ›´å¤šçš„åˆ†è£‚æ„å‘³ç€æ›´é‡è¦ã€‚

(1) XGBoost

```py
import xgboost as xgb  
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
import matplotlib.pyplot as plt  
  
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
  
model = xgb.XGBClassifier()  
model.fit(X, y)  
  
importances = model.feature_importances_  
importances = pd.Series(importances, index=range(X.shape[1]))  
importances.plot.bar()
```

ã€2024-6-14ã€‘å®è·µ

```py
import numpy as np
import pandas as pd
#!pip install xgboost
import xgboost as xgb
import matplotlib.pyplot as plt; 
# plt.style.use('seaborn')

# åŠ è½½æ•°æ®é›†
# data = pd.read_csv('data.csv')
data = df_cn_train # is_recommend æ˜¯æ ‡ç­¾
# å›å½’
model = xgb.XGBRegressor(max_depth=5, learning_rate=0.03, n_estimators=300)
model.fit(data.loc[:, (data.columns != 'is_recommend')], data.loc[:, data.columns == 'is_recommend'])
print('ç‰¹å¾é‡è¦æ€§:\n', model.feature_importances_)
cols = data.columns.to_numpy()
cols = cols[cols != 'is_recommend']

weight_info = dict(zip(cols, model.feature_importances_))
weight_info = sorted(weight_info.items(), key=lambda d: d[1], reverse=True)
print(f'| ç‰¹å¾ | æƒé‡ |')
print(f'| --- | --- |')
for i in weight_info:
    print(f'| {i[0]} | {i[1]} |')
x_list = [i[0] for i in weight_info]
y_list = [i[1] for i in weight_info]

# ç»˜å›¾
plt.figure(figsize=(15, 5))

# plt.bar(range(len(cols)), model.feature_importances_)
# plt.xticks(range(len(cols)), cols, rotation=-90, fontsize=10)

plt.bar(range(len(cols)), y_list)
plt.xticks(range(len(cols)), x_list, rotation=-90, fontsize=10)

plt.title('Feature importance', fontsize=14)
plt.show()
```


(2) éšæœºæ£®æ—

```py
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
import pandas as pd
# åŠ è½½æ•°æ®é›†
iris = load_iris()
X = iris.data
y = iris.target
# åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# æ„å»ºéšæœºæ£®æ—åˆ†ç±»å™¨
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)
# è·å–ç‰¹å¾é‡è¦æ€§
feature_importances = rf.feature_importances_
# å°†ç‰¹å¾åç§°å’Œé‡è¦æ€§å¾—åˆ†æ•´åˆåˆ°DataFrameä¸­
feature_names = iris.feature_names
importance_df = pd.DataFrame({'Feature': feature_names, 'Importance': feature_importances})
# æŒ‰é‡è¦æ€§å¾—åˆ†é™åºæ’åº
importance_df = importance_df.sort_values(by='Importance', ascending=False)
print(importance_df)
```

#### 7ã€ä¸»æˆåˆ†åˆ†æ PCA

å¯¹ç‰¹å¾è¿›è¡Œä¸»æˆåˆ†åˆ†æï¼Œå¹¶æŸ¥çœ‹æ¯ä¸ªä¸»æˆåˆ†çš„**è§£é‡Šæ–¹å·®æ¯”**ã€‚

åœ¨å‰å‡ ä¸ªç»„ä»¶ä¸Šå…·æœ‰è¾ƒé«˜è´Ÿè½½çš„ç‰¹æ€§æ›´ä¸ºé‡è¦ã€‚


```py
from sklearn.decomposition import PCA  
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
import matplotlib.pyplot as plt  
  
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
  
pca = PCA()  
pca.fit(X)  
  
plt.bar(range(pca.n_components_), pca.explained_variance_ratio_)  
plt.xlabel('PCA components')  
plt.ylabel('Explained Variance')
```


#### 8ã€æ–¹å·®åˆ†æ ANOVA

ä½¿ç”¨ f_classif() è·å¾—æ¯ä¸ªç‰¹å¾çš„**æ–¹å·®åˆ†æfå€¼**ã€‚
- få€¼è¶Šé«˜ï¼Œè¡¨æ˜ç‰¹å¾ä¸ç›®æ ‡çš„ç›¸å…³æ€§è¶Šå¼ºã€‚

```py
from sklearn.feature_selection import f_classif  
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
import matplotlib.pyplot as plt  
  
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
  
fval = f_classif(X, y)  
fval = pd.Series(fval[0], index=range(X.shape[1]))  
fval.plot.bar()
```

#### 9ã€å¡æ–¹æ£€éªŒ

ä½¿ç”¨ chi2() è·å¾—æ¯ä¸ªç‰¹å¾çš„å¡æ–¹ç»Ÿè®¡ä¿¡æ¯ã€‚
- å¾—åˆ†è¶Šé«˜çš„ç‰¹å¾è¶Šæœ‰å¯èƒ½ç‹¬ç«‹äºç›®æ ‡ã€‚

```py
from sklearn.feature_selection import chi2  
import pandas as pd  
from sklearn.datasets import load_breast_cancer  
import matplotlib.pyplot as plt  
  
X, y = load_breast_cancer(return_X_y=True)  
df = pd.DataFrame(X, columns=range(30))  
df['y'] = y  
  
chi_scores = chi2(X, y)  
chi_scores = pd.Series(chi_scores[0], index=range(X.shape[1]))  
chi_scores.plot.bar()
```


#### SHAPå€¼

SHAPå€¼æºè‡ªäº`åšå¼ˆè®º`ï¼Œæœºå™¨å­¦ä¹ ä¸­ç”¨äºè®¡ç®—æ¯ä¸ªæ ·æœ¬ä¸­å„ä¸ªç‰¹å¾æ–½åŠ çš„å½±å“åŠ›ã€‚

```py
import shap

ds_data = data.sample(100000)  # éœ€è¦é™é‡‡æ ·ï¼Œæ•°é‡çº§è¿‡å¤§ä¸èƒ½å‡ºå›¾
explainer = shap.TreeExplainer(model)
shap_values = explainer.shap_values(ds_data.loc[:, (ds_data.columns != 'label')])
shap.summary_plot(shap_values, ds_data.loc[:, (ds_data.columns != 'label')], max_display=10)
# Explain
shap.summary_plot(shap_values, ds_data.loc[:, (ds_data.columns != 'label')], plot_type='bar')

```

ç®—æ³•æ’åºäº†æœ€é‡è¦çš„å‡ ä¸ªç‰¹å¾ï¼Œå…¶ä¸­ä¸€ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ªæ ·æœ¬ï¼Œé¢œè‰²è¶Šçº¢è¯´æ˜ç‰¹å¾çš„æ•°å€¼è¶Šå¤§ï¼Œè“è‰²åä¹‹ã€‚å¦‚æœè“è‰²æ ·æœ¬åœ¨<0éƒ¨åˆ†é›†ä¸­ï¼Œè¯´æ˜ç‰¹å¾æ•°å€¼è¶Šå°ï¼Œå¯¹æ¨¡å‹ç»“æœçš„å‰¯ä½œç”¨è¶Šå¤§ï¼›åŒç†å¦‚æœçº¢è‰²æ ·æœ¬åœ¨>0éƒ¨åˆ†é›†ä¸­ï¼Œåˆ™è¯´æ˜æ•°å€¼è¶Šå¤§ï¼Œå¯¹æ¨¡å‹çš„æ­£å‘ä½œç”¨è¶Šå¤§ã€‚

å®Œæ•´ä»£ç 

```py
import numpy as np
import pandas as pd
import xgboost as xgb
from sklearn import metrics
import matplotlib.pyplot as plt; plt.style.use('seaborn')
import shap


def calc_feature_importance_roc_auc(data, label):
    """
    è®¡ç®—ç‰¹å¾é‡è¦æ€§ï¼ˆROC AUCï¼‰
    :param data: ç‰¹å¾æ•°æ®
    :param label: æ ‡ç­¾æ•°æ®
    :returns: ç‰¹å¾é‡è¦æ€§
    """
    # åˆ†ç‰¹å¾è®¡ç®—AUC
    features_auc = []
    for i in data.columns:
        y = data[i]
        std = y.std()
        if std != 0:
            y = (y - y.mean()) / std
            fpr, tpr, thresholds = metrics.roc_curve(label, y.to_numpy())
            auc = metrics.auc(fpr, tpr)
            features_auc.append(auc)
        else:  # æ— æ•ˆæ•°æ®
            features_auc.append(0.5)

    # å¯¹ç»“æœè¿›è¡Œä¿®æ­£
    features_auc = [abs(x - 0.5) for x in features_auc]
    return pd.DataFrame(features_auc)


def calc_feature_importance_shap(tree_model, data):
    """
    è®¡ç®—ç‰¹å¾é‡è¦æ€§ï¼ˆSHAPï¼‰
    :param tree_model: æ ‘æ¨¡å‹
    :param data: ç‰¹å¾æ•°æ®
    :returns: ç‰¹å¾é‡è¦åº¦
    """
    explainer = shap.TreeExplainer(tree_model)
    shap_values = explainer.shap_values(data)
    shap_values_df = pd.DataFrame(shap_values)
    return shap_values_df.abs().mean(axis=0)


if __name__ == "__main__":
    # è¯»åŸå§‹æ•°æ®
    data = pd.read_csv('data.csv')

    # è®­ç»ƒXGBæ¨¡å‹
    feature_data = data.loc[:, (data.columns != 'label')]
    label_data = data.loc[:, data.columns == 'label']
    model = xgb.XGBRegressor(max_depth=5, learning_rate=0.03, n_estimators=300)
    model.fit(feature_data, label_data)

    # è®¡ç®—é‡è¦åº¦
    feature_importances = pd.DataFrame({
        'feature': feature_data.columns,
        'roc_auc': calc_feature_importance_roc_auc(feature_data, label_data['label'].apply(func=lambda x : 1 if x > 0.01 else 0))[0],
        'shap': calc_feature_importance_shap(model, feature_data.sample(1000000)),
        'xgb': model.feature_importances_,
    })

    # ä¿å­˜åˆ°æ–‡ä»¶
    feature_importances.to_csv('feature_importances.csv')
```


## ç‰¹å¾å½’ä¸€åŒ–

feature scalingçš„æ–¹æ³•å¯ä»¥åˆ†æˆ2ç±»ï¼Œ**é€è¡Œ**è¿›è¡Œå’Œ**é€åˆ—**è¿›è¡Œã€‚

å¸¸è§æ–¹æ³•å¦‚ä¸‹ï¼š
- é€è¡Œï¼š`å†ç¼©æ”¾` **Rescaling** (min-max normalizationã€range scaling)ï¼šç¼©æ”¾åˆ°åŒºé—´[ a , b ]
  - å°†æ¯ä¸€ç»´ç‰¹å¾çº¿æ€§æ˜ å°„åˆ°ç›®æ ‡èŒƒå›´[ a,b ]ï¼Œå³å°†æœ€å°å€¼æ˜ å°„ä¸ºaï¼Œæœ€å¤§å€¼æ˜ å°„ä¸ºbï¼Œå¸¸ç”¨ç›®æ ‡èŒƒå›´ä¸º[ 0 , 1 ]å’Œ[âˆ’1 , 1]
- é€è¡Œï¼š`ä¸­å¿ƒæ ‡å‡†åŒ–` **Mean normalization**
  - å°†å‡å€¼æ˜ å°„ä¸º0ï¼ŒåŒæ—¶ç”¨æœ€å¤§å€¼æœ€å°å€¼çš„å·®å¯¹ç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–
- é€è¡Œï¼š`Zæ ‡å‡†åŒ–` **Standardization** (Z-score Normalization)
  - æ¯ç»´ç‰¹å¾0å‡å€¼1æ–¹å·®ï¼ˆzero-mean and unit-varianceï¼‰
- é€åˆ—ï¼š`å•ä½æ ‡å‡†åŒ–` Scaling to unit length
  - æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡é™¤ä»¥å…¶**é•¿åº¦**ï¼Œå³å¯¹æ ·æœ¬ç‰¹å¾å‘é‡çš„é•¿åº¦è¿›è¡Œå½’ä¸€åŒ–ï¼Œé•¿åº¦çš„åº¦é‡å¸¸ä½¿ç”¨çš„æ˜¯L2 normï¼ˆæ¬§æ°è·ç¦»ï¼‰ï¼Œæœ‰æ—¶ä¹Ÿä¼šé‡‡ç”¨L1 norm

å‰3ç§feature scalingçš„è®¡ç®—æ–¹å¼ä¸ºå‡ä¸€ä¸ªç»Ÿè®¡é‡å†é™¤ä»¥ä¸€ä¸ªç»Ÿè®¡é‡ï¼Œæœ€å1ç§ä¸ºé™¤ä»¥å‘é‡è‡ªèº«çš„é•¿åº¦ã€‚
- **å‡**ä¸€ä¸ªç»Ÿè®¡é‡å¯ä»¥çœ‹æˆé€‰å“ªä¸ªå€¼ä½œä¸ºåŸç‚¹ï¼Œæ˜¯æœ€å°å€¼è¿˜æ˜¯å‡å€¼ï¼Œå¹¶å°†æ•´ä¸ªæ•°æ®é›†å¹³ç§»åˆ°è¿™ä¸ªæ–°çš„åŸç‚¹ä½ç½®ã€‚å¦‚æœç‰¹å¾é—´åç½®ä¸åŒå¯¹åç»­è¿‡ç¨‹æœ‰è´Ÿé¢å½±å“ï¼Œåˆ™è¯¥æ“ä½œæ˜¯æœ‰ç›Šçš„ï¼Œå¯ä»¥çœ‹æˆæ˜¯æŸç§åç½®æ— å…³æ“ä½œï¼›å¦‚æœåŸå§‹ç‰¹å¾å€¼æœ‰ç‰¹æ®Šæ„ä¹‰ï¼Œæ¯”å¦‚ç¨€ç–æ€§ï¼Œè¯¥æ“ä½œå¯èƒ½ä¼šç ´åå…¶ç¨€ç–æ€§ã€‚
- **é™¤**ä»¥ä¸€ä¸ªç»Ÿè®¡é‡å¯ä»¥çœ‹æˆåœ¨åæ ‡è½´æ–¹å‘ä¸Šå¯¹ç‰¹å¾è¿›è¡Œç¼©æ”¾ï¼Œç”¨äºé™ä½ç‰¹å¾å°ºåº¦çš„å½±å“ï¼Œå¯ä»¥çœ‹æˆæ˜¯æŸç§å°ºåº¦æ— å…³æ“ä½œã€‚ç¼©æ”¾å¯ä»¥ä½¿ç”¨æœ€å¤§å€¼æœ€å°å€¼é—´çš„è·¨åº¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡å‡†å·®ï¼ˆåˆ°ä¸­å¿ƒç‚¹çš„å¹³å‡è·ç¦»ï¼‰ï¼Œå‰è€…å¯¹outliersæ•æ„Ÿï¼Œoutlierså¯¹åè€…å½±å“ä¸outliersæ•°é‡å’Œæ•°æ®é›†å¤§å°æœ‰å…³ï¼Œoutliersè¶Šå°‘æ•°æ®é›†è¶Šå¤§å½±å“è¶Šå°ã€‚
- **é™¤**ä»¥**é•¿åº¦**ç›¸å½“äºæŠŠé•¿åº¦å½’ä¸€åŒ–ï¼ŒæŠŠæ‰€æœ‰æ ·æœ¬æ˜ å°„åˆ°å•ä½çƒä¸Šï¼Œå¯ä»¥çœ‹æˆæ˜¯æŸç§é•¿åº¦æ— å…³æ“ä½œï¼Œæ¯”å¦‚ï¼Œè¯é¢‘ç‰¹å¾è¦ç§»é™¤æ–‡ç« é•¿åº¦çš„å½±å“ï¼Œå›¾åƒå¤„ç†ä¸­æŸäº›ç‰¹å¾è¦ç§»é™¤å…‰ç…§å¼ºåº¦çš„å½±å“ï¼Œä»¥åŠæ–¹ä¾¿è®¡ç®—ä½™å¼¦è·ç¦»æˆ–å†…ç§¯ç›¸ä¼¼åº¦ç­‰ã€‚

ä»å‡ ä½•ä¸Šè§‚å¯Ÿä¸Šè¿°æ–¹æ³•çš„ä½œç”¨ï¼Œå›¾ç‰‡æ¥è‡ª[CS231n-Neural Networks Part 2: Setting up the Data and the Loss](http://cs231n.github.io/neural-networks-2/)
- zero-meanå°†æ•°æ®é›†å¹³ç§»åˆ°åŸç‚¹
- unit-varianceä½¿æ¯ç»´ç‰¹å¾ä¸Šçš„è·¨åº¦ç›¸å½“ï¼Œå›¾ä¸­å¯ä»¥æ˜æ˜¾çœ‹å‡ºä¸¤ç»´ç‰¹å¾é—´å­˜åœ¨çº¿æ€§ç›¸å…³æ€§
- Standardizationæ“ä½œå¹¶æ²¡æœ‰æ¶ˆé™¤è¿™ç§ç›¸å…³æ€§ã€‚
- ![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9zMi5heDF4LmNvbS8yMDE5LzEwLzMxL0tJd1hIeC5wbmc?x-oss-process=image/format,png)

å¯é€šè¿‡PCAæ–¹æ³•ç§»é™¤**çº¿æ€§ç›¸å…³æ€§**ï¼ˆdecorrelationï¼‰ï¼Œå³å¼•å…¥**æ—‹è½¬**ï¼Œæ‰¾åˆ°æ–°çš„åæ ‡è½´æ–¹å‘ï¼Œåœ¨æ–°åæ ‡è½´æ–¹å‘ä¸Šç”¨â€œæ ‡å‡†å·®â€è¿›è¡Œç¼©æ”¾
- ![](https://s2.ax1x.com/2019/10/30/K4Zmtg.png)

æ€»çš„æ¥è¯´ï¼Œå½’ä¸€åŒ–/æ ‡å‡†åŒ–çš„ç›®çš„æ˜¯ä¸ºäº†**è·å¾—æŸç§â€œæ— å…³æ€§â€**â€”â€”**åç½®**æ— å…³ã€**å°ºåº¦**æ— å…³ã€**é•¿åº¦**æ— å…³â€¦â€¦å½“å½’ä¸€åŒ–/æ ‡å‡†åŒ–æ–¹æ³•èƒŒåçš„ç‰©ç†æ„ä¹‰å’Œå‡ ä½•å«ä¹‰ä¸å½“å‰é—®é¢˜çš„éœ€è¦ç›¸å¥‘åˆæ—¶ï¼Œå…¶å¯¹è§£å†³è¯¥é—®é¢˜å°±æœ‰**æ­£å‘**ä½œç”¨ï¼Œåä¹‹ï¼Œå°±ä¼šèµ·**åä½œç”¨**ã€‚æ‰€ä»¥ï¼Œâ€œä½•æ—¶é€‰æ‹©ä½•ç§æ–¹æ³•â€å–å†³äºå¾…è§£å†³çš„é—®é¢˜ï¼Œå³problem-dependentã€‚

å¸¸è§çš„ç‰¹å¾ç¼©æ”¾æ–¹æ³•
- ![](https://picx.zhimg.com/80/v2-ad8d6bd86908d6766f8be8ed6a889d5a_1440w.jpg?source=1940ef5c)

### éæ­£æ€å˜æ¢

éæ­£å¤ªæ•°æ®çš„è½¬æ¢æ–¹æ³•æœ‰ï¼š
- å¯¹æ•°å˜åŒ–
- å¹³æ–¹æ ¹å˜åŒ–
- å€’æ•°å˜æ¢
- å¹³æ–¹æ ¹åå–å€’æ•°
- å¹³æ–¹æ ¹åå†å–åæ­£å¼¦
- å¹‚è½¬æ¢
- ![](https://images2017.cnblogs.com/blog/1055519/201711/1055519-20171116113836796-743016758.png)

åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼ˆPå€¼<0.003ï¼‰ä¸Šè¿°æ–¹æ³•å¾ˆéš¾å®ç°æ­£æ€åŒ–å¤„ç†ï¼Œæ‰€ä»¥ä¼˜å…ˆä½¿ç”¨Box-Coxè½¬æ¢ï¼Œä½†æ˜¯å½“På€¼>0.003æ—¶ä¸¤ç§æ–¹æ³•å‡å¯ï¼Œä¼˜å…ˆè€ƒè™‘æ™®é€šçš„å¹³æ–¹å˜æ¢ã€‚
- `På€¼`å³**æ¦‚ç‡**ï¼Œåæ˜ æŸä¸€äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§å¤§å°ã€‚
- ç»Ÿè®¡å­¦æ ¹æ®æ˜¾è‘—æ€§æ£€éªŒæ–¹æ³•æ‰€å¾—åˆ°çš„P å€¼ï¼Œä¸€èˆ¬ä»¥
  - P<0.05 ä¸ºæœ‰ç»Ÿè®¡å­¦å·®å¼‚
  - P<0.01 ä¸ºæœ‰**æ˜¾è‘—**ç»Ÿè®¡å­¦å·®å¼‚
  - P<0.001ä¸ºæœ‰**æå…¶æ˜¾è‘—**çš„ç»Ÿè®¡å­¦å·®å¼‚ã€‚
- å…¶å«ä¹‰æ˜¯æ ·æœ¬é—´çš„å·®å¼‚ç”±æŠ½æ ·è¯¯å·®æ‰€è‡´çš„æ¦‚ç‡å°äº0.05 ã€0.01ã€0.001ã€‚
- å®é™…ä¸Šï¼ŒPå€¼ä¸èƒ½èµ‹äºˆæ•°æ®ä»»ä½•é‡è¦æ€§ï¼Œåªèƒ½è¯´æ˜æŸäº‹ä»¶å‘ç”Ÿçš„å‡ ç‡ã€‚
- ç»Ÿè®¡ç»“æœä¸­æ˜¾ç¤ºPr > Fï¼Œä¹Ÿå¯å†™æˆPr( >F)ï¼ŒP = P{ F0.05 > F}æˆ–P = P{ F0.01 > F}ã€‚ç»Ÿè®¡å­¦ä¸Šä¸€èˆ¬På€¼å¤§äº0.05æˆ‘ä»¬å¯è®¤ä¸ºè¯¥ç»„æ•°æ®æ˜¯ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚

[box-coxè§£è¯»](https://www.cnblogs.com/triple-y/p/11244798.html?share_token=5720051e-dbba-4b4b-8607-7348c0e76550)

### æ­£æ€å˜åŒ–



#### Box-Cox å˜æ¢ â€”â€” ç»“æ„åŒ–æ•°æ®å˜æ¢

Box-Coxå˜æ¢æ˜¯Boxå’ŒCoxåœ¨1964å¹´æå‡ºçš„ä¸€ç§å¹¿ä¹‰å¹‚å˜æ¢æ–¹æ³•ï¼Œæ˜¯ç»Ÿè®¡å»ºæ¨¡ä¸­å¸¸ç”¨çš„ä¸€ç§æ•°æ®å˜æ¢ï¼Œç”¨äºè¿ç»­çš„å“åº”å˜é‡ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒçš„æƒ…å†µã€‚Box-Coxå˜æ¢ä¹‹åï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°ä¸å¯è§‚æµ‹çš„è¯¯å·®å’Œé¢„æµ‹å˜é‡çš„ç›¸å…³æ€§ã€‚Box-Coxå˜æ¢çš„ä¸»è¦ç‰¹ç‚¹æ˜¯å¼•å…¥ä¸€ä¸ªå‚æ•°ï¼Œé€šè¿‡æ•°æ®æœ¬èº«ä¼°è®¡è¯¥å‚æ•°è¿›è€Œç¡®å®šåº”é‡‡å–çš„æ•°æ®å˜æ¢å½¢å¼ï¼ŒBox-Coxå˜æ¢å¯ä»¥æ˜æ˜¾åœ°æ”¹å–„æ•°æ®çš„æ­£æ€æ€§ã€å¯¹ç§°æ€§å’Œæ–¹å·®ç›¸ç­‰æ€§ï¼Œå¯¹è®¸å¤šå®é™…æ•°æ®éƒ½æ˜¯è¡Œä¹‹æœ‰æ•ˆçš„ã€‚
- ![](https://p6-bk.byteimg.com/tos-cn-i-mlhdmxsy5m/d2d5b9714002441ab03a810984220d28~tplv-mlhdmxsy5m-q75:0:0.image)

ç”±äº**çº¿æ€§å›å½’**æ˜¯åŸºäº**æ­£æ€åˆ†å¸ƒ**çš„å‰æå‡è®¾ï¼Œæ‰€ä»¥å¯¹å…¶è¿›è¡Œç»Ÿè®¡åˆ†ææ—¶ï¼Œéœ€ç»è¿‡æ•°æ®çš„è½¬æ¢ï¼Œä½¿å¾—æ•°æ®ç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚
- Box å’Œ Coxåœ¨1964å¹´æå‡ºçš„Box-Coxå˜æ¢å¯ä½¿çº¿æ€§å›å½’æ¨¡å‹æ»¡è¶³**çº¿æ€§æ€§**ã€**ç‹¬ç«‹æ€§**ã€**æ–¹å·®é½æ€§**ä»¥åŠ**æ­£æ€æ€§**æ—¶ï¼Œåˆä¸ä¸¢å¤±ä¿¡æ¯ã€‚

Box-Coxå˜æ¢æ˜¯ç»Ÿè®¡å»ºæ¨¡ä¸­å¸¸ç”¨çš„ä¸€ç§æ•°æ®å˜æ¢ï¼Œç”¨äº**è¿ç»­**å“åº”å˜é‡ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒçš„æƒ…å†µã€‚
- çº¿æ€§æ¨¡å‹å‡å®š: $ Y=XÎ² + Îµ $, å…¶ä¸­Îµæ»¡è¶³**æ­£æ€åˆ†å¸ƒ**ï¼Œä½†æ˜¯åˆ©ç”¨å®é™…æ•°æ®å»ºç«‹å›å½’æ¨¡å‹æ—¶ï¼Œä¸ªåˆ«å˜é‡çš„ç³»æ•°é€šä¸è¿‡ã€‚
- ä¾‹å¦‚å¾€å¾€ä¸å¯è§‚æµ‹çš„è¯¯å·® Îµ å¯èƒ½æ˜¯å’Œé¢„æµ‹å˜é‡ç›¸å…³çš„ï¼Œä¸æœä»æ­£æ€åˆ†å¸ƒï¼Œäºæ˜¯ç»™çº¿æ€§å›å½’çš„æœ€å°äºŒä¹˜ä¼°è®¡ç³»æ•°çš„ç»“æœå¸¦æ¥è¯¯å·®ï¼Œä¸ºäº†ä½¿æ¨¡å‹æ»¡è¶³**çº¿æ€§æ€§**ã€**ç‹¬ç«‹æ€§**ã€**æ–¹å·®é½æ€§**ä»¥åŠ**æ­£æ€æ€§**ï¼Œéœ€æ”¹å˜æ•°æ®å½¢å¼ï¼Œæ•…åº”ç”¨box-coxè½¬æ¢ã€‚
- å˜æ¢ä¹‹åï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°ä¸å¯è§‚æµ‹çš„è¯¯å·®å’Œé¢„æµ‹å˜é‡çš„ç›¸å…³æ€§ã€‚ä½†æ˜¯é€‰æ‹©çš„å‚æ•°è¦é€‚å½“ï¼Œä½¿ç”¨**æå¤§ä¼¼ç„¶ä¼°è®¡**å¾—åˆ°çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ä¸Šè¿°è¿‡ç¨‹çš„æ•ˆæœæ›´å¥½ã€‚å½“ç„¶ï¼Œåšè¿‡Box-Coxå˜æ¢ä¹‹åï¼Œæ–¹å·®é½æ€§çš„é—®é¢˜ä¸ä¸€å®šä¼šæ¶ˆå¤±ï¼Œåšè¿‡ä¹‹åä»ç„¶éœ€è¦åšæ–¹å·®é½æ€§çš„æ£€éªŒï¼Œçœ‹æ˜¯å¦è¿˜éœ€è¦é‡‡ç”¨å…¶ä»–æ–¹æ³•ã€‚

å˜æ¢å…¬å¼: æºè‡ª [ç»“æ„åŒ–æ•°æ®è½¬æ¢ï¼ˆBox-Cox)](https://www.cnblogs.com/zhengzhe/p/8993867.html?share_token=f63d5774-b44a-47e3-b310-04cb8cb80e50)
- ![](https://images2018.cnblogs.com/blog/1074595/201805/1074595-20180505095938667-1357616992.png)

Box-Coxå˜æ¢çš„ä¸€ä¸ªæ˜¾è‘—ä¼˜ç‚¹
- é€šè¿‡æ±‚å˜æ¢å‚æ•°æ¥ç¡®å®šå˜æ¢å½¢å¼ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹å®Œå…¨åŸºäºæ•°æ®æœ¬èº«è€Œæ— é¡»ä»»ä½•å…ˆéªŒä¿¡æ¯ï¼Œè¿™æ— ç–‘æ¯”å‡­ç»éªŒæˆ–é€šè¿‡å°è¯•è€Œé€‰ç”¨å¯¹æ•°ã€å¹³æ–¹æ ¹ç­‰å˜æ¢æ–¹å¼è¦å®¢è§‚å’Œç²¾ç¡®ã€‚

å˜æ¢çš„ç›®çš„æ˜¯ä¸ºäº†è®©æ•°æ®æ»¡è¶³çº¿æ€§æ¨¡å‹çš„åŸºæœ¬å‡å®šï¼Œå³**çº¿æ€§**ã€**æ­£æ€æ€§**åŠ**æ–¹å·®é½æ€§**ï¼Œç„¶è€Œç»å˜æ¢åæ•°æ®æ˜¯å¦åŒæ—¶æ»¡è¶³äº†ä»¥ä¸Šå‡å®šï¼Œä»éœ€è¦è€ƒå¯ŸéªŒè¯ã€‚

## ç‰¹å¾åˆ†ç®±

`ç‰¹å¾åˆ†ç®±`ï¼ˆbinningï¼‰æ•°å€¼å‹ç‰¹å¾çš„åˆ†ç®±å³ç‰¹å¾**ç¦»æ•£åŒ–**
- æŒ‰ç…§æŸç§æ–¹æ³•æŠŠç‰¹å¾å€¼æ˜ å°„åˆ°æœ‰é™çš„å‡ ä¸ªâ€œ**æ¡¶**ï¼ˆbinï¼‰â€å†…ã€‚
- æ¯”å¦‚ï¼Œå¯ä»¥æŠŠ1å¤©24ä¸ªå°æ—¶æŒ‰ç…§å¦‚ä¸‹è§„åˆ™åˆ’åˆ†ä¸º5ä¸ªæ¡¶ï¼Œä½¿å¾—æ¯ä¸ªæ¡¶å†…çš„ä¸åŒæ—¶é—´éƒ½æœ‰ç±»ä¼¼çš„ç›®æ ‡é¢„æµ‹èƒ½åŠ›ï¼Œæ¯”å¦‚æœ‰ç±»ä¼¼çš„è´­ä¹°æ¦‚ç‡ã€‚
- 0-3 Night: è¾ƒä½çš„è´­ä¹°æ¦‚ç‡
- 4-7 Early morning: ä¸­ç­‰çš„è´­ä¹°æ¦‚ç‡
- 8-14 Morning/Lunch: è¾ƒé«˜çš„è´­ä¹°æ¦‚ç‡
- 15-20 Afternoon: è¾ƒä½çš„è´­ä¹°æ¦‚ç‡
- 21-23: Evening: é«˜è´­ä¹°æ¦‚ç‡

ä¸ºä»€ä¹ˆéœ€è¦åšç‰¹å¾åˆ†ç®±ï¼Ÿ
- å¼•å…¥**éçº¿æ€§å˜æ¢**ï¼Œå¯å¢å¼ºæ¨¡å‹çš„æ€§èƒ½
- å¢å¼ºç‰¹å¾å¯è§£é‡Šæ€§
- å¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿã€é˜²æ­¢è¿‡æ‹Ÿåˆ
- åˆ†ç®±ä¹‹åå¯ä»¥å¯¹ä¸åŒçš„æ¡¶åšè¿›ä¸€æ­¥çš„ç»Ÿè®¡å’Œç»„åˆï¼ˆä¸å…¶ä»–ç‰¹å¾çš„äº¤å‰ï¼‰

æœ‰å“ªäº›åˆ†ç®±æ–¹æ³•ï¼Ÿ
- æ— ç›‘ç£åˆ†ç®± 
  - å›ºå®šå®½åº¦åˆ†ç®±ï¼ˆç­‰å®½ï¼‰
  - åˆ†ä½æ•°åˆ†ç®±ï¼ˆç­‰å®½ï¼‰
  - å¯¹æ•°è½¬æ¢å¹¶å–æ•´ï¼ˆå¯¹æ•°ï¼‰
- æœ‰ç›‘ç£åˆ†ç®± 
  - å¡æ–¹åˆ†ç®±å†³ç­–æ ‘åˆ†ç®±

## ç¦»æ•£ç‰¹å¾å¸¸ç”¨å˜æ¢


### a) äº¤å‰ç»„åˆ

<img src="https://picx.zhimg.com/50/v2-1beb3416e05753de022e4265cc9276be_720w.jpg"/>

å¦‚ä¸Šå›¾ï¼Œmeanè¡¨ç¤ºé¢„æµ‹ç›®æ ‡targetï¼ˆäºŒåˆ†ç±»ï¼‰çš„å‡å€¼ï¼Œç‰¹å¾f1å’Œf2å•ç‹¬å­˜åœ¨æ—¶éƒ½ä¸å…·å¤‡å¾ˆå¥½çš„åŒºåˆ†æ€§ï¼Œä½†ä¸¤ç§ç»„åˆèµ·æ¥ä½œä¸ºä¸€ä¸ªæ•´ä½“æ—¶å´èƒ½å¤Ÿå¯¹targetæœ‰å¾ˆå¥½çš„é¢„æµ‹æ€§ã€‚
- <img src="https://pica.zhimg.com/50/v2-f55863414017ef894ccf2fb156274bfd_720w.jpg">
- å¦‚ä¸Šå›¾ï¼Œå½“åªæœ‰x1å’Œx2æ—¶ï¼Œç›®æ ‡ï¼ˆç”¨è“è‰²å’Œé»„è‰²åˆ†åˆ«è¡¨ç¤ºæ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬ï¼‰ä¸æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œå½“å¼•å…¥ä¸€ä¸ªç»„åˆç‰¹å¾x3=x1x2æ—¶å°±å¯ä»¥ç”¨sign(x3)æ¥é¢„æµ‹ç›®æ ‡äº†ã€‚

### b) åˆ†ç®±ï¼ˆbinningï¼‰

é«˜åŸºæ•°ï¼ˆhigh-cardinalityï¼‰ç±»åˆ«å‹ç‰¹å¾ä¹Ÿæœ‰å¿…è¦åšç‰¹å¾åˆ†ç®±ã€‚è¿™æ˜¯å› ä¸ºé«˜åŸºæ•°ç‰¹å¾ç›¸å¯¹äºä½åŸºæ•°ç‰¹å¾å¤„äºæ”¯é…åœ°ä½ï¼ˆå°¤å…¶åœ¨tree basedæ¨¡å‹ä¸­ï¼‰ï¼Œå¹¶ä¸”å®¹æ˜“å¼•å…¥å™ªéŸ³ï¼Œå¯¼è‡´æ¨¡å‹è¿‡æ‹Ÿåˆã€‚ç”šè‡³ä¸€äº›å€¼å¯èƒ½åªä¼šå‡ºç°åœ¨è®­ç»ƒé›†ä¸­ï¼Œå¦ä¸€äº›å¯èƒ½åªä¼šå‡ºç°åœ¨æµ‹è¯•é›†ä¸­ã€‚

ç±»åˆ«å‹ç‰¹å¾çš„åˆ†ç®±æ–¹æ³•é€šå¸¸æœ‰å¦‚ä¸‹ä¸‰ç§ï¼š
- åŸºäºä¸šåŠ¡ç†è§£è‡ªå®šä¹‰åˆ†ç®±è§„åˆ™ï¼Œæ¯”å¦‚å¯ä»¥æŠŠåŸå¸‚åˆ’åˆ†ä¸ºåå—åŒºã€ååŒ—åŒºã€åä¸œåŒºç­‰ã€‚
- åŸºäºç‰¹å¾çš„é¢‘æ¬¡åˆå¹¶ä½é¢‘é•¿å°¾éƒ¨åˆ†ï¼ˆback-offï¼‰ã€‚
- åŸºäºå†³ç­–æ ‘æ¨¡å‹ã€‚

### c) ç»Ÿè®¡ç¼–ç 

1. Count Encoding
  - ç»Ÿè®¡è¯¥ç±»åˆ«å‹ç‰¹å¾ä¸åŒè¡Œä¸ºç±»å‹ã€ä¸åŒæ—¶é—´å‘¨æœŸå†…çš„å‘ç”Ÿçš„é¢‘æ¬¡ã€‚
2. Target Encoding
  - ç»Ÿè®¡è¯¥ç±»åˆ«å‹ç‰¹å¾ä¸åŒè¡Œä¸ºç±»å‹ã€ä¸åŒæ—¶é—´å‘¨æœŸå†…çš„ç›®æ ‡è½¬åŒ–ç‡ï¼ˆå¦‚ç›®æ ‡æ˜¯ç‚¹å‡»åˆ™ä¸ºç‚¹å‡»ç‡ï¼Œå¦‚ç›®æ ‡æ˜¯æˆäº¤åˆ™ä¸ºè´­ä¹°ç‡ï¼‰ã€‚ ç›®æ ‡è½¬åŒ–ç‡éœ€è¦è€ƒè™‘ç½®ä¿¡åº¦çš„é—®é¢˜ï¼Œå½“ç½®ä¿¡åº¦ä¸å¤Ÿçš„æ—¶å€™ï¼Œéœ€è¦åšå¹³æ»‘ï¼Œæ‹¿å…¨å±€æˆ–è€…åˆ†ç»„çš„å¹³å‡è½¬åŒ–ç‡å½“å½“å‰ç‰¹å¾çš„è½¬åŒ–ç‡åšä¸€ä¸ªå¹³æ»‘ï¼Œå…¬å¼å¦‚ä¸‹ã€‚ <img src="https://pic3.zhimg.com/50/v2-38e9426d072024927ccec02f2cf6a35a_720w.jpg" />
3. Odds Ratio
  - ä¼˜åŠ¿æ¯”æ˜¯å½“å‰ç‰¹å¾å–å€¼çš„ä¼˜åŠ¿ï¼ˆoddsï¼‰ä¸å…¶ä»–ç‰¹å¾å–å€¼çš„ä¼˜åŠ¿ï¼ˆoddsï¼‰çš„æ¯”å€¼ï¼Œå…¬å¼ä¸ºï¼š
  - theta = p1/(1-p1) / p2/(1-p2)
4. WOE(weight of evidence)
  - WOEåº¦é‡ä¸åŒç‰¹å¾å–å€¼ä¸ç›®æ ‡çš„ç›¸å…³ç¨‹åº¦ï¼Œè¶Šæ­£è¡¨ç¤ºè¶Šæ­£ç›¸å…³ï¼Œè¶Šè´Ÿè¡¨ç¤ºè¶Šè´Ÿç›¸å…³ã€‚


## æ—¶åºç‰¹å¾

- å†å²äº‹ä»¶åˆ†æ—¶æ®µç»Ÿè®¡
  - ç»Ÿè®¡è¿‡å»1å¤©ã€3å¤©ã€7å¤©ã€30å¤©çš„æ€»ï¼ˆå¹³å‡ï¼‰è¡Œä¸ºæ•°
  - ç»Ÿè®¡è¿‡å»1å¤©ã€3å¤©ã€7å¤©ã€30å¤©çš„è¡Œä¸ºè½¬åŒ–ç‡
- å·®å¼‚
  - ç¯æ¯”ã€åŒæ¯”
- è¡Œä¸ºåºåˆ—
  - éœ€è¦æ¨¡å‹é…åˆ

## ç‰¹å¾å·¥ç¨‹æŠ€å·§

ã€2023-1-26ã€‘ç‰¹å¾å·¥ç¨‹ä¹¦ç±
- ã€2020-2-1ã€‘ã€å®ç”¨ç‰¹å¾å·¥ç¨‹æŠ€å·§ã€‘'Tips-of-Feature-engineering - A feature engineering kit for each issue, to give you a deeper and deeper understanding of the work of feature engineering' by SamLam ï¼ŒGitHub: [ç½‘é¡µé“¾æ¥](https://github.com/Pysamlam/Tips-of-Feature-engineering)
- ã€2018-8-16ã€‘æœºå™¨å­¦ä¹ ä¸­çš„ç‰¹å¾å·¥ç¨‹ï¼Œéšä¹¦[ä»£ç ](https://github.com/alicezheng/feature-engineering-book)

ğŸ† Tips-of-Feature-engineering

A feature engineering kit for each issue, to give you a deeper and deeper understanding of the work of feature engineering!

ä¸“é¡¹çªç ´ï¼Œæ¯ä¸€æœŸéƒ½ä¼šåˆ†äº«ä¸€äº›å¾ˆå®ç”¨çš„**ç‰¹å¾å·¥ç¨‹**æŠ€å·§ï¼Œä»ç†è®ºåˆ°å®è·µï¼Œå¾ªåºæ¸è¿›ï¼Œç›®å‰æœ¬é¡¹ç›®å·²ç´¯è®¡æ’°å†™äº†28æœŸå†…å®¹ï¼Œä¸ºäº†æ–¹ä¾¿ç»Ÿä¸€é˜…è¯»ï¼ŒğŸ“¦æ‰“åŒ…æˆäº†ä¸€ä»½PDFä¾›æœ‹å‹ä»¬ä¸‹è½½ã€‚
æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€ŠSAMshareã€‹ï¼Œä¸ä½œè€…é˜¿Samå–å¾—äº¤æµï¼

![image](./arrests/å…¬ä¼—å·äºŒç»´ç .jpg)

éšç€åœ¨æœºå™¨å­¦ä¹ ã€æ•°æ®å»ºæ¨¡ã€æ•°æ®æŒ–æ˜åˆ†æè¿™æ¡å‘å±•è·¯ä¸Šè¶Šèµ°è¶Šè¿œï¼Œå…¶å®è¶Šä¼šæ„Ÿè§‰åˆ°ç‰¹å¾å·¥ç¨‹çš„é‡è¦æ€§ï¼Œå¹³æ—¶æˆ‘ä»¬åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä¼šçœ‹åˆ°ä¸€äº›å¾ˆå¥½çš„ç‰¹å¾å·¥ç¨‹æŠ€å·§ï¼Œæœ¬é¡¹ç›®çš„ç›®çš„å°±æ˜¯æŠŠè¿™äº›å°æŠ€å·§æ‰“åŒ…æˆä¸€ä¸ªåˆä¸€ä¸ªçš„å°é”¦å›Šï¼Œä¾›å¤§å®¶å»é˜…è¯»ã€‚

é¦–å…ˆæ˜¯å½“å‰æ›´æ–°åˆ°çš„ç›®å½•ï¼Œæ–¹ä¾¿å¤§å®¶å»æŸ¥æ‰¾å†…å®¹ï¼

æ•°æ®é›†å¤§å®¶å¯ä»¥[ç‚¹å‡»è¿™é‡Œ](https://github.com/Pysamlam/Tips-of-Feature-engineering/tree/master/data)å»è¿›è¡Œä¸‹è½½å“ˆğŸ˜†

## ç›®å½•ï¼šKeep updating

* [Tip1ï¼šç‰¹å¾æ— é‡çº²åŒ–çš„å¸¸è§æ“ä½œæ–¹æ³•](#tip1ç‰¹å¾æ— é‡çº²åŒ–çš„å¸¸è§æ“ä½œæ–¹æ³•)
* [Tip2ï¼šæ€ä¹ˆè¿›è¡Œå¤šé¡¹å¼orå¯¹æ•°çš„æ•°æ®å˜æ¢](#tip2æ€ä¹ˆè¿›è¡Œå¤šé¡¹å¼orå¯¹æ•°çš„æ•°æ®å˜æ¢)
* [Tip3ï¼šå¸¸ç”¨çš„ç»Ÿè®¡å›¾åœ¨Pythoné‡Œæ€ä¹ˆç”»?](#tip3å¸¸ç”¨çš„ç»Ÿè®¡å›¾åœ¨Pythoné‡Œæ€ä¹ˆç”»)
* [Tip4ï¼šæ€ä¹ˆå»é™¤DataFrameé‡Œçš„ç¼ºå¤±å€¼ï¼Ÿ](#tip4æ€ä¹ˆå»é™¤DataFrameé‡Œçš„ç¼ºå¤±å€¼)
* [Tip5ï¼šæ€ä¹ˆæŠŠè¢«é”™è¯¯å¡«å……çš„ç¼ºå¤±å€¼è¿˜åŸï¼Ÿ](#tip5æ€ä¹ˆæŠŠè¢«é”™è¯¯å¡«å……çš„ç¼ºå¤±å€¼è¿˜åŸ)
* [Tip6ï¼šæ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……åˆ†ç±»å˜é‡çš„ç©ºå€¼ï¼Ÿ](#tip6æ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……åˆ†ç±»å˜é‡çš„ç©ºå€¼)
* [Tip7ï¼šæ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……æ•°å€¼å˜é‡çš„ç©ºå€¼ï¼Ÿ](#tip7æ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……æ•°å€¼å˜é‡çš„ç©ºå€¼)
* [Tip8ï¼šæ€ä¹ˆæŠŠå‡ ä¸ªå›¾è¡¨ä¸€èµ·åœ¨åŒä¸€å¼ å›¾ä¸Šæ˜¾ç¤ºï¼Ÿ](#tip8æ€ä¹ˆæŠŠå‡ ä¸ªå›¾è¡¨ä¸€èµ·åœ¨åŒä¸€å¼ å›¾ä¸Šæ˜¾ç¤º)
* [Tip9ï¼šæ€ä¹ˆæŠŠç”»å‡ºå †ç§¯å›¾æ¥çœ‹å æ¯”å…³ç³»ï¼Ÿ](#tip9æ€ä¹ˆæŠŠç”»å‡ºå †ç§¯å›¾æ¥çœ‹å æ¯”å…³ç³»)
* [Tip10ï¼šæ€ä¹ˆå¯¹æ»¡è¶³æŸç§æ¡ä»¶çš„å˜é‡ä¿®æ”¹å…¶å˜é‡å€¼ï¼Ÿ](#tip10æ€ä¹ˆå¯¹æ»¡è¶³æŸç§æ¡ä»¶çš„å˜é‡ä¿®æ”¹å…¶å˜é‡å€¼ï¼Ÿ)
* [Tip11ï¼šæ€ä¹ˆé€šè¿‡æ­£åˆ™æå–å­—ç¬¦ä¸²é‡Œçš„æŒ‡å®šå†…å®¹?](#tip11æ€ä¹ˆé€šè¿‡æ­£åˆ™æå–å­—ç¬¦ä¸²é‡Œçš„æŒ‡å®šå†…å®¹)
* [Tip12ï¼šå¦‚ä½•åˆ©ç”¨å­—å…¸æ‰¹é‡ä¿®æ”¹å˜é‡å€¼ï¼Ÿ](#tip12å¦‚ä½•åˆ©ç”¨å­—å…¸æ‰¹é‡ä¿®æ”¹å˜é‡å€¼)
* [Tip13ï¼šå¦‚ä½•å¯¹ç±»åˆ«å˜é‡è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Ÿ](#tip13å¦‚ä½•å¯¹ç±»åˆ«å˜é‡è¿›è¡Œç‹¬çƒ­ç¼–ç )
* [Tip14ï¼šå¦‚ä½•æŠŠâ€œå¹´é¾„â€å­—æ®µæŒ‰ç…§æˆ‘ä»¬çš„é˜ˆå€¼åˆ†æ®µï¼Ÿ](#tip14å¦‚ä½•æŠŠ"å¹´é¾„"å­—æ®µæŒ‰ç…§æˆ‘ä»¬çš„é˜ˆå€¼åˆ†æ®µ)
* [Tip15ï¼šå¦‚ä½•ä½¿ç”¨sklearnçš„å¤šé¡¹å¼æ¥è¡ç”Ÿæ›´å¤šçš„å˜é‡ï¼Ÿ](#tip15å¦‚ä½•ä½¿ç”¨sklearnçš„å¤šé¡¹å¼æ¥è¡ç”Ÿæ›´å¤šçš„å˜é‡)
* [Tip16ï¼šå¦‚ä½•æ ¹æ®å˜é‡ç›¸å…³æ€§ç”»å‡ºçƒ­åŠ›å›¾ï¼Ÿ](#tip16å¦‚ä½•æ ¹æ®å˜é‡ç›¸å…³æ€§ç”»å‡ºçƒ­åŠ›å›¾)
* [Tip17ï¼šå¦‚ä½•æŠŠåˆ†å¸ƒä¿®æ­£ä¸ºç±»æ­£æ€åˆ†å¸ƒï¼Ÿ](#tip17å¦‚ä½•æŠŠåˆ†å¸ƒä¿®æ­£ä¸ºç±»æ­£æ€åˆ†å¸ƒ)
* [Tip18ï¼šæ€ä¹ˆæ‰¾å‡ºæ•°æ®é›†ä¸­æœ‰æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼Ÿ](#tip18æ€ä¹ˆæ‰¾å‡ºæ•°æ®é›†ä¸­æœ‰æ•°æ®å€¾æ–œçš„ç‰¹å¾)
* [Tip19ï¼šæ€ä¹ˆå°½å¯èƒ½åœ°ä¿®æ­£æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼Ÿ](#tip19æ€ä¹ˆå°½å¯èƒ½åœ°ä¿®æ­£æ•°æ®å€¾æ–œçš„ç‰¹å¾)
* [Tip20ï¼šæ€ä¹ˆç®€å•ä½¿ç”¨PCAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢ï¼Ÿ](#Tip20æ€ä¹ˆç®€å•ä½¿ç”¨PCAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢)
* [Tip21ï¼šæ€ä¹ˆç®€å•ä½¿ç”¨LDAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢ï¼Ÿ](#Tip21æ€ä¹ˆç®€å•ä½¿ç”¨LDAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢)
* [Tip22ï¼šæ€ä¹ˆæ¥ç®¡ç†æˆ‘ä»¬çš„å»ºæ¨¡é¡¹ç›®æ–‡ä»¶ï¼Ÿ](#Tip22æ€ä¹ˆæ¥ç®¡ç†æˆ‘ä»¬çš„å»ºæ¨¡é¡¹ç›®æ–‡ä»¶)
* [Tip23ï¼šæ€ä¹ˆæ‰¹é‡æŠŠç‰¹å¾ä¸­çš„ç¦»ç¾¤ç‚¹ç»™å®‰æ’ä¸€ä¸‹ï¼Ÿ](#Tip23æ€ä¹ˆæ‰¹é‡æŠŠç‰¹å¾ä¸­çš„ç¦»ç¾¤ç‚¹ç»™å®‰æ’ä¸€ä¸‹)
* [Tip24ï¼šå½»åº•äº†è§£ä¸€ä¸‹WOEå’ŒIV](#Tip24å½»åº•äº†è§£ä¸€ä¸‹WOEå’ŒIV)
* [Tip25ï¼šä¸€æ–‡ä»‹ç»ç‰¹å¾å·¥ç¨‹é‡Œçš„å¡æ–¹åˆ†ç®±ï¼Œé™„ä»£ç å®ç°](#tip25ä¸€æ–‡ä»‹ç»ç‰¹å¾å·¥ç¨‹é‡Œçš„å¡æ–¹åˆ†ç®±é™„ä»£ç å®ç°)
* [Tip26ï¼šä»Šå¤©ä¸€èµ·ææ‡‚æœºå™¨å­¦ä¹ é‡Œçš„L1ä¸L2æ­£åˆ™åŒ–](#Tip26ä»Šå¤©ä¸€èµ·ææ‡‚æœºå™¨å­¦ä¹ é‡Œçš„L1ä¸L2æ­£åˆ™åŒ–)
* [Tip27ï¼šé‡‘èé£æ§é‡Œçš„WOEå‰çš„åˆ†ç®±ä¸€å®šè¦å•è°ƒå—ï¼Ÿ](#Tip27é‡‘èé£æ§é‡Œçš„WOEå‰çš„åˆ†ç®±ä¸€å®šè¦å•è°ƒå—)
* [Tip28ï¼šå¦‚ä½•åœ¨Pythonä¸­å¤„ç†ä¸å¹³è¡¡æ•°æ®](#Tip28å¦‚ä½•åœ¨Pythonä¸­å¤„ç†ä¸å¹³è¡¡æ•°æ®)


## Tip1ï¼šç‰¹å¾æ— é‡çº²åŒ–çš„å¸¸è§æ“ä½œæ–¹æ³•

ç¬¬ä¸€æ‹›ï¼Œä»ç®€å•çš„ç‰¹å¾é‡çº²å¤„ç†å¼€å§‹ï¼Œè¿™é‡Œä»‹ç»äº†3ç§æ— é‡çº²åŒ–æ“ä½œçš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿé™„ä¸Šç›¸å…³çš„åŒ…ä»¥åŠè°ƒç”¨æ–¹æ³•ï¼Œæ¬¢è¿è¡¥å……ï¼

> æ— é‡çº²åŒ–ï¼šå³nondimensionalize æˆ–è€…dimensionlessï¼Œæ˜¯æŒ‡é€šè¿‡ä¸€ä¸ªåˆé€‚çš„å˜é‡æ›¿ä»£ï¼Œå°†ä¸€ä¸ªæ¶‰åŠç‰©ç†é‡çš„æ–¹ç¨‹çš„éƒ¨åˆ†æˆ–å…¨éƒ¨çš„å•ä½ç§»é™¤ï¼Œä»¥æ±‚ç®€åŒ–å®éªŒæˆ–è€…è®¡ç®—çš„ç›®çš„ã€‚â€”â€”ç™¾åº¦ç™¾ç§‘



è¿›è¡Œè¿›ä¸€æ­¥è§£é‡Šï¼Œæ¯”å¦‚æœ‰ä¸¤ä¸ªå­—æ®µï¼Œä¸€ä¸ªæ˜¯è½¦è¡Œèµ°çš„å…¬é‡Œæ•°ï¼Œå¦ä¸€ä¸ªæ˜¯äººè·‘æ­¥çš„è·ç¦»ï¼Œä»–ä»¬ä¹‹é—´çš„å•ä½å…¶å®å·®å¼‚è¿˜æ˜¯æŒºå¤§çš„ï¼Œå…¶å®ä¸¤è€…ä¹‹é—´æ— æ³•è¿›è¡Œæ¯”è¾ƒçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿›è¡Œå»é‡çº²ï¼ŒæŠŠä»–ä»¬çš„å˜é‡å€¼è¿›è¡Œç¼©æ”¾ï¼Œéƒ½ç»Ÿä¸€åˆ°æŸä¸€ä¸ªåŒºé—´å†…ï¼Œæ¯”å¦‚0-1ï¼Œä¾¿äºä¸åŒå•ä½æˆ–è€…é‡çº§ä¹‹é—´çš„æŒ‡æ ‡å¯ä»¥è¿›è¡Œæ¯”è¾ƒoråŠ æƒï¼

ä¸‹é¢çš„æ˜¯sklearné‡Œçš„ä¸€äº›æ— é‡çº²åŒ–çš„å¸¸è§æ“ä½œæ–¹æ³•ã€‚

```python
from sklearn.datasets import load_iris  
#å¯¼å…¥IRISæ•°æ®é›†  
iris = load_iris()

#æ ‡å‡†åŒ–ï¼Œè¿”å›å€¼ä¸ºæ ‡å‡†åŒ–åçš„æ•°æ®  
from sklearn.preprocessing import StandardScaler  
StandardScaler().fit_transform(iris.data)  

#åŒºé—´ç¼©æ”¾ï¼Œè¿”å›å€¼ä¸ºç¼©æ”¾åˆ°[0, 1]åŒºé—´çš„æ•°æ®  
from sklearn.preprocessing import MinMaxScaler  
MinMaxScaler().fit_transform(iris.data)  

#å½’ä¸€åŒ–ï¼Œè¿”å›å€¼ä¸ºå½’ä¸€åŒ–åçš„æ•°æ®
from sklearn.preprocessing import Normalizer  
Normalizer().fit_transform(iris.data)
```
<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip2ï¼šæ€ä¹ˆè¿›è¡Œå¤šé¡¹å¼orå¯¹æ•°çš„æ•°æ®å˜æ¢?

æ•°æ®å˜æ¢ï¼Œè¿™ä¸ªæ“ä½œåœ¨ç‰¹å¾å·¥ç¨‹ä¸­ç”¨å¾—è¿˜æ˜¯è›®å¤šçš„ï¼Œä¸€ä¸ªç‰¹å¾åœ¨å½“å‰çš„åˆ†å¸ƒä¸‹æ— æ³•æœ‰æ˜æ˜¾çš„åŒºåˆ†åº¦ï¼Œä½†ä¸€ä¸ªå°å°çš„å˜æ¢åˆ™å¯ä»¥å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æ•ˆæœï¼Œè€Œè¿™ä¸ªå°å°çš„å˜æ¢ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©ç»™å¤§å®¶åˆ†äº«çš„å°é”¦å›Šã€‚

#### å¤šé¡¹å¼å˜æ¢

æŒ‰ç…§æŒ‡å®šçš„degreeï¼Œè¿›è¡Œå¤šé¡¹å¼æ“ä½œä»è€Œè¡ç”Ÿå‡ºæ–°å˜é‡(å½“ç„¶è¿™æ˜¯é’ˆå¯¹æ¯ä¸€åˆ—ç‰¹å¾å†…çš„æ“ä½œ)ã€‚

ä¸¾ä¸ªæ —å­ï¼š

```python
from sklearn.datasets import load_iris  
#å¯¼å…¥IRISæ•°æ®é›†  
iris = load_iris()
iris.data[0]

# Output: array([ 5.1,  3.5,  1.4,  0.2])
```

```python
tt = PolynomialFeatures().fit_transform(iris.data)  
tt[0]

# Output: array([  1.  ,   5.1 ,   3.5 ,   1.4 ,   0.2 ,  26.01,  17.85,   7.14, 1.02,  12.25,   4.9 ,   0.7 ,   1.96,   0.28,   0.04])
```

å› ä¸ºPolynomialFeatures()æ–¹æ³•é»˜è®¤degreeæ˜¯2ï¼Œæ‰€ä»¥åªä¼šè¿›è¡ŒäºŒé¡¹å¼çš„è¡ç”Ÿã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå¤šé¡¹å¼å˜æ¢éƒ½æ˜¯æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼æ¥çš„ï¼š

f = kx + b   ä¸€æ¬¡å‡½æ•°ï¼ˆdegreeä¸º1ï¼‰

f = ax^2 + b*x + w  äºŒæ¬¡å‡½æ•°ï¼ˆdegreeä¸º2ï¼‰

f = a*x^3 + b*x^2 + c*x + w  ä¸‰æ¬¡å‡½æ•°ï¼ˆdegreeä¸º3ï¼‰

è¿™ç±»çš„è½¬æ¢å¯ä»¥é€‚å½“åœ°æå‡æ¨¡å‹çš„æ‹Ÿåˆèƒ½åŠ›ï¼Œå¯¹äºåœ¨çº¿æ€§å›å½’æ¨¡å‹ä¸Šçš„åº”ç”¨è¾ƒä¸ºå¹¿æ³›ã€‚



#### å¯¹æ•°å˜æ¢

è¿™ä¸ªæ“ä½œå°±æ˜¯ç›´æ¥è¿›è¡Œä¸€ä¸ªå¯¹æ•°è½¬æ¢ï¼Œæ”¹å˜åŸå…ˆçš„æ•°æ®åˆ†å¸ƒï¼Œè€Œå¯ä»¥è¾¾åˆ°çš„ä½œç”¨ä¸»è¦æœ‰:

1ï¼‰å–å®Œå¯¹æ•°ä¹‹åå¯ä»¥ç¼©å°æ•°æ®çš„ç»å¯¹æ•°å€¼ï¼Œæ–¹ä¾¿è®¡ç®—ï¼›

2ï¼‰å–å®Œå¯¹æ•°ä¹‹åå¯ä»¥æŠŠä¹˜æ³•è®¡ç®—è½¬æ¢ä¸ºåŠ æ³•è®¡ç®—ï¼›

3ï¼‰è¿˜æœ‰å°±æ˜¯åˆ†å¸ƒæ”¹å˜å¸¦æ¥çš„æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚



numpyåº“é‡Œå°±æœ‰å¥½å‡ ç±»å¯¹æ•°è½¬æ¢çš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡from numpy import xxx è¿›è¡Œå¯¼å…¥ä½¿ç”¨ã€‚

logï¼šè®¡ç®—è‡ªç„¶å¯¹æ•°

log10ï¼šåº•ä¸º10çš„log

log2ï¼šåº•ä¸º2çš„log

log1pï¼šåº•ä¸ºeçš„log

#### ä»£ç é›†åˆ

```python
from sklearn.datasets import load_iris  
#å¯¼å…¥IRISæ•°æ®é›†  
iris = load_iris()

#å¤šé¡¹å¼è½¬æ¢  
#å‚æ•°degreeä¸ºåº¦ï¼Œé»˜è®¤å€¼ä¸º2 
from sklearn.preprocessing import PolynomialFeatures  
PolynomialFeatures().fit_transform(iris.data)  

#å¯¹æ•°å˜æ¢
from numpy import log1p  
from sklearn.preprocessing import FunctionTransformer  
#è‡ªå®šä¹‰è½¬æ¢å‡½æ•°ä¸ºå¯¹æ•°å‡½æ•°çš„æ•°æ®å˜æ¢  
#ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å•å˜å…ƒå‡½æ•°  
FunctionTransformer(log1p).fit_transform(iris.data)  
```
<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip3ï¼šå¸¸ç”¨çš„ç»Ÿè®¡å›¾åœ¨Pythoné‡Œæ€ä¹ˆç”»?

è¿™é‡Œçš„è¯æˆ‘ä»¬ä»‹ç»å‡ ç§å¾ˆç®€å•ä½†ä¹Ÿå¾ˆå®ç”¨çš„ç»Ÿè®¡å›¾ç»˜åˆ¶æ–¹æ³•ï¼Œåˆ†åˆ«æœ‰æ¡å½¢å›¾ã€é¥¼å›¾ã€ç®±ä½“å›¾ã€ç›´æ–¹å›¾ä»¥åŠæ•£ç‚¹å›¾ï¼Œå…³äºè¿™å‡ ç§å›¾å½¢çš„å«ä¹‰è¿™è¾¹å°±ä¸å¤šåšè§£é‡Šäº†ã€‚

ä»Šå¤©ç”¨åˆ°ä¸¤ä¸ªæ•°æ®é›†ï¼Œæ•°æ®é›†å¤§å®¶å¯ä»¥åœ¨å…¬ä¼—å·å›å¤"ç‰¹å¾å·¥ç¨‹"æ¥è·å–ï¼Œåˆ†åˆ«æ˜¯**Salary_Ranges_by_Job_Classificationå’ŒGlobalLandTemperaturesByCity**ã€‚

#### æ•ˆæœå›¾ï¼š

![image-20191227230928468](./arrests/1.png)

![image-20191227230949512](./arrests/2.png)

![image-20191227231000989](./arrests/3.png)

![image-20191227231016574](./arrests/4.png)

![image-20191227231027274](./arrests/5.png)

#### ä»£ç é›†åˆ

```python
# å¯¼å…¥ä¸€äº›å¸¸ç”¨åŒ…
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

%matplotlib inline
plt.style.use('fivethirtyeight')

#è§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼ŒMac
%matplotlib inline
from matplotlib.font_manager import FontProperties


# å¼•å…¥ç¬¬ 1 ä¸ªæ•°æ®é›† Salary_Ranges_by_Job_Classification
salary_ranges = pd.read_csv('./data/Salary_Ranges_by_Job_Classification.csv')

# å¼•å…¥ç¬¬ 2 ä¸ªæ•°æ®é›† GlobalLandTemperaturesByCity
climate = pd.read_csv('./data/GlobalLandTemperaturesByCity.csv')
# ç§»é™¤ç¼ºå¤±å€¼
climate.dropna(axis=0, inplace=True)
# åªçœ‹ä¸­å›½
# æ—¥æœŸè½¬æ¢, å°†dt è½¬æ¢ä¸ºæ—¥æœŸï¼Œå–å¹´ä»½, æ³¨æ„mapçš„ç”¨æ³•
climate['dt'] = pd.to_datetime(climate['dt'])
climate['year'] = climate['dt'].map(lambda value: value.year)
climate_sub_china = climate.loc[climate['Country'] == 'China']
climate_sub_china['Century'] = climate_sub_china['year'].map(lambda x:int(x/100 +1))

# è®¾ç½®æ˜¾ç¤ºçš„å°ºå¯¸
plt.rcParams['figure.figsize'] = (4.0, 4.0) # è®¾ç½®figure_sizeå°ºå¯¸
plt.rcParams['image.interpolation'] = 'nearest' # è®¾ç½® interpolation style
plt.rcParams['image.cmap'] = 'gray' # è®¾ç½® é¢œè‰² style
plt.rcParams['savefig.dpi'] = 100 #å›¾ç‰‡åƒç´ 
plt.rcParams['figure.dpi'] = 100 #åˆ†è¾¨ç‡
plt.rcParams['font.family'] = ['Arial Unicode MS'] #æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡

# ç»˜åˆ¶æ¡å½¢å›¾
salary_ranges['Grade'].value_counts().sort_values(ascending=False).head(10).plot(kind='bar')
# ç»˜åˆ¶é¥¼å›¾
salary_ranges['Grade'].value_counts().sort_values(ascending=False).head(5).plot(kind='pie')
# ç»˜åˆ¶ç®±ä½“å›¾
salary_ranges['Union Code'].value_counts().sort_values(ascending=False).head(5).plot(kind='box')
# ç»˜åˆ¶ç›´æ–¹å›¾
climate['AverageTemperature'].hist()
# ç»˜åˆ¶æ•£ç‚¹å›¾
x = climate_sub_china['year']
y = climate_sub_china['AverageTemperature']
fig, ax = plt.subplots(figsize=(10,5))
ax.scatter(x, y)
plt.show()
```
<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip4ï¼šæ€ä¹ˆå»é™¤DataFrameé‡Œçš„ç¼ºå¤±å€¼ï¼Ÿ

è¿™ä¸ªæˆ‘ä»¬ç»å¸¸ä¼šç”¨ï¼Œå½“æˆ‘ä»¬å‘ç°æŸä¸ªå˜é‡çš„ç¼ºå¤±ç‡å¤ªé«˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šç›´æ¥å¯¹å…¶è¿›è¡Œåˆ é™¤æ“ä½œï¼Œåˆæˆ–è€…è¯´æŸä¸€è¡Œæˆ‘ä¸æƒ³è¦äº†ï¼Œæƒ³å•ç‹¬åˆ é™¤è¿™ä¸€è¡Œæ•°æ®ï¼Œè¿™ä¸ªæˆ‘ä»¬è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿè¿™é‡Œä»‹ç»ä¸€ä¸ªæ–¹æ³•ï¼ŒDataFrame.dropna()ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹å›¾ï¼š

![image-20191228074829720](./arrests/6.png)

ä»æ–¹æ³•ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®š `axis` çš„å€¼ï¼Œå¦‚æœæ˜¯0ï¼Œé‚£å°±æ˜¯æŒ‰ç…§è¡Œå»è¿›è¡Œç©ºå€¼åˆ é™¤ï¼Œå¦‚æœæ˜¯1åˆ™æ˜¯æŒ‰ç…§åˆ—å»è¿›è¡Œæ“ä½œï¼Œé»˜è®¤æ˜¯0ã€‚

åŒæ—¶ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°æ˜¯`how` ,å°±æ˜¯é€‰æ‹©åˆ é™¤çš„æ¡ä»¶ï¼Œå¦‚æœæ˜¯ `any`åˆ™æ˜¯å¦‚æœå­˜åœ¨ä¸€ä¸ªç©ºå€¼ï¼Œåˆ™è¿™è¡Œ(åˆ—)çš„æ•°æ®éƒ½ä¼šè¢«åˆ é™¤ï¼Œå¦‚æœæ˜¯ `all`çš„è¯ï¼Œåªæœ‰å½“è¿™è¡Œ(åˆ—)å…¨éƒ¨çš„å˜é‡å€¼ä¸ºç©ºæ‰ä¼šè¢«åˆ é™¤ï¼Œé»˜è®¤çš„è¯éƒ½æ˜¯`any` ã€‚

å¥½äº†ï¼Œä¸¾å‡ ä¸ªæ —å­ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨climateæ•°æ®é›†ï¼š

```python
# å¼•å…¥æ•°æ®é›†
import pandas as pd
climate = pd.read_csv('./data/GlobalLandTemperaturesByCity.csv')
# ä¿ç•™ä¸€éƒ¨åˆ†åˆ—
data = climate.loc[:,['dt','AverageTemperature','AverageTemperatureUncertainty','City']]
data.head()
```

#### ç»Ÿè®¡æœ‰å¤šå°‘ç¼ºå¤±å€¼

```python
# æŸ¥çœ‹æœ‰å¤šå°‘ç¼ºå¤±å€¼
print(data.isnull().sum())
print('\n')
# æŸ¥çœ‹ç¼ºå¤±å€¼å æ¯”
print(data.isnull().sum()/len(data))
```

![image-20191228081417965](./arrests/7.png)

#### åˆ é™¤æ“ä½œ

```python
# åŸå§‹æ¨¡æ ·
print(data.head())
print('\n')

# é»˜è®¤å‚æ•°axis=0ï¼Œæ ¹æ®ç´¢å¼•(index)åˆ é™¤æŒ‡å®šçš„è¡Œï¼Œåˆ é™¤ç¬¬0è¡Œæ•°æ®
print(data.drop(0).head())
print('\n')

# axis=1,æ ¹æ®åˆ—å(columns)åˆ é™¤æŒ‡å®šçš„åˆ—ï¼Œåˆ é™¤'dt'åˆ—
print(data.drop('dt',axis=1).head())
print('\n')

# ç§»é™¤å«æœ‰ç¼ºå¤±å€¼çš„è¡Œï¼Œç›´æ¥ç»“æœä½œä¸ºæ–°df
data.dropna(axis=0, inplace=True)
```

![image-20191228081435160](./arrests/8.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip5ï¼šæ€ä¹ˆæŠŠè¢«é”™è¯¯å¡«å……çš„ç¼ºå¤±å€¼è¿˜åŸï¼Ÿ

ä¸Šä¸ªå°é”¦å›Šè®²åˆ°æˆ‘ä»¬å¯ä»¥å¯¹ç¼ºå¤±å€¼è¿›è¡Œä¸¢å¼ƒå¤„ç†ï¼Œä½†æ˜¯è¿™ç§æ“ä½œå¾€å¾€ä¼šä¸¢å¤±äº†å¾ˆå¤šä¿¡æ¯çš„ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½éœ€è¦å…ˆçœ‹çœ‹ç¼ºå¤±çš„åŸå› ï¼Œå¦‚æœæœ‰äº›ç¼ºå¤±æ˜¯æ­£å¸¸å­˜åœ¨çš„ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦è¿›è¡Œä¸¢å¼ƒï¼Œä¿ç•™ç€å¯¹æˆ‘ä»¬çš„æ¨¡å‹å…¶å®å¸®åŠ©ä¼šæ›´å¤§çš„ã€‚

æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯æˆ‘ä»¬ç›´æ¥è¿›è¡Œç»Ÿè®¡ï¼Œå®ƒæ˜¯æ²¡æœ‰ç¼ºå¤±çš„ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ç¼ºå¤±çš„ï¼Œä»€ä¹ˆæ„æ€ï¼Ÿå°±æ˜¯è¯´ç¼ºå¤±è¢«äººä¸ºï¼ˆç³»ç»Ÿï¼‰åœ°è¿›è¡Œäº†å¡«å……ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„ç”¨0ã€-9ã€-999ã€blankç­‰æ¥è¿›è¡Œå¡«å……ç¼ºå¤±ï¼Œè‹¥çœŸé‡è§è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå¤„ç†å‘¢ï¼Ÿ

å¾ˆç®€å•ï¼Œé‚£å°±æ˜¯**è¿˜åŸç¼ºå¤±ï¼**

#### å•ä¸ªæ“ä½œ

```python
# å¼•å…¥æ•°æ®é›†(çš®é©¬å°ç¬¬å®‰äººç³–å°¿ç—…é¢„æµ‹æ•°æ®é›†)
pima_columns = ['times_pregment','plasma_glucose_concentration','diastolic_blood_pressure','triceps_thickness',
                'serum_insulin','bmi','pedigree_function','age','onset_disbetes']

pima = pd.read_csv('./data/pima.data', names=pima_columns)


# å¤„ç†è¢«é”™è¯¯å¡«å……çš„ç¼ºå¤±å€¼0ï¼Œè¿˜åŸä¸º ç©º(å•ç‹¬å¤„ç†)
pima['serum_insulin'] = pima['serum_insulin'].map(lambda x:x if x !=0 else None)
# æ£€æŸ¥å˜é‡ç¼ºå¤±æƒ…å†µ
pima['serum_insulin'].isnull().sum()

# Outputï¼š374
```

#### æ‰¹é‡æ“ä½œ

```python
# æ‰¹é‡æ“ä½œ è¿˜åŸç¼ºå¤±å€¼
columns = ['serum_insulin','bmi','plasma_glucose_concentration','diastolic_blood_pressure','triceps_thickness']

for col in columns:
    pima[col].replace([0], [None], inplace=True)

# æ£€æŸ¥å˜é‡ç¼ºå¤±æƒ…å†µ
pima.isnull().sum()
```

![image-20191228083228056](./arrests/9.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip6ï¼šæ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……åˆ†ç±»å˜é‡çš„ç©ºå€¼ï¼Ÿ

ä¹‹å‰æˆ‘ä»¬è¯´è¿‡å¦‚ä½•åˆ é™¤æ‰ç¼ºå¤±çš„è¡Œï¼Œä½†æ˜¯å¦‚ä½•æˆ‘ä»¬éœ€è¦çš„æ˜¯å¡«å……å‘¢ï¼Ÿæ¯”å¦‚è¯´ç”¨ä¼—æ•°æ¥å¡«å……ç¼ºå¤±ï¼Œæˆ–è€…ç”¨æŸä¸ªç‰¹å®šå€¼æ¥å¡«å……ç¼ºå¤±å€¼ï¼Ÿè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦æŒæ¡çš„ç‰¹å¾å·¥ç¨‹çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå¯¹äºç”¨ç‰¹å®šå€¼å¡«å……ç¼ºå¤±ï¼Œå…¶å®æ¯”è¾ƒç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨`fillna()` æ–¹æ³•å°±å¯ä»¥ï¼Œä¸‹é¢æˆ‘æ¥è®²ä¸€ä¸ªé€šç”¨çš„åŠæ³•ï¼Œé™¤äº†ç”¨ç‰¹å®šå€¼å¡«å……ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ï¼Œæ¯”å¦‚è¯´ç”¨â€ä¼—æ•°â€œæ¥å¡«å……ç­‰ç­‰ã€‚

è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†`TransformerMixin`æ–¹æ³•ï¼Œç„¶åè‡ªå®šä¹‰ä¸€ä¸ªå¡«å……å™¨æ¥è¿›è¡Œç¼ºå¤±å€¼çš„å¡«å……ã€‚

è¿™é‡Œæˆ‘ä»¬é€ ä¸€ä¸ªæ•°æ®é›†æ¥æµ‹è¯•æˆ‘ä»¬çš„ä»£ç ï¼š

```python
# æœ¬æ¬¡æ¡ˆä¾‹ä½¿ç”¨çš„æ•°æ®é›†
import pandas as pd
X = pd.DataFrame({'city':['tokyo',None,'london','seattle','san fancisco','tokyo'],
                  'boolean':['y','n',None,'n','n','y'],
                  'ordinal_column':['somewhat like','like','somewhat like','like','somewhat like','dislike'],
                  'quantitative_column':[1,11,-.5,10,None,20]})
X
```

![image-20191231230535024](./arrests/10.png)



å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ•°æ®é›†æœ‰ä¸‰ä¸ªåˆ†ç±»å˜é‡ï¼Œåˆ†åˆ«æ˜¯booleanã€cityå’Œordinal_columnï¼Œè€Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªå­—æ®µå­˜åœ¨ç©ºå€¼ã€‚



```python
# å¡«å……åˆ†ç±»å˜é‡ï¼ˆåŸºäºTransformerMixinçš„è‡ªå®šä¹‰å¡«å……å™¨ï¼Œç”¨ä¼—æ•°å¡«å……ï¼‰
from sklearn.base import TransformerMixin
class CustomCategoryzImputer(TransformerMixin):
    def __init__(self, cols=None):
        self.cols = cols
        
    def transform(self, df):
        X = df.copy()
        for col in self.cols:
            X[col].fillna(X[col].value_counts().index[0], inplace=True)
        return X
    
    def fit(self, *_):
        return self   
    
# è°ƒç”¨è‡ªå®šä¹‰çš„å¡«å……å™¨
cci = CustomCategoryzImputer(cols=['city','boolean'])
cci.fit_transform(X)
```

![image-20191231230946764](./arrests/11.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 


## Tip7ï¼šæ€ä¹ˆå®šä¹‰ä¸€ä¸ªæ–¹æ³•å»å¡«å……æ•°å€¼å˜é‡çš„ç©ºå€¼ï¼Ÿ

è¿™ä¸ªé”¦å›Šå’Œä¸Šä¸€ä¸ªå·®ä¸å¤šäº†ï¼Œä¸è¿‡è¿™ä¸ªæ¢ä¸€ä¸ªæ–¹æ³• `Imputer` ã€‚

åŒæ ·çš„ï¼Œæˆ‘ä»¬è¿˜æ˜¯é€ ä¸€ä¸ªæ•°æ®é›†ï¼š

```python
# æœ¬æ¬¡æ¡ˆä¾‹ä½¿ç”¨çš„æ•°æ®é›†
import pandas as pd
X = pd.DataFrame({'city':['tokyo',None,'london','seattle','san fancisco','tokyo'],
                  'boolean':['y','n',None,'n','n','y'],
                  'ordinal_column':['somewhat like','like','somewhat like','like','somewhat like','dislike'],
                  'quantitative_column':[1,11,-.5,10,None,20]})
X
```

![image-20191231230535024](./arrests/10.png)



å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ•°æ®é›†æœ‰ä¸€ä¸ªæ•°å€¼å˜é‡`quantitative_columns`ï¼Œå­˜åœ¨ä¸€è¡Œç¼ºå¤±å€¼ï¼Œæˆ‘ä»¬ç›´æ¥è°ƒç”¨`sklearn`çš„`preprocessing`æ–¹æ³•é‡Œçš„`Imputer`ã€‚

```python
# å¡«å……æ•°å€¼å˜é‡ï¼ˆåŸºäºImputerçš„è‡ªå®šä¹‰å¡«å……å™¨ï¼Œç”¨ä¼—æ•°å¡«å……ï¼‰
from sklearn.preprocessing import Imputer
class CustomQuantitativeImputer(TransformerMixin):
    def __init__(self, cols=None, strategy='mean'):
        self.cols = cols
        self.strategy = strategy
        
    def transform(self, df):
        X = df.copy()
        impute = Imputer(strategy=self.strategy)
        for col in self.cols:
            X[col] = impute.fit_transform(X[[col]])
        return X
    
    def fit(self, *_):
        return self
    
# è°ƒç”¨è‡ªå®šä¹‰çš„å¡«å……å™¨
cqi = CustomQuantitativeImputer(cols = ['quantitative_column'], strategy='mean')
cqi.fit_transform(X)
```

![image-20191231231355341](./arrests/12.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip8ï¼šæ€ä¹ˆæŠŠå‡ ä¸ªå›¾è¡¨ä¸€èµ·åœ¨åŒä¸€å¼ å›¾ä¸Šæ˜¾ç¤ºï¼Ÿ

æœªæ¥å‡ ä¸ªç‰¹å¾é”¦å›Šçš„å†…å®¹ä¼šä½¿ç”¨æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥å»ä¸‹è½½æ•°æ®å“ˆã€‚

Titanicæ•°æ®é›†ä¸‹è½½ï¼šhttps://www.kaggle.com/c/titanic/data

é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œåšç‰¹å¾å·¥ç¨‹ä¹‹å‰çŸ¥é“æ•°æ®çš„åˆ†å¸ƒå’Œå…³è”æƒ…å†µæ˜¯æä¸ºé‡è¦çš„ï¼Œå› æ­¤æŠŠè¿™äº›ä¿¡æ¯åšä¸€äº›å¯è§†åŒ–çš„æ“ä½œæ˜¯å¾ˆé‡è¦çš„æ“ä½œå’ŒæŠ€èƒ½ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸‹æ€ä¹ˆç”»å¾ˆå¤šå¼ å›¾ï¼Œç„¶åå¯ä»¥ä¸€å¹¶æ˜¾ç¤ºåœ¨åŒä¸€å¼ ä¸Šå§ï¼Œä¸“ä¸šæ¥è¯´å°±æ˜¯ç”»å­å›¾ã€‚

#### å¯¼å…¥æ•°æ®é›†

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
data_train.head()
```

![image-20200104150617226](./arrests/13.png)

#### ä»£ç æ±‡é›†

```python
import matplotlib.pyplot as plt

# è®¾ç½®figure_sizeå°ºå¯¸
plt.rcParams['figure.figsize'] = (8.0, 6.0) 

fig = plt.figure()

# è®¾å®šå›¾è¡¨é¢œè‰²
fig.set(alpha=0.2)  

# ç¬¬ä¸€å¼ å°å›¾
plt.subplot2grid((2,3),(0,0))           
data_train['Survived'].value_counts().plot(kind='bar')
plt.ylabel(u"äººæ•°")  
plt.title(u"èˆ¹å‘˜è·æ•‘æƒ…å†µ (1ä¸ºè·æ•‘)")

# ç¬¬äºŒå¼ å°å›¾
plt.subplot2grid((2,3),(0,1))
data_train['Pclass'].value_counts().plot(kind="bar")
plt.ylabel(u"äººæ•°")
plt.title(u"ä¹˜å®¢ç­‰çº§åˆ†å¸ƒ")

# ç¬¬ä¸‰å¼ å°å›¾
plt.subplot2grid((2,3),(0,2))
plt.scatter(data_train['Survived'], data_train['Age'])
plt.ylabel(u"å¹´é¾„") 
plt.grid(b=True, which='major', axis='y') 
plt.title(u"æŒ‰å¹´é¾„çœ‹è·æ•‘åˆ†å¸ƒ (1ä¸ºè·æ•‘)")

# ç¬¬å››å¼ å°å›¾ï¼Œåˆ†å¸ƒå›¾
plt.subplot2grid((2,3),(1,0), colspan=2)
data_train.Age[data_train.Pclass == 1].plot(kind='kde')   
data_train.Age[data_train.Pclass == 2].plot(kind='kde')
data_train.Age[data_train.Pclass == 3].plot(kind='kde')
plt.xlabel(u"å¹´é¾„")
plt.ylabel(u"å¯†åº¦") 
plt.title(u"å„ç­‰çº§çš„ä¹˜å®¢å¹´é¾„åˆ†å¸ƒ")
plt.legend((u'å¤´ç­‰èˆ±', u'2ç­‰èˆ±',u'3ç­‰èˆ±'),loc='best')

# ç¬¬äº”å¼ å°å›¾
plt.subplot2grid((2,3),(1,2))
data_train.Embarked.value_counts().plot(kind='bar')
plt.title(u"å„ç™»èˆ¹å£å²¸ä¸Šèˆ¹äººæ•°")
plt.ylabel(u"äººæ•°")  
plt.show()
```

![image-20200104150744024](./arrests/14.png)

æˆ‘ä»¬ä»ä¸Šé¢çš„å¯è§†åŒ–æ“ä½œç»“æœå¯ä»¥çœ‹å‡ºï¼Œå…¶å®å¯ä»¥çœ‹å‡ºä¸€äº›è§„å¾‹ï¼Œæ¯”å¦‚è¯´ç”Ÿè¿˜çš„å‡ ç‡æ¯”æ­»äº¡çš„è¦å¤§ï¼Œç„¶åè·æ•‘çš„äººåœ¨å¹´é¾„ä¸ŠåŒºåˆ«ä¸å¤§ï¼Œç„¶åå°±æ˜¯æœ‰é’±äººï¼ˆåå¤´ç­‰èˆ±çš„ï¼‰çš„å¹´é¾„ä¼šåå¤§ç­‰ã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip9ï¼šæ€ä¹ˆæŠŠç”»å‡ºå †ç§¯å›¾æ¥çœ‹å æ¯”å…³ç³»ï¼Ÿ

æœªæ¥å‡ ä¸ªç‰¹å¾é”¦å›Šçš„å†…å®¹ä¼šä½¿ç”¨æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥å»ä¸‹è½½æ•°æ®å“ˆã€‚

Titanicæ•°æ®é›†ä¸‹è½½ï¼šhttps://www.kaggle.com/c/titanic/data



ä¸Šæ¬¡çš„é”¦å›Šæˆ‘çŸ¥é“äº†æ€ä¹ˆæŠŠå‡ å¼ å›¾æ”¾åœ¨ä¸€å¼ å›¾ä¸Šå»æ˜¾ç¤ºï¼Œä½†æ˜¯è¿™ä¸ªåªæ˜¯ä¸€ç§æ’ç‰ˆæ–¹å¼çš„æ“ä½œï¼Œä»Šå¤©åˆ†äº«ä¸€ä¸ªç”»å †ç§¯å›¾çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥çœ‹ç±»åˆ«å æ¯”å…³ç³»ï¼Œæœ‰åŠ©äºæˆ‘ä»¬å»äº†è§£æ•°æ®ï¼Œå‘ç°æ•°æ®é‡Œçš„è§„å¾‹ã€‚

#### å¯¼å…¥æ•°æ®é›†

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
data_train.head()
```

![image-20200104150617226](./arrests/13.png)



#### ä»£ç æ±‡é›†

```python
# è®¾ç½®figure_sizeå°ºå¯¸
plt.rcParams['figure.figsize'] = (5.0, 4.0) 

#çœ‹çœ‹å„ä¹˜å®¢ç­‰çº§çš„è·æ•‘æƒ…å†µ
fig = plt.figure()
fig.set(alpha=0.8)

Survived_0 = data_train.Pclass[data_train.Survived == 0].value_counts()
Survived_1 = data_train.Pclass[data_train.Survived == 1].value_counts()
df=pd.DataFrame({u'è·æ•‘':Survived_1, u'æœªè·æ•‘':Survived_0})
df.plot(kind='bar', stacked=True)
plt.title(u"å„ä¹˜å®¢ç­‰çº§çš„è·æ•‘æƒ…å†µ")
plt.xlabel(u"ä¹˜å®¢ç­‰çº§") 
plt.ylabel(u"äººæ•°") 
plt.show()
```

![image-20200105094525846](./arrests/15.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 



## Tip10ï¼šæ€ä¹ˆå¯¹æ»¡è¶³æŸç§æ¡ä»¶çš„å˜é‡ä¿®æ”¹å…¶å˜é‡å€¼ï¼Ÿ

æœªæ¥å‡ ä¸ªç‰¹å¾é”¦å›Šçš„å†…å®¹ä¼šä½¿ç”¨æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥å»ä¸‹è½½æ•°æ®å“ˆã€‚

Titanicæ•°æ®é›†ä¸‹è½½ï¼š

https://www.kaggle.com/c/titanic/data



è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨`loc`å‡½æ•°ï¼Œè¿™ä¸ªæ–¹å¼å®åœ¨æ˜¯å¤ªå¥½ç”¨äº†ï¼

é¦–å…ˆæˆ‘ä»¬å…ˆç†è§£ä¸€ä¸‹è¿™ä¸ª`loc`åº”è¯¥æ€ä¹ˆç”¨å§ï¼Œç„¶åå†ä¸¾å‡ ä¸ªå®æˆ˜ä¾‹å­æ¥ç†è§£ä¸€ä¸‹ã€‚

æˆ‘ä»¬è¦çŸ¥é“locå‡½æ•°çš„æ„æ€å°±æ˜¯é€šè¿‡è¡Œæ ‡ç­¾ç´¢å¼•è¡Œæ•°æ®ï¼Œæœ€ç›´æ¥çš„å°±æ˜¯çœ‹çœ‹æ–‡æ¡£ï¼Œå¼•ç”¨æ–‡æ¡£é‡Œçš„æ•°æ®é›†ï¼š

```python
df = pd.DataFrame([[1, 2], [4, 5], [7, 8]],index=['cobra', 'viper', 'sidewinder'],columns=['max_speed', 'shield'])
df
```

![image-20200105200816439](./arrests/16.png)

ä¸‹é¢çš„å°ä¾‹å­å°±æ˜¯ä»æ–‡æ¡£é‡Œæ‹¿è¿‡æ¥çš„ï¼Œå¾ˆå…¨é¢çš„ç¤ºä¾‹äº†ä¸€äº›åº”ç”¨æ“ä½œã€‚

![image-20200105200936822](./arrests/17.png)

![image-20200105201004990](./arrests/18.png)

é‚£ä¹ˆé€šè¿‡ä¸Šé¢çš„å­¦ä¹ ï¼Œä½ å¤§æ¦‚ä¹ŸçŸ¥é“äº†`loc`çš„ç®€å•ç”¨æ³•äº†ï¼Œä¸‹é¢å°±ä»‹ç»ä¸‹åœ¨ç‰¹å¾å·¥ç¨‹é‡Œæˆ‘ä»¬æ¸…æ´—æŸäº›æ•°æ®æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¿™å‡½æ•°æ¥ä¿®æ”¹å˜é‡å€¼ï¼Œä»è€Œè¾¾åˆ°æˆ‘ä»¬çš„æŸäº›ç›®çš„ã€‚



ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ç”¨æ³°å¦å°¼å·çš„æ•°æ®é›†ï¼š

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
data_train['Age'].value_counts().sort_index()
```

![image-20200105201448795](./arrests/19.png)

æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæœ‰äº›å¹´é¾„æœ‰å°äº1å²çš„ï¼Œæ¯”å¦‚0.42ã€0.67ä¹‹ç±»çš„ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ä½¿ç”¨ä¸€ä¸‹`loc`æ¥æŠŠè¿™äº›å°äº1å²çš„ä¿®æ”¹ä¸º1å²å§ï¼Œå¦‚æœæ²¡æœ‰æ„å¤–ï¼Œåº”è¯¥å²æ•°ä¸º1çš„ç»Ÿè®¡æ•°ä¼šå˜ä¸º14ä¸ªã€‚

```python
data_train.loc[(data_train.Age<=1),'Age'] = 1
data_train['Age'].value_counts().sort_index()
```

![image-20200105201854156](./arrests/20.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip11ï¼šæ€ä¹ˆé€šè¿‡æ­£åˆ™æå–å­—ç¬¦ä¸²é‡Œçš„æŒ‡å®šå†…å®¹?

è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åœ¨æˆ‘ä»¬åšå­—ç¬¦æå–ä¸­æ˜¯ååˆ†å¸¸ç”¨çš„ï¼Œå…ˆå‰æœ‰ä¸€ç¯‡æ–‡ç« æœ‰ä»‹ç»åˆ°æ€ä¹ˆå»ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥å®ç°æˆ‘ä»¬çš„ç›®çš„ï¼Œå¤§å®¶å¯ä»¥å…ˆå›é¡¾ä¸‹è¿™ç¯‡æ–‡ç« ã€‚

[å›¾æ–‡å¹¶èŒ‚åœ°å¸¦ä½ å…¥é—¨æ­£åˆ™è¡¨è¾¾å¼](https://mp.weixin.qq.com/s/F63qWLEWZY6vHGUK3pjnfA)


æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸€ä¸‹æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥å»ä¸‹è½½æ•°æ®å“ˆã€‚

Titanicæ•°æ®é›†ä¸‹è½½ï¼š

https://www.kaggle.com/c/titanic/data

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame
import re

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
data_train.head()
```

![image-20200106224916692](./arrests/21.png)

æˆ‘ä»¬ç°åœ¨å¯ä»¥æå–ä¸‹è¿™`name`é‡Œçš„ç§°è°“ï¼Œæ¯”å¦‚Mrã€Missä¹‹ç±»çš„ï¼Œä½œä¸ºä¸€ä¸ªæ–°åˆ—ï¼Œä»£ç å¦‚ä¸‹:

```python
data['Title'] = data['Name'].map(lambda x: re.compile(", (.*?)\.").findall(x)[0])
data.head()
```

![image-20200106225032595](./arrests/22.png)


æˆ‘ä»¬ä¹‹å‰çœ‹è¿™ä»£ç å…¶å®æœ‰ç‚¹æ‡µçš„ï¼Œä¸è¿‡è¿™æ˜¯å› ä¸ºå¤§å®¶å¯èƒ½å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™ä¸å¤ªç†Ÿæ‚‰ï¼Œæ‰€ä»¥ä¸‹é¢æœ‰å‡ ä¸ªç›¸å…³çš„å¯ä»¥å‚è€ƒä¸‹ã€‚

```python
import re
str = 'xxdaxxabxxacabxxcdabddbxxssbdffbggxx'
# ä¸€ä¸ª'.'å°±æ˜¯åŒ¹é…\n(æ¢è¡Œç¬¦)ä»¥å¤–çš„ä»»ä½•å­—ç¬¦
print(re.findall(r'a.b',str))

# ä¸€ä¸ª'*'å‰é¢çš„å­—ç¬¦å‡ºç°0æ¬¡æˆ–ä»¥ä¸Š
print(re.findall(r'a*b',str))

# åŒ¹é…ä».*å‰é¢çš„å­—ç¬¦ä¸ºèµ·ç‚¹ï¼Œåˆ°åé¢å­—ç¬¦ä¸ºç»ˆç‚¹çš„æ‰€æœ‰å†…å®¹ï¼Œç›´åˆ°è¿”å›æ‰€æœ‰
print(re.findall(r'xx.*xx',str))

# éè´ªå©ªï¼Œå’Œä¸Šé¢çš„ä¸€æ ·ï¼Œä¸è¿‡æ˜¯ç”¨è¿‡ä¸€æ¬¡å°±ä¸ä¼šå†ç”¨,ï¼Œä»¥åˆ—è¡¨çš„å½¢å¼è¿”å›
print(re.findall(r'xx.*?xx',str))

# éè´ªå©ªï¼Œä¸ä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸ä¸Šé¢ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªæ‹¬å·ï¼Œåªä¿ç•™æ‹¬å·ä¸­çš„å†…å®¹
print(re.findall(r'xx(.*?)xx',str))

# ä¿ç•™a,bä¸­é—´çš„å†…å®¹
print(re.findall(r'xx(.+?)xx',str))
print(re.findall(r'xx(.+?)xx',str)[0])
```

![image-20200106225154826](./arrests/23.png)



æ‰€ä»¥ï¼Œçœ‹äº†è¿™äº›åï¼Œåº”è¯¥å°±å¯ä»¥ç†è§£ä¸Šé¢çš„patternçš„å«ä¹‰äº†ï¼


<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 


## Tip12ï¼šå¦‚ä½•åˆ©ç”¨å­—å…¸æ‰¹é‡ä¿®æ”¹å˜é‡å€¼ï¼Ÿ

è¿™é‡Œæˆ‘ä»¬å‡è®¾æœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œä¸€ä¸ªå­—æ®µé‡Œçš„å˜é‡å€¼ï¼Œéœ€è¦æŠŠæŸå‡ ä¸ªå˜é‡å€¼ä¿®æ”¹ä¸ºåŒä¸€ä¸ªå€¼ï¼Œç„¶åå…¶ä»–å‡ ä¸ªå˜é‡å€¼ä¿®æ”¹ä¸ºå¦å¤–ä¸€ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä»€ä¹ˆç®€å•çš„åŠæ³•å¯ä»¥å®Œæˆå‘¢ï¼Ÿè¿™è¾¹ï¼Œæˆ‘æ¨èä¸€ä¸ª**å­—å…¸æ˜ å°„**çš„åŠæ³•ï¼

æˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸€ä¸‹æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¤§å®¶å¯ä»¥åœ¨ä¸‹é¢çš„é“¾æ¥å»ä¸‹è½½æ•°æ®å“ˆã€‚

Titanicæ•°æ®é›†ä¸‹è½½ï¼š

https://www.kaggle.com/c/titanic/data

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame
import re

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
# æå–å…¶ä¸­å‡ åˆ—
data = data_train.loc[:,['PassengerId','Name']]

# æå–ç§°è°“
data['Title'] = data['Name'].map(lambda x: re.compile(", (.*?)\.").findall(x)[0])
data.Title.value_counts()
```

![image-20200108082956766](./arrests/24.png)

å°±å¥½åƒæˆ‘åˆšåˆšæ‰€è¯´çš„ï¼Œéœ€è¦æŠŠé»„è‰²æ¡†æ¡†é‡Œçš„å˜é‡å€¼ä¿®æ”¹æ‰ï¼Œè€Œä¸”æ˜¯æŒ‰ç…§æˆ‘ä»¬çš„æƒ³æ³•ï¼Œæ¯”å¦‚`capt`å’Œ`Dr`åˆä¸ºä¸€ä½“ï¼Œç»Ÿä¸€å«`officer`ã€‚

```python
# å®šä¹‰ä¸€ä¸ªç©ºå­—å…¸æ¥æ”¶é›†æ˜ å°„å…³ç³»
title_Dict = {}
title_Dict.update(dict.fromkeys(['Capt', 'Col', 'Major', 'Dr', 'Rev'], 'Officer'))
title_Dict.update(dict.fromkeys(['Don', 'Sir', 'the Countess', 'Dona', 'Lady'], 'Royalty'))
title_Dict.update(dict.fromkeys(['Mme', 'Ms', 'Mrs'], 'Mrs'))
title_Dict.update(dict.fromkeys(['Mlle', 'Miss'], 'Miss'))
title_Dict.update(dict.fromkeys(['Mr'], 'Mr'))
title_Dict.update(dict.fromkeys(['Master','Jonkheer'], 'Master'))
title_Dict
```

![image-20200108083243631](./arrests/25.png)

æˆ‘ä»¬æŠŠæ˜ å°„å…³ç³»ç”¨å­—å…¸æ¥å­˜å‚¨ï¼Œåˆ°æ—¶å€™ç›´æ¥å¯ä»¥æ‹¿æ¥ç”¨ã€‚

```python
data['Title'] = data['Title'].map(title_Dict)
data.Title.value_counts()
```

![image-20200108083335530](./arrests/26.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip13ï¼šå¦‚ä½•å¯¹ç±»åˆ«å˜é‡è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Ÿ

å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ç±»åˆ«å˜é‡è¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Œç„¶åæ‰å¯ä»¥ä½œä¸ºå…¥å‚ç»™æ¨¡å‹ä½¿ç”¨ï¼Œç‹¬çƒ­çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³• `get_dummies`å§ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥è®©ç±»åˆ«å˜é‡æŒ‰ç…§æšä¸¾å€¼ç”ŸæˆNä¸ªï¼ˆNä¸ºæšä¸¾å€¼æ•°é‡ï¼‰æ–°å­—æ®µï¼Œéƒ½æ˜¯0-1çš„å˜é‡å€¼ã€‚

æˆ‘ä»¬è¿˜æ˜¯ç”¨åˆ°æˆ‘ä»¬çš„æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼ŒåŒæ—¶ä½¿ç”¨æˆ‘ä»¬ä¸Šæ¬¡é”¦å›Šåˆ†äº«çš„çŸ¥è¯†ï¼Œå¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†æ“ä½œï¼Œè§ä¸‹ï¼š

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame
import re

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
# æå–å…¶ä¸­å‡ åˆ—
data = data_train.loc[:,['PassengerId','Name']]

# æå–ç§°è°“
data['Title'] = data['Name'].map(lambda x: re.compile(", (.*?)\.").findall(x)[0])

# å®šä¹‰ä¸€ä¸ªç©ºå­—å…¸æ¥æ”¶é›†æ˜ å°„å…³ç³»
title_Dict = {}
title_Dict.update(dict.fromkeys(['Capt', 'Col', 'Major', 'Dr', 'Rev'], 'Officer'))
title_Dict.update(dict.fromkeys(['Don', 'Sir', 'the Countess', 'Dona', 'Lady'], 'Royalty'))
title_Dict.update(dict.fromkeys(['Mme', 'Ms', 'Mrs'], 'Mrs'))
title_Dict.update(dict.fromkeys(['Mlle', 'Miss'], 'Miss'))
title_Dict.update(dict.fromkeys(['Mr'], 'Mr'))
title_Dict.update(dict.fromkeys(['Master','Jonkheer'], 'Master'))
data['Title'] = data['Title'].map(title_Dict)
data.Title.value_counts()
```

![image-20200109203916978](./arrests/27.png)

é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å¯¹å­—æ®µTitleè¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Œè¿™é‡Œä½¿ç”¨get_dummiesï¼Œç”ŸæˆNä¸ª0-1æ–°å­—æ®µï¼š

```python
# æˆ‘ä»¬å¯¹å­—æ®µTitleè¿›è¡Œç‹¬çƒ­ç¼–ç ï¼Œè¿™é‡Œä½¿ç”¨get_dummiesï¼Œç”ŸæˆNä¸ª0-1æ–°å­—æ®µ
dummies_title = pd.get_dummies(data['Title'], prefix="Title")
data = pd.concat([data,dummies_title], axis=1)
data.head()
```

![image-20200109204023084](./arrests/28.png)

å¯¹äº†ï¼Œè¿™é‡Œæœ‰äº›åŒå­¦å¯èƒ½ä¼šé—®ï¼Œè¿˜æœ‰ä¸€ç§ç‹¬çƒ­ç¼–ç å‡ºæ¥çš„æ˜¯N-1ä¸ªå­—æ®µçš„åˆæ˜¯ä»€ä¹ˆï¼Ÿå¦å¤–è¿™ç§çš„è¯ï¼Œæˆ‘ä»¬æ˜¯ç§°ä¸º`dummy encoding`çš„ï¼Œä¹Ÿå°±æ˜¯å“‘å˜é‡ç¼–ç ï¼Œå®ƒæŠŠä»»æ„ä¸€ä¸ªçŠ¶æ€ä½å»é™¤ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä¸­æœ‰ä¸€ç±»å˜é‡å€¼çš„å“‘å˜é‡è¡¨ç¤ºä¸ºå…¨0ã€‚æ›´å¤šçš„å†…å®¹å»ºè®®å¯ä»¥ç™¾åº¦æ·±å…¥äº†è§£å“ˆã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip14ï¼šå¦‚ä½•æŠŠâ€œå¹´é¾„â€å­—æ®µæŒ‰ç…§æˆ‘ä»¬çš„é˜ˆå€¼åˆ†æ®µï¼Ÿ

æˆ‘ä»¬åœ¨è¿›è¡Œç‰¹å¾å¤„ç†çš„æ—¶å€™ï¼Œä¹Ÿæœ‰çš„æ—¶å€™ä¼šé‡åˆ°ä¸€äº›å˜é‡ï¼Œæ¯”å¦‚è¯´å¹´é¾„ï¼Œç„¶åæˆ‘ä»¬æƒ³è¦æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„é˜ˆå€¼è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚è¯´ä½äº18å²çš„ä½œä¸ºä¸€ç±»ï¼Œ18-30å²çš„ä½œä¸ºä¸€ç±»ï¼Œé‚£ä¹ˆæ€ä¹ˆç”¨Pythonå®ç°çš„å‘¢ï¼Ÿ

æ˜¯çš„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨åˆ°æˆ‘ä»¬çš„æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œå¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†æ“ä½œï¼Œè§ä¸‹ï¼š

```python
# å¯¼å…¥ç›¸å…³åº“
import pandas as pd 
import numpy as np 
from pandas import Series,DataFrame

# å¯¼å…¥æ³°å¦å°¼çš„æ•°æ®é›†
data_train = pd.read_csv("./data/titanic/Train.csv")
# ä¿®å¤éƒ¨åˆ†ageçš„å€¼
data_train.loc[(data_train.Age<=1),'Age'] = 1
# åªä¿ç•™éƒ¨åˆ†å€¼
data = data_train.loc[:,['PassengerId','Age']]
data.head()
```

![image-20200109204627086](./arrests/29.png)

ç„¶åï¼Œæˆ‘ä»¬ç¼–è¾‘ä»£ç ï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„é¢„æœŸè¿›è¡Œåˆ†ç»„:

```python
# ç¡®å®šé˜ˆå€¼ï¼Œå†™å…¥åˆ—è¡¨
bins = [0, 12, 18, 30, 50, 70, 100]
data['Age_group'] = pd.cut(data['Age'], bins)

dummies_Age = pd.get_dummies(data['Age_group'], prefix= 'Age')
data = pd.concat([data, dummies_Age], axis=1)

data.head()
```

![image-20200109204718102](./arrests/30.png)

è¿™æ ·å­å°±å¾ˆç¥å¥‡äº†å§ï¼ŒæŠŠå¹´é¾„æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚è¿›è¡Œåˆ†ç»„ï¼Œé¡ºä¾¿ä½¿ç”¨ç‹¬çƒ­ç¼–ç ç”Ÿæˆäº†æ–°çš„å­—æ®µã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip15ï¼šå¦‚ä½•ä½¿ç”¨sklearnçš„å¤šé¡¹å¼æ¥è¡ç”Ÿæ›´å¤šçš„å˜é‡ï¼Ÿ

å…³äºè¿™ç§è¡ç”Ÿå˜é‡çš„æ–¹å¼ï¼Œç†è®ºå…¶å®å¤§å®¶åº”è¯¥å¾ˆæ—©ä¹Ÿéƒ½å¬è¯´è¿‡äº†ï¼Œä½†æ˜¯å¦‚ä½•åœ¨Pythoné‡Œå®ç°ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©åœ¨è¿™é‡Œåˆ†äº«ç»™å¤§å®¶ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è°ƒç”¨`sklearn`çš„`PolynomialFeatures`æ–¹æ³•ï¼Œå…·ä½“å¤§å®¶å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„demoã€‚



è¿™é‡Œä½¿ç”¨ä¸€ä¸ªäººä½“åŠ é€Ÿåº¦æ•°æ®é›†ï¼Œä¹Ÿå°±æ˜¯è®°å½•ä¸€ä¸ªäººåœ¨åšä¸åŒåŠ¨ä½œæ—¶å€™ï¼Œåœ¨ä¸åŒæ–¹å‘ä¸Šçš„åŠ é€Ÿåº¦ï¼Œåˆ†åˆ«æœ‰3ä¸ªæ–¹å‘ï¼Œå‘½åä¸ºxã€yã€zã€‚

```python
# äººä½“èƒ¸éƒ¨åŠ é€Ÿåº¦æ•°æ®é›†,æ ‡ç­¾activityçš„æ•°å€¼ä¸º1-7
'''
1-åœ¨ç”µè„‘å‰å·¥ä½œ
2-ç«™ç«‹ã€èµ°è·¯å’Œä¸Šä¸‹æ¥¼æ¢¯
3-ç«™ç«‹
4-èµ°è·¯
5-ä¸Šä¸‹æ¥¼æ¢¯
6-ä¸äººè¾¹èµ°è¾¹èŠ
7-ç«™ç«‹ç€è¯´è¯

'''
import pandas as pd
df = pd.read_csv('./data/activity_recognizer/1.csv', header=None)
df.columns = ['index','x','y','z','activity']
df.head()

```

![image-20200111200231817](./arrests/31.png)

é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨åˆšåˆšè¯´çš„åŠæ³•ï¼Œç„¶åå¯¹äºæ•°å€¼å‹å˜é‡å¤šé¡¹å¼çš„å˜é‡æ‰©å±•ï¼Œä»£ç å¦‚ä¸‹:

```python
# æ‰©å±•æ•°å€¼ç‰¹å¾
from sklearn.preprocessing import PolynomialFeatures

x = df[['x','y','z']]
y = df['activity']

poly = PolynomialFeatures(degree=2, include_bias=False, interaction_only=False)

x_poly = poly.fit_transform(x)
pd.DataFrame(x_poly, columns=poly.get_feature_names()).head()
```

![image-20200111200347306](./arrests/32.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 


## Tip16ï¼šå¦‚ä½•æ ¹æ®å˜é‡ç›¸å…³æ€§ç”»å‡ºçƒ­åŠ›å›¾ï¼Ÿ

ä¸Šæ¬¡çš„é”¦å›Šæœ‰æåŠåˆ°å¦‚ä½•ä½¿ç”¨`sklearn`æ¥å®ç°å¤šé¡¹å¼çš„æ‰©å±•æ¥è¡ç”Ÿæ›´å¤šçš„å˜é‡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹ŸçŸ¥é“å…¶å®è¿™æ ·å­å‡ºæ¥çš„å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§æ˜¯å¾ˆå¼ºçš„ï¼Œæˆ‘ä»¬æ€ä¹ˆå¯ä»¥å¯è§†åŒ–ä¸€ä¸‹å‘¢ï¼Ÿè¿™é‡Œä»‹ç»ä¸€ä¸ªçƒ­åŠ›å›¾çš„æ–¹å¼ï¼Œè°ƒç”¨`corr`æ¥å®ç°å˜é‡ç›¸å…³æ€§çš„è®¡ç®—ï¼ŒåŒæ—¶çƒ­åŠ›å›¾ï¼Œé¢œè‰²è¶Šæ·±çš„è¯ï¼Œä»£è¡¨ç›¸å…³æ€§è¶Šå¼ºï¼

```python
# äººä½“èƒ¸éƒ¨åŠ é€Ÿåº¦æ•°æ®é›†,æ ‡ç­¾activityçš„æ•°å€¼ä¸º1-7
'''
1-åœ¨ç”µè„‘å‰å·¥ä½œ
2-ç«™ç«‹ã€èµ°è·¯å’Œä¸Šä¸‹æ¥¼æ¢¯
3-ç«™ç«‹
4-èµ°è·¯
5-ä¸Šä¸‹æ¥¼æ¢¯
6-ä¸äººè¾¹èµ°è¾¹èŠ
7-ç«™ç«‹ç€è¯´è¯

'''
import pandas as pd
from sklearn.preprocessing import PolynomialFeatures

df = pd.read_csv('./data/activity_recognizer/1.csv', header=None)
df.columns = ['index','x','y','z','activity']

x = df[['x','y','z']]
y = df['activity']

# å¤šé¡¹å¼æ‰©å……æ•°å€¼å˜é‡
poly = PolynomialFeatures(degree=2, include_bias=False, interaction_only=False)

x_poly = poly.fit_transform(x)
pd.DataFrame(x_poly, columns=poly.get_feature_names()).head()

# æŸ¥çœ‹çƒ­åŠ›å›¾(é¢œè‰²è¶Šæ·±ä»£è¡¨ç›¸å…³æ€§è¶Šå¼º)
%matplotlib inline
import seaborn as sns

sns.heatmap(pd.DataFrame(x_poly, columns=poly.get_feature_names()).corr())
```

![image-20200111201003846](./arrests/33.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip17ï¼šå¦‚ä½•æŠŠåˆ†å¸ƒä¿®æ­£ä¸ºç±»æ­£æ€åˆ†å¸ƒï¼Ÿ

ä»Šå¤©æˆ‘ä»¬ç”¨çš„æ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œä¹Ÿæ˜¯åœ¨kaggleä¸Šçš„ä¸€ä¸ªæ¯”èµ›ï¼Œå¤§å®¶å¯ä»¥å…ˆå»ä¸‹è½½ä¸€ä¸‹ï¼š

![image-20200113205105743](./arrests/34.png)

ä¸‹è½½åœ°å€ï¼šhttps://www.kaggle.com/c/house-prices-advanced-regression-techniques/data

```python
import pandas as pd
import numpy as np
# Plots
import seaborn as sns
import matplotlib.pyplot as plt

from scipy.stats import norm

# è¯»å–æ•°æ®é›†
train = pd.read_csv('./data/house-prices-advanced-regression-techniques/train.csv')
train.head()

```

![image-20200113210816071](./arrests/35.png)

é¦–å…ˆè¿™ä¸ªæ˜¯ä¸€ä¸ªä»·æ ¼é¢„æµ‹çš„é¢˜ç›®ï¼Œåœ¨å¼€å§‹å‰æˆ‘ä»¬éœ€è¦çœ‹çœ‹åˆ†å¸ƒæƒ…å†µï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹çš„æ–¹æ³•æ¥è¿›è¡Œç»˜åˆ¶ï¼š

```python
sns.set_style("white")
sns.set_color_codes(palette='deep')
f, ax = plt.subplots(figsize=(8, 7))
#Check the new distribution 
sns.distplot(train['SalePrice'], color="b");
ax.xaxis.grid(False)
ax.set(ylabel="Frequency")
ax.set(xlabel="SalePrice")
ax.set(title="SalePrice distribution")
sns.despine(trim=True, left=True)
plt.show()

```

![image-20200113210907623](./arrests/36.png)


æˆ‘ä»¬ä»ç»“æœå¯ä»¥çœ‹å‡ºï¼Œé”€å”®ä»·æ ¼æ˜¯å³åï¼Œè€Œå¤§å¤šæ•°æœºå™¨å­¦ä¹ æ¨¡å‹éƒ½ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†éæ­£æ€åˆ†å¸ƒæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åº”ç”¨log(1+x)è½¬æ¢æ¥è¿›è¡Œä¿®æ­£ã€‚é‚£ä¹ˆå…·ä½“æˆ‘ä»¬å¯ä»¥æ€ä¹ˆç”¨Pythonä»£ç å®ç°å‘¢ï¼Ÿ

```python
# log(1+x) è½¬æ¢
train["SalePrice_log"] = np.log1p(train["SalePrice"])

sns.set_style("white")
sns.set_color_codes(palette='deep')
f, ax = plt.subplots(figsize=(8, 7))

sns.distplot(train['SalePrice_log'] , fit=norm, color="b");

# å¾—åˆ°æ­£æ€åˆ†å¸ƒçš„å‚æ•°
(mu, sigma) = norm.fit(train['SalePrice_log'])

plt.legend(['Normal dist. ($\mu=$ {:.2f} and $\sigma=$ {:.2f} )'.format(mu, sigma)],
            loc='best')
ax.xaxis.grid(False)
ax.set(ylabel="Frequency")
ax.set(xlabel="SalePrice")
ax.set(title="SalePrice distribution")
sns.despine(trim=True, left=True)

plt.show()
```

![image-20200113211509700](./arrests/37.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip18ï¼šæ€ä¹ˆæ‰¾å‡ºæ•°æ®é›†ä¸­æœ‰æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼Ÿ

ä»Šå¤©æˆ‘ä»¬ç”¨çš„æ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®é›†ï¼Œä¹Ÿæ˜¯åœ¨kaggleä¸Šçš„ä¸€ä¸ªæ¯”èµ›ï¼Œå¤§å®¶å¯ä»¥å…ˆå»ä¸‹è½½ä¸€ä¸‹ï¼š

![image-20200113205105743](./arrests/34.png)

ä¸‹è½½åœ°å€ï¼šhttps://www.kaggle.com/c/house-prices-advanced-regression-techniques/data

```python
import pandas as pd
import numpy as np
# Plots
import seaborn as sns
import matplotlib.pyplot as plt

# è¯»å–æ•°æ®é›†
train = pd.read_csv('./data/house-prices-advanced-regression-techniques/train.csv')
train.head()
```

![image-20200113210816071](./arrests/35.png)

æˆ‘ä»¬å¯¹æ•°æ®é›†è¿›è¡Œåˆ†æï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹ç‰¹å¾çš„åˆ†å¸ƒæƒ…å†µï¼Œçœ‹ä¸‹å“ªäº›ç‰¹å¾æ˜æ˜¾å°±æ˜¯æœ‰æ•°æ®å€¾æ–œçš„ï¼Œç„¶åå¯ä»¥æ‰¾åŠæ³•è§£å†³ï¼Œå› æ­¤ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯è¦æœ‰åŠæ³•æ‰¾åˆ°è¿™äº›ç‰¹å¾ã€‚

é¦–å…ˆå¯ä»¥é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼ï¼Œç”»ç®±ä½“å›¾ï¼Œç„¶åè§‚å¯Ÿç®±ä½“æƒ…å†µï¼Œç†è®ºçŸ¥è¯†æ˜¯ï¼š

> åœ¨ç®±çº¿å›¾ä¸­ï¼Œç®±å­çš„ä¸­é—´æœ‰ä¸€æ¡çº¿ï¼Œä»£è¡¨äº†æ•°æ®çš„ä¸­ä½æ•°ã€‚ç®±å­çš„ä¸Šä¸‹åº•ï¼Œåˆ†åˆ«æ˜¯æ•°æ®çš„ä¸Šå››åˆ†ä½æ•°ï¼ˆQ3ï¼‰å’Œä¸‹å››åˆ†ä½æ•°ï¼ˆQ1ï¼‰ï¼Œè¿™æ„å‘³ç€ç®±ä½“åŒ…å«äº†50%çš„æ•°æ®ã€‚å› æ­¤ï¼Œ**ç®±å­çš„é«˜åº¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šåæ˜ äº†æ•°æ®çš„æ³¢åŠ¨ç¨‹åº¦**ã€‚ä¸Šä¸‹è¾¹ç¼˜åˆ™ä»£è¡¨äº†è¯¥ç»„æ•°æ®çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚æœ‰æ—¶å€™ç®±å­å¤–éƒ¨ä¼šæœ‰ä¸€äº›ç‚¹ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®ä¸­çš„â€œ**å¼‚å¸¸å€¼**â€ã€‚è€Œå¯¹äºæ•°æ®å€¾æ–œçš„ï¼Œæˆ‘ä»¬å«åšâ€œåæ€â€ï¼Œä¸æ­£æ€åˆ†å¸ƒç›¸å¯¹ï¼ŒæŒ‡çš„æ˜¯éå¯¹ç§°åˆ†å¸ƒçš„åæ–œçŠ¶æ€ã€‚åœ¨ç»Ÿè®¡å­¦ä¸Šï¼Œä¼—æ•°å’Œå¹³å‡æ•°ä¹‹å·®å¯ä½œä¸ºåˆ†é…åæ€çš„æŒ‡æ ‡ä¹‹ä¸€ï¼šå¦‚å¹³å‡æ•°å¤§äºä¼—æ•°ï¼Œç§°ä¸ºæ­£åæ€ï¼ˆæˆ–å³åæ€ï¼‰ï¼›ç›¸åï¼Œåˆ™ç§°ä¸ºè´Ÿåæ€ï¼ˆæˆ–å·¦åæ€ï¼‰ã€‚



```python
# ä¸¢å¼ƒyå€¼
all_features = train.drop(['SalePrice'], axis=1)

# æ‰¾å‡ºæ‰€æœ‰çš„æ•°å€¼å‹å˜é‡
numeric_dtypes = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']
numeric = []
for i in all_features.columns:
    if all_features[i].dtype in numeric_dtypes:
        numeric.append(i)
        
# å¯¹æ‰€æœ‰çš„æ•°å€¼å‹å˜é‡ç»˜åˆ¶ç®±ä½“å›¾
sns.set_style("white")
f, ax = plt.subplots(figsize=(8, 7))
ax.set_xscale("log")
ax = sns.boxplot(data=all_features[numeric] , orient="h", palette="Set1")
ax.xaxis.grid(False)
ax.set(ylabel="Feature names")
ax.set(xlabel="Numeric values")
ax.set(title="Numeric Distribution of Features")
sns.despine(trim=True, left=True)
```

![image-20200114215939603](./arrests/38.png)

å¯ä»¥çœ‹å‡ºæœ‰ä¸€äº›ç‰¹å¾ï¼Œæœ‰ä¸€äº›æ•°æ®ä¼šåç¦»ç®±ä½“å¤–ï¼Œå› æ­¤å±äºæ•°æ®å€¾æ–œã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä»ä¸Šé¢çš„å¯è§†åŒ–ä¸­è™½ç„¶çœ‹å‡ºæ¥äº†ï¼Œä½†æ˜¯æƒ³è¦é€‰å‡ºæ¥è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥è¿™é‡Œå¼•å…¥ä¸€ä¸ªåæ€çš„æ¦‚å¿µï¼Œç›¸å¯¹åº”çš„æœ‰ä¸€ä¸ªæŒ‡æ ‡`skew`ï¼Œè¿™ä¸ªå°±æ˜¯ä»£è¡¨åæ€çš„ç³»æ•°ã€‚

> Skewnessï¼šæè¿°æ•°æ®åˆ†å¸ƒå½¢æ€çš„ç»Ÿè®¡é‡ï¼Œå…¶æè¿°çš„æ˜¯æŸæ€»ä½“å–å€¼åˆ†å¸ƒçš„**å¯¹ç§°æ€§**ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ•°æ®çš„ä¸å¯¹ç§°ç¨‹åº¦ã€‚
>
> ååº¦æ˜¯ä¸‰é˜¶ä¸­å¿ƒè·è®¡ç®—å‡ºæ¥çš„ã€‚
>
> ï¼ˆ1ï¼‰Skewness = 0 ï¼Œåˆ†å¸ƒå½¢æ€ä¸æ­£æ€åˆ†å¸ƒååº¦ç›¸åŒã€‚
>
> ï¼ˆ2ï¼‰Skewness > 0 ï¼Œæ­£åå·®æ•°å€¼è¾ƒå¤§ï¼Œä¸ºæ­£åæˆ–å³åã€‚é•¿å°¾å·´æ‹–åœ¨å³è¾¹ï¼Œæ•°æ®å³ç«¯æœ‰è¾ƒå¤šçš„æç«¯å€¼ã€‚
>
> ï¼ˆ3ï¼‰Skewness < 0 ï¼Œè´Ÿåå·®æ•°å€¼è¾ƒå¤§ï¼Œä¸ºè´Ÿåæˆ–å·¦åã€‚é•¿å°¾å·´æ‹–åœ¨å·¦è¾¹ï¼Œæ•°æ®å·¦ç«¯æœ‰è¾ƒå¤šçš„æç«¯å€¼ã€‚
>
> ï¼ˆ4ï¼‰æ•°å€¼çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œè¡¨æ˜æ•°æ®åˆ†å¸ƒè¶Šä¸å¯¹ç§°ï¼Œåæ–œç¨‹åº¦å¤§ã€‚

é‚£ä¹ˆåœ¨Pythoné‡Œå¯ä»¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ

```python
# æ‰¾å‡ºæ˜æ˜¾åæ€çš„æ•°å€¼å‹å˜é‡
skew_features = all_features[numeric].apply(lambda x: skew(x)).sort_values(ascending=False)

high_skew = skew_features[skew_features > 0.5]
skew_index = high_skew.index

print("æœ¬æ•°æ®é›†ä¸­æœ‰ {} ä¸ªæ•°å€¼å‹å˜é‡çš„ Skew > 0.5 :".format(high_skew.shape[0]))
skewness = pd.DataFrame({'Skew' :high_skew})
skew_features.head(10)
```

![image-20200114220316028](./arrests/39.png)


<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 

## Tip19ï¼šæ€ä¹ˆå°½å¯èƒ½åœ°ä¿®æ­£æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼Ÿ

ä¸Šä¸€ä¸ªé”¦å›Šï¼Œåˆ†äº«äº†ç»™å¤§å®¶é€šè¿‡`skew`çš„æ–¹æ³•æ¥æ‰¾åˆ°æ•°æ®é›†ä¸­æœ‰æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼ˆç‰¹å¾é”¦å›Šï¼šæ€ä¹ˆæ‰¾å‡ºæ•°æ®é›†ä¸­æœ‰æ•°æ®å€¾æ–œçš„ç‰¹å¾ï¼Ÿï¼‰ï¼Œé‚£ä¹ˆæ€ä¹ˆå»ä¿®æ­£å®ƒå‘¢ï¼Ÿæ­£æ˜¯ä»Šå¤©è¦åˆ†äº«ç»™å¤§å®¶çš„é”¦å›Šï¼

è¿˜æ˜¯ç”¨åˆ°æˆ¿ä»·é¢„æµ‹çš„æ•°æ®é›†ï¼š

![image-20200113205105743](./arrests/34.png)

ä¸‹è½½åœ°å€ï¼šhttps://www.kaggle.com/c/house-prices-advanced-regression-techniques/data

```python
import pandas as pd
import numpy as np
# Plots
import seaborn as sns
import matplotlib.pyplot as plt

# è¯»å–æ•°æ®é›†
train = pd.read_csv('./data/house-prices-advanced-regression-techniques/train.csv')
train.head()
```

![image-20200113210816071](./arrests/35.png)

æˆ‘ä»¬é€šè¿‡ä¸Šæ¬¡çš„çŸ¥è¯†ï¼ŒçŸ¥é“äº†å¯ä»¥é€šè¿‡`skewness`æ¥è¿›è¡Œå€¾æ–œç‰¹å¾çš„è¾¨åˆ«ï¼Œé‚£ä¹ˆå¯¹äºä¿®æ­£å®ƒçš„åŠæ³•ï¼Œè¿™é‡Œä¹Ÿå…ˆåˆ†äº«ä¸€ä¸ªç†è®ºçŸ¥è¯† â€”â€” **box-coxè½¬æ¢**ã€‚

> çº¿æ€§å›å½’æ¨¡å‹æ»¡è¶³çº¿æ€§æ€§ã€ç‹¬ç«‹æ€§ã€æ–¹å·®é½æ€§ä»¥åŠæ­£æ€æ€§çš„åŒæ—¶ï¼Œåˆä¸ä¸¢å¤±ä¿¡æ¯ï¼Œæ­¤ç§å˜æ¢ç§°ä¹‹ä¸ºBoxâ€”Coxå˜æ¢ã€‚
>
> Box-Coxå˜æ¢æ˜¯Boxå’ŒCoxåœ¨1964å¹´æå‡ºçš„ä¸€ç§å¹¿ä¹‰å¹‚å˜æ¢æ–¹æ³•ï¼Œæ˜¯ç»Ÿè®¡å»ºæ¨¡ä¸­å¸¸ç”¨çš„ä¸€ç§[æ•°æ®](https://baike.baidu.com/item/æ•°æ®/33305)å˜æ¢ï¼Œç”¨äºè¿ç»­çš„å“åº”å˜é‡ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒçš„æƒ…å†µã€‚Box-Coxå˜æ¢ä¹‹åï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°ä¸å¯è§‚æµ‹çš„è¯¯å·®å’Œé¢„æµ‹å˜é‡çš„ç›¸å…³æ€§ã€‚Box-Coxå˜æ¢çš„ä¸»è¦ç‰¹ç‚¹æ˜¯å¼•å…¥ä¸€ä¸ªå‚æ•°ï¼Œé€šè¿‡æ•°æ®æœ¬èº«ä¼°è®¡è¯¥å‚æ•°è¿›è€Œç¡®å®šåº”é‡‡å–çš„æ•°æ®å˜æ¢å½¢å¼ï¼ŒBox-Coxå˜æ¢å¯ä»¥æ˜æ˜¾åœ°æ”¹å–„æ•°æ®çš„æ­£æ€æ€§ã€å¯¹ç§°æ€§å’Œæ–¹å·®ç›¸ç­‰æ€§ï¼Œå¯¹è®¸å¤šå®é™…æ•°æ®éƒ½æ˜¯è¡Œä¹‹æœ‰æ•ˆçš„ã€‚â€”â€” ç™¾åº¦ç™¾ç§‘

åœ¨ä½¿ç”¨å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹åŸå…ˆå€¾æ–œçš„ç‰¹å¾æœ‰å¤šå°‘ä¸ªã€‚

```python
# ä¸¢å¼ƒyå€¼
all_features = train.drop(['SalePrice'], axis=1)

# æ‰¾å‡ºæ‰€æœ‰çš„æ•°å€¼å‹å˜é‡
numeric_dtypes = ['int16', 'int32', 'int64', 'float16', 'float32', 'float64']
numeric = []
for i in all_features.columns:
    if all_features[i].dtype in numeric_dtypes:
        numeric.append(i)
        
# æ‰¾å‡ºæ˜æ˜¾åæ€çš„æ•°å€¼å‹å˜é‡
skew_features = all_features[numeric].apply(lambda x: skew(x)).sort_values(ascending=False)

high_skew = skew_features[skew_features > 0.5]
skew_index = high_skew.index

print("æœ¬æ•°æ®é›†ä¸­æœ‰ {} ä¸ªæ•°å€¼å‹å˜é‡çš„ Skew > 0.5 :".format(high_skew.shape[0]))
skewness = pd.DataFrame({'Skew' :high_skew})
skew_features
```

> æœ¬æ•°æ®é›†ä¸­æœ‰ 24 ä¸ªæ•°å€¼å‹å˜é‡çš„ Skew > 0.5 :

åœ¨Pythonä¸­æ€ä¹ˆä½¿ç”¨Box-Cox è½¬æ¢å‘¢ï¼Ÿå¾ˆç®€å•ã€‚

```python
# é€šè¿‡ Box-Cox è½¬æ¢ï¼Œä»è€ŒæŠŠå€¾æ–œçš„æ•°æ®è¿›è¡Œä¿®æ­£
for i in skew_index:
    all_features[i] = boxcox1p(all_features[i], boxcox_normmax(all_features[i] + 1))
```

ç„¶åæˆ‘ä»¬å†çœ‹çœ‹è¿˜æœ‰å¤šå°‘ä¸ªæ•°æ®å€¾æ–œçš„ç‰¹å¾å§ï¼

```python
# æ‰¾å‡ºæ˜æ˜¾åæ€çš„æ•°å€¼å‹å˜é‡
skew_features = all_features[numeric].apply(lambda x: skew(x)).sort_values(ascending=False)

high_skew = skew_features[skew_features > 0.5]
skew_index = high_skew.index
print("æœ¬æ•°æ®é›†ä¸­æœ‰ {} ä¸ªæ•°å€¼å‹å˜é‡çš„ Skew > 0.5 :".format(high_skew.shape[0]))
skewness = pd.DataFrame({'Skew' :high_skew})
```

> æœ¬æ•°æ®é›†ä¸­æœ‰ 15 ä¸ªæ•°å€¼å‹å˜é‡çš„ Skew > 0.5 :

å˜å°‘äº†å¾ˆå¤šï¼Œè€Œä¸”å¦‚æœçœ‹ä»–ä»¬çš„skewå€¼ï¼Œä¹Ÿä¼šå‘ç°å˜å°äº†å¾ˆå¤šã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹çœ‹è½¬æ¢åçš„ç®±ä½“å›¾æƒ…å†µã€‚

```python
# Let's make sure we handled all the skewed values
sns.set_style("white")
f, ax = plt.subplots(figsize=(8, 7))
ax.set_xscale("log")
ax = sns.boxplot(data=all_features[skew_index] , orient="h", palette="Set1")
ax.xaxis.grid(False)
ax.set(ylabel="Feature names")
ax.set(xlabel="Numeric values")
ax.set(title="Numeric Distribution of Features")
sns.despine(trim=True, left=True)
```

![image-20200117212535708](./arrests/40.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
 
## Tip20ï¼šæ€ä¹ˆç®€å•ä½¿ç”¨PCAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢ï¼Ÿ

PCAç®—æ³•åœ¨æ•°æ®æŒ–æ˜ä¸­æ˜¯å¾ˆåŸºç¡€çš„é™ç»´ç®—æ³•ï¼Œç®€å•å›é¡¾ä¸€ä¸‹å®šä¹‰ï¼š

> PCAï¼Œå…¨ç§°ä¸ºPrincipal Component Analysisï¼Œä¹Ÿå°±æ˜¯ä¸»æˆåˆ†åˆ†ææ–¹æ³•ï¼Œæ˜¯ä¸€ç§é™ç»´ç®—æ³•ï¼Œå…¶åŠŸèƒ½å°±æ˜¯æŠŠNç»´çš„ç‰¹å¾ï¼Œé€šè¿‡è½¬æ¢æ˜ å°„åˆ°Kç»´ä¸Šï¼ˆK<Nï¼‰ï¼Œè¿™äº›ç”±åŸå…ˆNç»´çš„æŠ•å°„åçš„Kä¸ªæ­£äº¤ç‰¹å¾ï¼Œå°±è¢«ç§°ä¸ºä¸»æˆåˆ†ã€‚

åœ¨è¿™é‡Œä½¿ç”¨çš„æ•°æ®é›†irisï¼Œæ¥å¼„ä¸€ä¸ªdemoï¼š

```python
# å¯¼å…¥ç›¸å…³åº“
from sklearn.datasets import load_iris
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA
%matplotlib inline

#è§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼ŒMac
%matplotlib inline
from matplotlib.font_manager import FontProperties
# è®¾ç½®æ˜¾ç¤ºçš„å°ºå¯¸
plt.rcParams['font.family'] = ['Arial Unicode MS'] #æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡

# å¯¼å…¥æ•°æ®é›†
iris = load_iris()
iris_x, iris_y = iris.data, iris.target

# å®ä¾‹åŒ–
pca = PCA(n_components=2)

# è®­ç»ƒæ•°æ®
pca.fit(iris_x)
pca.transform(iris_x)[:5,]

# è‡ªå®šä¹‰ä¸€ä¸ªå¯è§†åŒ–çš„æ–¹æ³•
label_dict = {i:k for i,k in enumerate(iris.target_names)}
def plot(x,y,title,x_label,y_label):
    ax = plt.subplot(111)
    for label,marker,color in zip(
    range(3),('^','s','o'),('blue','red','green')):
        plt.scatter(x=x[:,0].real[y == label],
                   y = x[:,1].real[y == label],
                   color = color,
                   alpha = 0.5,
                   label = label_dict[label]
                   )
        
    plt.xlabel(x_label)
    plt.ylabel(y_label)
    
    leg = plt.legend(loc='upper right', fancybox=True)
    leg.get_frame().set_alpha(0.5)
    plt.title(title)

# å¯è§†åŒ–
plot(iris_x, iris_y,"åŸå§‹çš„irisæ•°æ®é›†","sepal length(cm)","sepal width(cm)")
plt.show()

plot(pca.transform(iris_x), iris_y,"PCAè½¬æ¢åçš„å¤´ä¸¤ä¸ªæ­£äº¤ç‰¹å¾","PCA1","PCA2")
```

![image-20200129161705398](./arrests/41.png)

æˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰çš„ç»˜å›¾å‡½æ•°`plot`ï¼ŒæŠŠä¸åŒç±»åˆ«çš„yå€¼è¿›è¡Œä¸åŒé¢œè‰²çš„æ˜¾ç¤ºï¼Œä»è€Œçœ‹å‡ºåœ¨å€¼åŸŸä¸Šåˆ†å¸ƒçš„å·®å¼‚ã€‚ä»åŸå§‹çš„ç‰¹å¾æ¥çœ‹ï¼Œä¸åŒç±»åˆ«ä¹‹é—´å…¶å®ç•Œé™å¹¶ä¸æ˜¯ååˆ†æ˜æ˜¾ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚è€Œè¿›è¡ŒPCAè½¬æ¢åï¼Œå¯ä»¥çœ‹å‡ºä¸åŒç±»åˆ«ä¹‹é—´çš„ç•Œé™æœ‰äº†æ¯”è¾ƒæ˜æ˜¾çš„å·®å¼‚ã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>


## Tip21ï¼šæ€ä¹ˆç®€å•ä½¿ç”¨LDAæ¥åˆ’åˆ†æ•°æ®ä¸”å¯è§†åŒ–å‘¢ï¼Ÿ

LDAç®—æ³•åœ¨æ•°æ®æŒ–æ˜ä¸­æ˜¯å¾ˆåŸºç¡€çš„ç®—æ³•ï¼Œç®€å•å›é¡¾ä¸€ä¸‹å®šä¹‰ï¼š

> LDAçš„å…¨ç§°ä¸ºLinear Discriminant Analysis, ä¸­æ–‡ä¸ºçº¿æ€§åˆ¤åˆ«åˆ†æï¼ŒLDAæ˜¯ä¸€ç§æœ‰ç›‘ç£å­¦ä¹ çš„ç®—æ³•ï¼Œå’ŒPCAä¸åŒã€‚PCAæ˜¯æ— ç›‘ç£ç®—æ³•ï¼Œã€‚LDAæ˜¯â€œæŠ•å½±åç±»å†…æ–¹å·®æœ€å°ï¼Œç±»é—´æ–¹å·®æœ€å¤§â€ï¼Œä¹Ÿå°±æ˜¯å°†æ•°æ®æŠ•å½±åˆ°ä½ç»´åº¦ä¸Šï¼ŒæŠ•å½±åå¸Œæœ›æ¯ä¸€ç§ç±»åˆ«æ•°æ®çš„æŠ•å½±ç‚¹å°½å¯èƒ½çš„æ¥è¿‘ï¼Œè€Œä¸åŒç±»åˆ«çš„æ•°æ®çš„ç±»åˆ«ä¸­å¿ƒä¹‹é—´çš„è·ç¦»å°½å¯èƒ½çš„å¤§ã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æ•°æ®é›†irisï¼Œæ¥å¼„ä¸€ä¸ªdemoï¼š

```python
# å¯¼å…¥ç›¸å…³åº“
from sklearn.datasets import load_iris
import matplotlib.pyplot as plt
from sklearn.discriminant_analysis import LinearDiscriminantAnalysis
%matplotlib inline

#è§£å†³ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ï¼ŒMac
%matplotlib inline
from matplotlib.font_manager import FontProperties
# è®¾ç½®æ˜¾ç¤ºçš„å°ºå¯¸
plt.rcParams['font.family'] = ['Arial Unicode MS'] #æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡

# å¯¼å…¥æ•°æ®é›†
iris = load_iris()
iris_x, iris_y = iris.data, iris.target

# å®ä¾‹åŒ–
lda = LinearDiscriminantAnalysis(n_components=2)

# è®­ç»ƒæ•°æ®
x_lda_iris = lda.fit_transform(iris_x, iris_y)


# è‡ªå®šä¹‰ä¸€ä¸ªå¯è§†åŒ–çš„æ–¹æ³•
label_dict = {i:k for i,k in enumerate(iris.target_names)}
def plot(x,y,title,x_label,y_label):
    ax = plt.subplot(111)
    for label,marker,color in zip(
    range(3),('^','s','o'),('blue','red','green')):
        plt.scatter(x=x[:,0].real[y == label],
                   y = x[:,1].real[y == label],
                   color = color,
                   alpha = 0.5,
                   label = label_dict[label]
                   )
        
    plt.xlabel(x_label)
    plt.ylabel(y_label)
    
    leg = plt.legend(loc='upper right', fancybox=True)
    leg.get_frame().set_alpha(0.5)
    plt.title(title)

# å¯è§†åŒ–
plot(iris_x, iris_y,"åŸå§‹çš„irisæ•°æ®é›†","sepal length(cm)","sepal width(cm)")
plt.show()

plot(x_lda_iris, iris_y, "LDA Projection", "LDA1", "LDA2")
```

![image-20200129174752001](./arrests/42.png)

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip22ï¼šæ€ä¹ˆæ¥ç®¡ç†æˆ‘ä»¬çš„å»ºæ¨¡é¡¹ç›®æ–‡ä»¶ï¼Ÿ

è¿™ä¸ªä¸“é¢˜å…¶å®å¾ˆä¹…ä¹‹å‰åœ¨æˆ‘çš„ä¸€ç¯‡æ–‡ç« é‡Œæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç»ï¼Œå¯ä»¥æˆ³[ã€Šåˆ†äº«8ç‚¹è¶…çº§æœ‰ç”¨çš„Pythonç¼–ç¨‹å»ºè®®ã€‹](https://mp.weixin.qq.com/s/eOeXA0ctErvd2mmEexZcBA)ï¼Œä½†æ˜¯ä»Šå¤©æˆ‘è¿˜æ˜¯æƒ³æŠŠå…¶ä¸­çš„ä¸€ä¸ªå†…å®¹é‡ç‚¹æ¥è¯´ä¸€ä¸‹ï¼Œå¤§å®¶å¯ä»¥å…ˆçœ‹çœ‹è¿™å¼ å›¾ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨åšå»ºæ¨¡é¡¹ç›®æ—¶ï¼Œä¸ªäººæ¯”è¾ƒæ¨èçš„ä¸€ä¸ªå»ºé¡¹ç›®æ–‡ä»¶çš„demoã€‚

![image-20200129174752001](./arrests/43.png)

è¿™ä¸ªé¡¹ç›®æ–‡ä»¶ç»“æ„æ˜¯æˆ‘å¹³æ—¶ç»å¸¸ç”¨çš„ï¼Œä¼šæ ¹æ®é¡¹ç›®å¤æ‚åº¦è‡ªè¡Œåˆ å‡ä¸€äº›å†…å®¹ï¼Œä¸è¿‡æ€»ä½“çš„æ¡†æ¶è¿˜æ˜¯å·®ä¸å¤šçš„ï¼Œæ‰€ä»¥åˆ†äº«ç»™å¤§å®¶å‚è€ƒä¸‹å‘—ï¼Œå› ä¸ºä¸ªäººç”¨èµ·æ¥è¿˜æ˜¯è›®ä¸é”™çš„ï¼Œå›¾ç‰‡é‡Œè®²äº†è¿˜æ˜¯æ¯”è¾ƒè¯¦ç»†çš„äº†ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯æŒ‘ä¸€äº›é‡ç‚¹æ¥ç®€å•è§£é‡Šä¸€ä¸‹ï¼š

* experimentï¼šä¸“é—¨ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„å®éªŒæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯é‚£äº›ä¸æ–­åœ°æµ‹è¯•ç®—æ³•çš„ä¸­é—´æ–‡ä»¶ã€‚
* modelï¼šå­˜æ”¾ä¸åŒç®—æ³•çš„æœ€ç»ˆç‰ˆæœ¬ä»£ç çš„æ–‡ä»¶å¤¹
* dataï¼šå­˜æ”¾æ•°æ®çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢è¿˜ä¼šåˆ†ä¸åŒç±»åˆ«å»å­˜æ”¾æ•°æ®ï¼Œæ¯”å¦‚externalï¼ˆæ¥è‡ªç¬¬ä¸‰æ–¹çš„æ•°æ®ï¼‰ã€interimï¼ˆç»è¿‡éƒ¨åˆ†æ¸…æ´—è½¬æ¢çš„æ•°æ®æºï¼Œå¦‚SQLã€SASï¼‰ã€rawï¼ˆåŸå§‹æ•°æ®é›†ï¼Œä¸æ·»åŠ ä»»ä½•åŠ å·¥ï¼‰ã€processedï¼ˆæœ€ç»ˆç”¨äºå»ºæ¨¡çš„æ•°æ®é›†ï¼‰ã€codeï¼ˆç”¨äºå‚¨å­˜æ•°æ®æ¸…æ´—çš„ä»£ç ï¼‰

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>
 
## Tip23ï¼šæ€ä¹ˆæ‰¹é‡æŠŠç‰¹å¾ä¸­çš„ç¦»ç¾¤ç‚¹ç»™å®‰æ’ä¸€ä¸‹ï¼Ÿ

è¿™ä¸ªä¸“æ åœäº†ä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œè‡ªä»ä¸Šæ¬¡å¯¹ä¹‹å‰çš„å†…å®¹è¿›è¡Œäº†ä¸€æ¬¡æ¢³ç†ä¹‹åï¼Œä¼¼ä¹æ˜¯ç»™è‡ªå·±ä¸€ä¸ªâ€œå€Ÿå£â€ä¼‘æ¯äº†ä¸€é˜µå­ï¼Œç°åœ¨æ„Ÿè§‰è¿˜æ˜¯å¾—é‡æ–°æ‹¿å‡ºæ¥ç»§ç»­æ›´æ–°äº†ã€‚

```python
# å¯¼å…¥æ•°æ®é›†
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

train = pd.read_csv('./data/Group-Image-of-Consumers/train_dataset.csv')
test = pd.read_csv('./data/Group-Image-of-Consumers/test_dataset.csv')
data = pd.concat([train, test], ignore_index=True)
data.head()
```

![image-20200403211901868](./arrests/44.png)

æˆ‘ä»¬ç®€å•ä»é‡Œé¢æŒ‘é€‰å‡ ä¸ªæ•°å€¼å‹å˜é‡æ¥çœ‹çœ‹åˆ†å¸ƒæƒ…å†µå§ï¼Œç”»å›¾çš„æŠ€å·§è¿™é‡Œå°±ä¸è¯´äº†ï¼Œå¯ä»¥å‚è€ƒä¹‹å‰ç”»ç®±ä½“å›¾çš„é‚£ç¯‡é•œå›Šæ–‡ç« ã€‚

```python
# æŒ‘é€‰å…¶ä¸­å‡ ä¸ªå˜é‡
feature_list=['å½“æœˆç½‘è´­ç±»åº”ç”¨ä½¿ç”¨æ¬¡æ•°','å½“æœˆé‡‘èç†è´¢ç±»åº”ç”¨ä½¿ç”¨æ€»æ¬¡æ•°','å½“æœˆè§†é¢‘æ’­æ”¾ç±»åº”ç”¨ä½¿ç”¨æ¬¡æ•°']

# ç»˜åˆ¶ç®±ä½“å›¾
sns.set_style("white")
f, ax = plt.subplots(figsize=(8, 7))
ax.set_xscale("log")
ax = sns.boxplot(data=data[feature_list] , orient="h", palette="Set1")
ax.xaxis.grid(False)
ax.set(ylabel="Feature names")
ax.set(xlabel="Numeric values")
ax.set(title="Numeric Distribution of Features")
sns.despine(trim=True, left=True)
```

![image-20200403212339978](./arrests/45.png)

å¯ä»¥çœ‹åˆ°çº¢è‰²æ¡†æ¡†åœˆèµ·æ¥çš„å°±æ˜¯æˆ‘ä»¬çš„ç¦»ç¾¤ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€ä¹ˆå¤„ç†ä¸€ä¸‹å‘¢ï¼Ÿè¿™é‡Œç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªæ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š

```python
def process(all_data,feature_list):
    #å¤„ç†ç¦»ç¾¤ç‚¹
    for col in feature_list:
        ulimit=np.percentile(all_data[col].values, 99.9) #è®¡ç®—ä¸€ä¸ªå¤šç»´æ•°ç»„çš„ä»»æ„ç™¾åˆ†æ¯”åˆ†ä½æ•°
        llimit=np.percentile(all_data[col].values, 0.1)
        all_data.loc[all_data[col]>ulimit,col]=ulimit  # å¤§äº99.9%çš„ç›´æ¥èµ‹å€¼
        all_data.loc[all_data[col]<llimit,col]=llimit
    return all_data
```

ä½¿ç”¨åˆšåˆšæˆ‘ä»¬ç¼–å†™çš„é‚£ä¸ªæ–¹æ³•ï¼š

```python
# ä½¿ç”¨å‡½æ•°è¿›è¡Œæç«¯å€¼çš„è½¬æ¢
data_new = process(data,feature_list)

# ç»˜åˆ¶ç®±ä½“å›¾
sns.set_style("white")
f, ax = plt.subplots(figsize=(8, 7))
ax.set_xscale("log")
ax = sns.boxplot(data=data_new[feature_list] , orient="h", palette="Set1")
ax.xaxis.grid(False)
ax.set(ylabel="Feature names")
ax.set(xlabel="Numeric values")
ax.set(title="Numeric Distribution of Features")
sns.despine(trim=True, left=True)
```

![image-20200403212552077](./arrests/46.png)

see!æˆ‘ä»¬çš„å¼‚å¸¸å€¼å°±ä¼šè¢«ç›´æ¥â€œå®‰æ’â€äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿå…¶å®å¼‚å¸¸å€¼çš„å¤„ç†è¿˜æ˜¯æœ‰å¾ˆå¤§æ–¹æ³•çš„ï¼Œä»Šå¤©å°±æŠ›ç –å¼•ç‰ä¸€ä¸‹ï¼Œæ›´å¤šçš„æ–¹æ³•ç­‰å¾…å¤§å®¶å»æŒ–æ˜å“¦ï¼

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip24ï¼šå½»åº•äº†è§£ä¸€ä¸‹WOEå’ŒIV

ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ä¸¤ä¸ªåè¯æ˜¯åœ¨åšé£æ§æ¨¡å‹çš„æ—¶å€™ï¼Œè€å¸ˆæ•™æˆ‘ä»¬å¯ä»¥ç”¨IVå»åšå˜é‡ç­›é€‰ï¼ŒIVï¼ˆInformation Valueï¼‰ï¼Œä¸­æ–‡åæ˜¯ä¿¡æ¯å€¼ï¼Œç®€å•æ¥è¯´è¿™ä¸ªæŒ‡æ ‡çš„ä½œç”¨å°±æ˜¯æ¥è¡¡é‡å˜é‡çš„é¢„æµ‹èƒ½åŠ›å¼ºå¼±çš„ï¼Œç„¶åIVåˆæ˜¯WOEç®—å‡ºæ¥çš„ã€‚å§‘ä¸”å…ˆä¸ç®¡åŸç†å“ˆï¼Œæˆ‘ä»¬å…ˆç»™å‡ºæ¥ä¸€ä¸‹ç»“è®ºã€‚

| IVèŒƒå›´    | å˜é‡é¢„æµ‹åŠ› |
| --------- | ---------- |
| <0.02     | æ— é¢„æµ‹åŠ›ğŸ˜¯  |
| 0.02~0.10 | å¼±ğŸ‘        |
| 0.10~0.30 | ä¸­ç­‰ğŸ˜Š      |
| `> 0.30   | å¼ºğŸ‘        |

è™½ç„¶å¯èƒ½è¿™ä¸ªæŒ‡æ ‡è¿˜æ˜¯å¾ˆå®¹æ˜“å°±å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯äº†è§£å®ƒçš„åŸç†æ˜¯ååˆ†é‡è¦çš„ï¼Œè¿™å¯¹äºæˆ‘ä»¬æ·±å…¥ç†è§£å˜é‡æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚



åœ¨å¼€å§‹è®²åŸç†å‰ï¼Œå…ˆçº¦å®šä¸€ä¸‹ä»Šå¤©ä¼šç”¨åˆ°çš„ä¸€äº›ä»£å·ã€‚

$y_i$ : ç¬¬iç»„ä¸­å“åº”å®¢æˆ·æ•°é‡

$y_{all}$ : å…¨éƒ¨å“åº”å®¢æˆ·æ•°é‡æ€»å’Œ

$n_i$ ï¼šç¬¬iç»„ä¸­æœªå“åº”å®¢æˆ·æ•°é‡

$n_{all}$ ï¼šå…¨éƒ¨æœªå“åº”å®¢æˆ·æ•°é‡æ€»å’Œ

å“åº”/æœªå“åº”ï¼šæŒ‡çš„æ˜¯è‡ªå˜é‡æ¯ä¸ªè®°å½•å¯¹åº”çš„ç›®æ ‡å˜é‡çš„å€¼ï¼Œç›®æ ‡å˜é‡çš„å€¼ä¸º0æˆ–1ï¼Œä¸€èˆ¬å¦‚æœ1ä¸ºå“åº”çš„è¯ï¼Œ0å°±æ˜¯æœªå“åº”ã€‚

$IV_i$ï¼šç¬¬iç»„çš„IVå€¼

$Py_i$ï¼šç­‰äº $y_i/y_{all}$

$Pn_i$ï¼šç­‰äº $n_i/n_{all}$

å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„è¡¨æ ¼ç†è§£ä¸€æ³¢ï¼Œå˜é‡Aæ˜¯ä¸€ä¸ªè¿ç»­å‹å˜é‡ï¼Œå€¼åŸŸæ˜¯v1-vxï¼Œå½“å‰æ ¹æ®æŸäº›åˆ†ç®±æ–¹å¼åˆ†æˆäº†mç»„ï¼Œå…·ä½“çš„åˆ†ç»„æƒ…å†µå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20200730223421518](./arrests/48.png)

#### WOEçš„åŸç†

WOEæ˜¯weight of evidenceçš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç¼–ç å½¢å¼ï¼Œé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“WOEæ˜¯é’ˆå¯¹ç±»åˆ«å˜é‡è€Œè¨€çš„ï¼Œæ‰€ä»¥è¿ç»­æ€§å˜é‡éœ€è¦æå‰åšå¥½åˆ†ç»„ï¼ˆè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è€ƒç‚¹ï¼Œä¹Ÿæœ‰ä¼šè¯´åˆ†ç®±ã€ç¦»æ•£åŒ–çš„ï¼Œå˜é‡ä¼˜åŒ–ä¹Ÿå¯ä»¥ä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼‰ã€‚

å…ˆç»™å‡ºæ•°å­¦è®¡ç®—å…¬å¼ï¼Œå¯¹äºç¬¬iç»„çš„WOEå¯ä»¥è¿™ä¹ˆè®¡ç®—ï¼š

$$WOE_i = ln(\frac{y_i/y_{all}}{n_i/n_{all}})$$

ä»å…¬å¼ä¸Šå¯ä»¥çœ‹å‡ºï¼Œç¬¬iç»„çš„WOEå€¼ç­‰äºè¿™ä¸ªç»„çš„å“åº”å®¢æˆ·å æ‰€æœ‰å“åº”å®¢æˆ·çš„æ¯”ä¾‹ä¸æœªå“åº”å®¢æˆ·å æ‰€æœ‰æœªå“åº”å®¢æˆ·çš„æ¯”ä¾‹çš„æ¯”å€¼å–å¯¹æ•°ã€‚å¯¹äºä¸Šé¢çš„å…¬å¼æˆ‘ä»¬è¿˜å¯ä»¥ ç®€å•åšä¸€ä¸‹è½¬åŒ–ï¼š

$$WOE_i = ln(\frac{y_i/y_{all}}{n_i/n_{all}}) = ln(\frac{y_i/n_i}{y_{all}/n_{all}})$$

æ‰€ä»¥ï¼ŒWOEä¸»è¦å°±æ˜¯ä½“ç°ç»„å†…çš„å¥½åå æ¯”ä¸æ•´ä½“çš„å·®å¼‚åŒ–ç¨‹åº¦å¤§å°ï¼ŒWOEè¶Šå¤§ï¼Œå·®å¼‚è¶Šå¤§ã€‚

#### IVçš„åŸç†

ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•è®¡ç®—ä¸€ä¸ªåˆ†ç»„çš„WOEå€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠå˜é‡æ‰€æœ‰åˆ†ç»„çš„WOEå€¼ç»™ç®—å‡ºæ¥äº†ï¼Œå¯¹åº”åœ°ï¼Œæ¯ä¸ªåˆ†ç»„ä¹Ÿæœ‰ä¸€ä¸ªIVå€¼ï¼Œæˆ‘ä»¬å«  $IV_i$ ï¼Œå…¶ä¸­ï¼š

$$IV_i = (Py_i-Pn_i)*WOE_i$$

$$IV = \displaystyle\sum^{n}_{i}{IV_i} $$

è®¡ç®—è¿™ä¸ªå˜é‡çš„IVå€¼å°±æ˜¯è¿™æ ·å­å°±å¯ä»¥äº†ï¼ŒæŠŠæ¯ä¸ªåˆ†ç»„çš„IVå€¼ç»™åŠ èµ·æ¥ã€‚



#### å®é™…æ¡ˆä¾‹

å¥½äº†ï¼Œä¸Šé¢çš„ç†è®ºä¹Ÿè®²äº†ä¸€äº›äº†ï¼Œè¿˜æ˜¯æ‹¿ä¸€ä¸ªå®é™…çš„å˜é‡æ¥è®¡ç®—ä¸€ä¸‹ã€‚

æˆ‘ä»¬æ¥å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å–èŒ¶å¶ï¼Œç„¶åæˆ‘ä»¬ä¸çŸ¥é“ä»å“ªé‡Œæ‹¿æ¥äº†ä¸€ä»½1000äººçš„è¥é”€åå•ï¼ˆæ‰‹æœºå·ç ï¼‰ï¼Œç„¶åå°±æ‰¹é‡æ·»åŠ å¾®ä¿¡å¥½å‹ï¼Œæœ€åæœ‰500ä¸ªæ‰‹æœºå·ç å¯ä»¥æˆåŠŸæœç´¢åˆ°å¾®ä¿¡å·çš„ï¼Œè¿›è€Œè¿›è¡Œäº†å¥½å‹æ·»åŠ ï¼Œæœ€ç»ˆæœ‰100äººæˆåŠŸæ·»åŠ åˆ°å¥½å‹äº†ã€‚

æˆ‘ä»¬è¿™ä»½åå•ä¸Šï¼Œæœ‰å®¢æˆ·çš„å¹´é¾„å­—æ®µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‹¿æ¥è®¡ç®—ä¸€ä¸‹è¿™ä¸ªå­—æ®µå¯¹äºæ˜¯å¦æˆåŠŸæ·»åŠ å¥½å‹ï¼ˆå“åº”ï¼‰æœ‰å¤šå¤§çš„é¢„æµ‹èƒ½åŠ›ï¼Œæˆ‘ä»¬åœ¨Excelä¸­è¿›è¡Œå®ç°ï¼š

![image-20200801081041030](./arrests/49.png)

å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªå˜é‡å¯¹äºæˆ‘ä»¬æ˜¯å¦å¯ä»¥æˆåŠŸåŠ åˆ°å®¢æˆ·å¾®ä¿¡å¥½å‹æœ‰ç€å¾ˆå¼ºçš„é¢„æµ‹èƒ½åŠ›ã€‚



#### Pythonå®ç°

æˆ‘ä»¬çŸ¥é“ï¼Œé’ˆå¯¹è¿ç»­å‹å˜é‡ï¼Œæ˜¯éœ€è¦å…ˆè½¬æ¢ä¸ºç±»åˆ«å˜é‡æ‰å¯ä»¥è¿›è¡ŒIVå€¼çš„è®¡ç®—çš„ï¼Œç°åœ¨æˆ‘ä»¬æŠŠæ•°æ®å¯¼å…¥åˆ°Pythonä¸­ï¼ŒåŸå§‹å˜é‡æ˜¯è¿ç»­å‹å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åœ¨Pythoné‡Œå®ç°IVå€¼çš„è®¡ç®—å‘¢ï¼Ÿå¦‚ä¸‹å›¾ï¼šï¼ˆå…¶ä¸­target=1ä»£è¡¨å“åº”ï¼Œtarget=0ä»£è¡¨æœªå“åº”ï¼‰

![image-20200801092020512](./arrests/50.png)

æ ¸å¿ƒä»£ç å°±æ˜¯ä¸‹é¢çš„ï¼š

```python
def iv_count(data_bad, data_good):
    '''è®¡ç®—ivå€¼'''
    value_list = set(data_bad.unique()) | set(data_good.unique())
    iv = 0
    len_bad = len(data_bad)
    len_good = len(data_good)
    for value in value_list:
        # åˆ¤æ–­æ˜¯å¦æŸç±»æ˜¯å¦ä¸º0ï¼Œé¿å…å‡ºç°æ— ç©·å°å€¼å’Œæ— ç©·å¤§å€¼
        if sum(data_bad == value) == 0:
            bad_rate = 1 / len_bad
        else:
            bad_rate = sum(data_bad == value) / len_bad
        if sum(data_good == value) == 0:
            good_rate = 1 / len_good
        else:
            good_rate = sum(data_good == value) / len_good
        iv += (good_rate - bad_rate) * math.log(good_rate / bad_rate,2)
        print(value,iv)
    return iv
```



é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å‘¢ï¼Œä¸€æ­¥ä¸€æ­¥æ¥ï¼š

##### Step1ï¼šå¯¼å…¥æ•°æ®

æµ‹è¯•æ•°æ®é›†å¯ä»¥åå°å›å¤ 'age' è¿›è¡Œè·å–ã€‚

```Python
data = pd.read_csv('./data/age.csv')

# å®šä¹‰å¿…è¦çš„å‚æ•°
feature = data.loc[:,['age']]
labels = data['target']
keep_cols = ['age']
cut_bin_dict = {'age':[0,18,25,30,40,50,100]}
```

##### Step2ï¼šæŒ‰ç…§æŒ‡å®šé˜ˆå€¼åˆ†ç®±

æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰Excelç›¸åŒçš„åˆ†ç®±é€»è¾‘è¿›è¡Œåˆ†ç®±:

```python
cut_bin = cut_bin_dict['age']
# æŒ‰ç…§åˆ†ç®±é˜ˆå€¼åˆ†ç®±,å¹¶å°†ç¼ºå¤±å€¼æ›¿æ¢æˆBlank,åŒºåˆ†å¥½åæ ·æœ¬
data_bad = pd.cut(feature['age'], cut_bin, right=False).cat.add_categories(['Blank']).fillna('Blank')[labels == 1]
data_good = pd.cut(feature['age'], cut_bin, right=False
                   ).cat.add_categories(['Blank']).fillna('Blank')[labels == 0]

value_list = set(data_bad.unique()) | set(data_good.unique())
value_list
```

![image-20200801092640472](./arrests/51.png)

##### Step3ï¼šè°ƒç”¨å‡½æ•°è®¡ç®—IV

```python
iv_series['age'] = iv_count(data_bad, data_good)
iv_series

```

![image-20200801092803440](./arrests/52.png)

å¯ä»¥çœ‹å¾—å‡ºï¼Œå’Œæˆ‘ä»¬Excelè®¡ç®—çš„ç»“æœå®Œå…¨ä¸€è‡´ï¼

#### â€œæˆ‘è¦æ‰“10ä¸ªâ€ç‰ˆæœ¬

å—¯ï¼Œä¸Šé¢é’ˆå¯¹å•ä¸ªçš„å˜é‡IVè®¡ç®—æ˜¯ä¼šäº†ï¼Œé‚£ä¹ˆå¦‚æœæœ‰ä¸€å †éœ€è¦ä½ è®¡ç®—IVçš„å˜é‡ï¼Œå¯ä»¥å¦‚ä½•å¤„ç†å‘¢?å…¶å®ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯å†™ä¸ªå¾ªç¯ï¼Œè¿™é‡Œå‘¢å·²ç»å†™å¥½äº†ä¸€ä¸ªï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹çš„ã€‚è¿™è¾¹æœ‰ä¸€äº›ç»†èŠ‚çš„ä¸œè¥¿éœ€è¦è¯´æ˜ä¸€ä¸‹çš„ã€‚

1ï¼‰æ³¨æ„åŒºåˆ†å˜é‡ç±»å‹ï¼Œæ•°å€¼å‹å˜é‡å’Œç±»åˆ«å‹å˜é‡è¦åŒºåˆ†å¯¹å¾…ã€‚

2ï¼‰æ³¨æ„åˆ†ç»„åæ˜¯å¦å‡ºç°æŸç»„å†…çš„å“åº”(æœªå“åº”)æ•°é‡ä¸ºé›¶çš„æƒ…å†µï¼Œå¦‚æœä¸ºé›¶éœ€è¦å¤„ç†ä¸€ä¸‹ã€‚

ä»£ç æ”¾ä¸Šï¼Œå¤§å®¶å¯ä»¥è¯•ç€è¿è¡Œä¸€ä¸‹ï¼š

```python
def get_iv_series(feature, labels, keep_cols=None, cut_bin_dict=None):
    '''
    è®¡ç®—å„å˜é‡æœ€å¤§çš„ivå€¼,get_iv_seriesæ–¹æ³•å‡ºå…¥å‚å¦‚ä¸‹:
    ------------------------------------------------------------
    å…¥å‚ç»“æœå¦‚ä¸‹:
        feature: æ•°æ®é›†çš„ç‰¹å¾ç©ºé—´
        labels: æ•°æ®é›†çš„è¾“å‡ºç©ºé—´
        keep_cols: éœ€è®¡ç®—ivå€¼çš„å˜é‡åˆ—è¡¨
        cut_bin_dict: æ•°å€¼å‹å˜é‡è¦è¿›è¡Œåˆ†ç®±çš„é˜ˆå€¼å­—å…¸,æ ¼å¼ä¸º{'col1':[value1,value2,...], 'col2':[value1,value2,...], ...}
    ------------------------------------------------------------
    å…¥å‚ç»“æœå¦‚ä¸‹:
        iv_series: å„å˜é‡æœ€å¤§çš„IVå€¼
    '''
    def iv_count(data_bad, data_good):
        '''è®¡ç®—ivå€¼'''
        value_list = set(data_bad.unique()) | set(data_good.unique())
        iv = 0
        len_bad = len(data_bad)
        len_good = len(data_good)
        for value in value_list:
            # åˆ¤æ–­æ˜¯å¦æŸç±»æ˜¯å¦ä¸º0ï¼Œé¿å…å‡ºç°æ— ç©·å°å€¼å’Œæ— ç©·å¤§å€¼
            if sum(data_bad == value) == 0:
                bad_rate = 1 / len_bad
            else:
                bad_rate = sum(data_bad == value) / len_bad
            if sum(data_good == value) == 0:
                good_rate = 1 / len_good
            else:
                good_rate = sum(data_good == value) / len_good
            iv += (good_rate - bad_rate) * math.log(good_rate / bad_rate,2)
        return iv

    if keep_cols is None:
        keep_cols = sorted(list(feature.columns))
    col_types = feature[keep_cols].dtypes
    categorical_feature = list(col_types[col_types == 'object'].index)
    numerical_feature = list(col_types[col_types != 'object'].index)

    iv_series = pd.Series()

    # éå†æ•°å€¼å˜é‡è®¡ç®—ivå€¼
    for col in numerical_feature:
        cut_bin = cut_bin_dict[col]
        # æŒ‰ç…§åˆ†ç®±é˜ˆå€¼åˆ†ç®±,å¹¶å°†ç¼ºå¤±å€¼æ›¿æ¢æˆBlank,åŒºåˆ†å¥½åæ ·æœ¬
        data_bad = pd.cut(feature[col], cut_bin, right=False).cat.add_categories(['Blank']).fillna('Blank')[labels == 1]
        data_good = pd.cut(feature[col], cut_bin, right=False
                           ).cat.add_categories(['Blank']).fillna('Blank')[labels == 0]
        iv_series[col] = iv_count(data_bad, data_good)
    # éå†ç±»åˆ«å˜é‡è®¡ç®—ivå€¼
    for col in categorical_feature:
        # å°†ç¼ºå¤±å€¼æ›¿æ¢æˆBlank,åŒºåˆ†å¥½åæ ·æœ¬
        data_bad = feature[col].fillna('Blank')[labels == 1]
        data_good = feature[col].fillna('Blank')[labels == 0]
        iv_series[col] = iv_count(data_bad, data_good)

    return iv_series
```

##### è°ƒç”¨demoï¼š

```python
iv_series = get_iv_series(feature, labels, keep_cols, cut_bin_dict=cut_bin_dict)
iv_series
# age    0.434409
```

#### æ€»ç»“ä¸€ä¸‹

è®°ä½IVå€¼çš„é¢„æµ‹èƒ½åŠ›æ˜ å°„ï¼š

| IVèŒƒå›´    | å˜é‡é¢„æµ‹åŠ› |
| --------- | ---------- |
| <0.02     | æ— é¢„æµ‹åŠ›ğŸ˜¯  |
| 0.02~0.10 | å¼±ğŸ‘        |
| 0.10~0.30 | ä¸­ç­‰ğŸ˜Š      |
| `> 0.30   | å¼ºğŸ‘        |

å¦‚æœæƒ³å¤ç°ä»£ç ï¼Œå¯ä»¥ä»æˆ‘çš„å…¬å·åå°è¾“å‡º  'age' å»è·å–æµ‹è¯•é›†å§ï¼Œæˆ–è€…æ‹¿è‡ªå·±ç›®å‰çš„æ•°æ®é›†æ¥ç©ç©ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡å¾—æ³¨æ„ä¸€äº›ç»†èŠ‚ï¼Œè½¬æ¢æ•°æ®æ ¼å¼ã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip25ï¼šä¸€æ–‡ä»‹ç»ç‰¹å¾å·¥ç¨‹é‡Œçš„å¡æ–¹åˆ†ç®±ï¼Œé™„ä»£ç å®ç°

ä»Šå¤©è¿˜æ˜¯è®²ä¸€ä¸‹é‡‘èé£æ§çš„ç›¸å…³çŸ¥è¯†ï¼Œä¸Šä¸€æ¬¡æˆ‘ä»¬æœ‰è®²åˆ°ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è®¡ç®—å˜é‡çš„IVå€¼ï¼Œä»è€Œåˆ¤æ–­å˜é‡çš„é¢„æµ‹èƒ½åŠ›å¼ºå¼±ï¼Œæ˜¯éœ€è¦å¯¹å˜é‡è¿›è¡Œç¦»æ•£åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯åˆ†ç®±å¤„ç†ã€‚é‚£ä¹ˆï¼Œä»Šå¤©å°±æ¥ç»™å¤§å®¶è§£é‡Šä¸€ä¸‹å…¶ä¸­ä¸€ç§åˆ†ç®±æ–¹å¼ â€”â€” å¡æ–¹åˆ†ç®±å¤„ç†ã€‚

#### âœï¸ äº†è§£å¡æ–¹åˆ†å¸ƒ

äº†è§£å¡æ–¹åˆ†ç®±ï¼Œé¦–å…ˆéœ€è¦äº†è§£ä¸‹å¡æ–¹åˆ†å¸ƒã€‚å¡æ–¹åˆ†å¸ƒ(chi-square distribution, Ï‡2-distribution)æ˜¯æ¦‚ç‡ç»Ÿè®¡é‡Œå¸¸ç”¨çš„ä¸€ç§æ¦‚ç‡åˆ†å¸ƒï¼Œä¹Ÿæ˜¯ç»Ÿè®¡æ¨æ–­é‡Œåº”ç”¨æœ€å¹¿æ³›çš„æ¦‚ç‡åˆ†å¸ƒä¹‹ä¸€ï¼Œåœ¨å‡è®¾æ£€éªŒä¸ç½®ä¿¡åŒºé—´çš„è®¡ç®—ä¸­ç»å¸¸èƒ½è§åˆ°å¡æ–¹åˆ†å¸ƒçš„èº«å½±ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š

> è‹¥kä¸ªç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡$Z_1$, $Z_2$, $Z_3$, ..., $Z_k$ æ»¡è¶³æ ‡å‡†æ­£æ€åˆ†å¸ƒ N(0,1)ï¼Œé‚£ä¹ˆè¿™kä¸ªéšæœºå˜é‡çš„å¹³æ–¹å’Œ $X=\displaystyle\sum^{k}_{i=1}{Z_i^2}$å°±æ˜¯æœä»è‡ªç”±åº¦ä¸ºkçš„å¡æ–¹åˆ†å¸ƒäº†ï¼Œä¸€èˆ¬è®°ä½œï¼š$X ï½  X^2(k)$

å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼ˆå›¾ç‰‡æ¥è‡ªç™¾åº¦ç™¾ç§‘ï¼‰ï¼š

![image-20200816203804735](./arrests/53.png)

#### âœï¸äº†è§£ä¸‹å¡æ–¹æ£€æµ‹

å¡æ–¹æ£€æµ‹æ˜¯ä»¥å¡æ–¹åˆ†å¸ƒä¸ºåŸºç¡€çš„ä¸€ç§å‡è®¾æ£€éªŒæ–¹æ³•ï¼Œä¸»è¦æ˜¯ç”¨äºæ£€éªŒåˆ†ç±»å˜é‡ä¹‹é—´çš„ç‹¬ç«‹æ€§æƒ…å†µã€‚å®ƒçš„åŸºæœ¬æ€æƒ³å°±æ˜¯æ ¹æ®æ ·æœ¬æ•°æ®æ¨æ–­æ€»ä½“åˆ†å¸ƒä¸æœŸæœ›åˆ†å¸ƒä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜¾è‘—æ€§å·®å¼‚ï¼Œæˆ–è€…è¯´ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´æ˜¯å¦ç›¸äº’ç‹¬ç«‹ï¼ˆoræ˜¯å¦ç›¸å…³ï¼‰ã€‚

**ä¸€èˆ¬çš„æƒ…å†µä¸‹æˆ‘ä»¬ä¼šæŠŠåŸå‡è®¾è®¾ç½®ä¸ºï¼šè§‚å¯Ÿé¢‘æ•°ä¸æœŸæœ›é¢‘æ•°ä¹‹é—´æ²¡æœ‰å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹ä¸ç›¸å…³çš„**ã€‚

å®é™…çš„åº”ç”¨ä¸­æˆ‘ä»¬å‡è®¾åŸå‡è®¾æˆç«‹ï¼Œç„¶åè®¡ç®—å‡ºå¡æ–¹å€¼ï¼Œä»è€Œæ¥å†³ç­–æ˜¯å¦éœ€è¦æ‹’ç»åŸå‡è®¾ï¼Œå¡æ–¹å€¼çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

$X_k^2= \sum{\frac{(A-E)^2}{E}} $

å…¶ä¸­ï¼ŒAä¸ºå®é™…é¢‘æ•°ï¼ŒEä¸ºæœŸæœ›é¢‘æ•°ï¼Œå¡æ–¹å€¼å°±æ˜¯è®¡ç®—å®é™…ä¸æœŸæœ›ä¹‹é—´çš„å·®å¼‚ç¨‹åº¦å¤§å°çš„é‡åŒ–æŒ‡æ ‡ã€‚ä¸Šé¢å…¬å¼ç»“æœæœä»å¡æ–¹åˆ†å¸ƒï¼Œç„¶åæˆ‘ä»¬æ ¹æ®å¡æ–¹åˆ†å¸ƒã€å¡æ–¹ç»Ÿè®¡é‡ä»¥åŠè‡ªç”±åº¦ï¼Œå°±å¯ä»¥æŸ¥å‡ºpå€¼ï¼Œå¦‚æœpå€¼å¾ˆå°ï¼Œä»£è¡¨è§‚å¯Ÿå€¼ä¸æœŸæœ›å€¼åç¦»ç¨‹åº¦å¾ˆå¤§ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‹’ç»åŸå‡è®¾ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´æœ‰ç›¸å…³æ€§ã€‚



#### ğŸ” å¡æ–¹åˆ†å¸ƒè¡¨

è¿™ä¸ªæ¦‚å¿µè²Œä¼¼åœ¨å¤§ä¸€çš„æ—¶å€™å°±æœ‰æ¥è§¦è¿‡äº†ï¼Œå¯ä»¥çŸ¥é“æ¨ªè½´æ˜¯åˆ†ä½æ•°ï¼Œçºµè½´æ˜¯è‡ªç”±åº¦ï¼Œç„¶åç±»ä¼¼äºPythonçš„locæ–¹æ³•ï¼Œå®šä½åˆ°çš„å€¼å°±æ˜¯å¡æ–¹å€¼äº†ã€‚ï¼ˆæ¯”å¦‚ï¼Œè¦æ‰¾åˆ†ä½æ•°ä½0.9ï¼Œè‡ªç”±åº¦ä¸º8çš„å€¼ï¼ŒæŸ¥è¡¨å¯çŸ¥ä¸º3.489539

![image-20200826222449796](./arrests/54.png)

å¦‚æœæƒ³è¦åœ¨Pythoné‡Œç”Ÿæˆå¡æ–¹åˆ†å¸ƒè¡¨ï¼Œå¯ä»¥å°è¯•ä¸‹é¢çš„ä»£ç ï¼š

```python
# ç”¨Pythonç”Ÿæˆå¡æ–¹åˆ†å¸ƒä¸´ç•Œå€¼è¡¨
import numpy as np
import pandas as pd
from scipy.stats import chi2
 
# chi square distribution
percents = [0.995, 0.990, 0.975, 0.950, 0.900, 0.100, 0.050, 0.025, 0.010, 0.005]
df = pd.DataFrame(np.array([chi2.isf(percents, df=i) for i in range(1, 10)]), columns=percents, index=list(range(1,10)))
df
```


#### ğŸ¤” ä¸¾ä¸ªæ —å­

æˆ‘ä»¬æœ‰ä¸€ç»„æ•°æ®ï¼Œæ˜¯æŸç§ç—…çš„æ‚£è€…ä½¿ç”¨äº†Aå’ŒBä¸¤ç§ä¸åŒæ–¹æ¡ˆçš„æ²»ç–—ï¼Œæ‰€å¾—åˆ°çš„æ²»ç–—ç»“æœï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œé—®Aã€Bä¸¤ç§ç–—æ³•æ˜¯å¦æœ‰æ˜æ˜¾å·®å¼‚ï¼Ÿ

| ç»„åˆ« | æœ‰æ•ˆ | æ— æ•ˆ | åˆè®¡ | æœ‰æ•ˆç‡% |
| ---- | ---- | ---- | ---- | ------- |
| Aç»„  | 19   | 24   | 43   | 44.2%   |
| Bç»„  | 34   | 10   | 44   | 77.3%   |
| åˆè®¡ | 53   | 34   | 87   | 60.9%   |

##### è§£ï¼š

è¿™é“é¢˜å…¶å®å°±æ˜¯å¥—å…¬å¼ï¼Œä»ä¸Šé¢æˆ‘äº†è§£åˆ°è¦è®¡ç®—å¡æ–¹å€¼å¯ä»¥æœ‰è¿™ä¸ªå…¬å¼ï¼š

![image-20200826223921485](./arrests/55.png)

æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆç®—å‡ºæ¯ä¸ªæ ¼å­çš„æœŸæœ›é¢‘æ•°ï¼š

ç¤ºä¾‹1ï¼šAç»„æœ‰æ•ˆçš„æœŸæœ›é¢‘æ•°ï¼š43*53/87=26.20

| æœŸæœ›é¢‘æ•° | æœ‰æ•ˆ  | æ— æ•ˆ  | åˆè®¡ | æœ‰æ•ˆç‡% |
| -------- | ----- | ----- | ---- | ------- |
| Aç»„      | 26.20 | 16.80 | 43   | 60.9%   |
| Bç»„      | 26.80 | 17.20 | 44   | 60.9%   |
| åˆè®¡     | 53    | 34    | 87   | 60.9%   |

**å…ˆå»ºç«‹åŸå‡è®¾ï¼šAã€Bä¸¤ç§ç–—æ³•æ²¡æœ‰åŒºåˆ«ã€‚**

ç„¶åå°±å¥—å…¥ä¸Šé¢çš„å…¬å¼ï¼šï¼ˆAä¸ºå®é™…é¢‘æ•°ï¼ŒEä¸ºæœŸæœ›é¢‘æ•°ï¼‰

$X_k^2= \sum{\frac{(A-E)^2}{E}} = \frac{(19-26.2)^2}{26.2} +\frac{(24-16.8)^2}{16.8} + \frac{(34-26.8)^2}{26.8} + \frac{(10-17.2)^2}{17.2} = 10.01$

å› ä¸ºæˆ‘ä»¬é€‰æ‹©äº†å…¶ä¸­ä¸€ä¸ªæ–¹æ¡ˆï¼Œå¦å¤–ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜ç¡®äº†ï¼Œæ‰€ä»¥è‡ªç”±åº¦æ˜¯1ï¼Œå› æ­¤å¯ä»¥æŸ¥è¡¨ï¼Œè‡ªç”±åº¦ä¸º1çš„ï¼Œè€Œä¸”å¡æ–¹å€¼ä¸º10.01çš„åˆ†ä½æ•°æ˜¯å¤šå°‘äº†ï½

æŸ¥è¡¨è‡ªç”±åº¦ä¸º1,p=0.05çš„å¡æ–¹å€¼ä¸º3.841ï¼Œè€Œæ­¤ä¾‹å¡æ–¹å€¼10.01>3.841ï¼Œå› æ­¤ p < 0.05ï¼Œè¯´æ˜åŸå‡è®¾åœ¨0.05çš„æ˜¾è‘—æ€§æ°´å¹³ä¸‹æ˜¯å¯ä»¥æ‹’ç»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åŸå‡è®¾ä¸æˆç«‹ï¼Œä¹Ÿå°±æ˜¯ä¸¤ç§æ²»ç–—æ–¹æ¡ˆæœ‰åŒºåˆ«ã€‚



#### ğŸ˜† è¿›å…¥æ­£é¢˜

ä¸Šé¢è®²äº†è¿™ä¹ˆå¤šåŸºç¡€çš„çŸ¥è¯†ï¼Œå°±æ˜¯ä¸ºäº†å¼•å‡ºè¿™ä¸€èŠ‚çš„å†…å®¹â€”â€” ChiMergeåˆ†ç®±ç®—æ³•ã€‚

ChiMergeå¡æ–¹åˆ†ç®±ç®—æ³•ç”±Kerberäº1992æå‡ºã€‚å®ƒä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µï¼š**åˆå§‹åŒ–é˜¶æ®µå’Œè‡ªåº•å‘ä¸Šçš„åˆå¹¶é˜¶æ®µã€‚**

##### 1ã€åˆå§‹åŒ–é˜¶æ®µï¼š

é¦–å…ˆæŒ‰ç…§å±æ€§å€¼çš„å¤§å°è¿›è¡Œæ’åºï¼ˆå¯¹äºéè¿ç»­ç‰¹å¾ï¼Œéœ€è¦å…ˆåšæ•°å€¼è½¬æ¢ï¼Œæ¯”å¦‚è½¬ä¸ºåäººç‡ï¼Œç„¶åæ’åºï¼‰ï¼Œç„¶åæ¯ä¸ªå±æ€§å€¼å•ç‹¬ä½œä¸ºä¸€ç»„ã€‚

##### 2ã€åˆå¹¶é˜¶æ®µï¼š

ï¼ˆ1ï¼‰å¯¹æ¯ä¸€å¯¹ç›¸é‚»çš„ç»„ï¼Œè®¡ç®—å¡æ–¹å€¼ã€‚

ï¼ˆ2ï¼‰æ ¹æ®è®¡ç®—çš„å¡æ–¹å€¼ï¼Œå¯¹å…¶ä¸­æœ€å°çš„ä¸€å¯¹é‚»ç»„åˆå¹¶ä¸ºä¸€ç»„ã€‚

ï¼ˆ3ï¼‰ä¸æ–­é‡å¤ï¼ˆ1ï¼‰å’Œï¼ˆ2ï¼‰ç›´åˆ°è®¡ç®—å‡ºçš„å¡æ–¹å€¼éƒ½ä¸ä½äºäº‹å…ˆè®¾å®šçš„é˜ˆå€¼ï¼Œæˆ–è€…åˆ†ç»„æ•°è¾¾åˆ°ä¸€å®šçš„æ¡ä»¶ï¼ˆå¦‚æœ€å°åˆ†ç»„æ•°5ï¼Œæœ€å¤§åˆ†ç»„æ•°8ï¼‰ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé˜¿Samä¹‹å‰å‘ç°æœ‰çš„å®ç°æ–¹æ³•åœ¨åˆå¹¶é˜¶æ®µï¼Œè®¡ç®—çš„å¹¶éç›¸é‚»ç»„çš„å¡æ–¹å€¼ï¼ˆåªè€ƒè™‘åœ¨æ­¤ä¸¤ç»„å†…çš„æ ·æœ¬ï¼Œå¹¶è®¡ç®—æœŸæœ›é¢‘æ•°ï¼‰ï¼Œå› ä¸ºä»–ä»¬ç”¨æ•´ä½“æ ·æœ¬æ¥è®¡ç®—æ­¤ç›¸é‚»ä¸¤ç»„çš„æœŸæœ›é¢‘æ•°ã€‚

äº†è§£äº†åŸç†ä¹‹åï¼Œé‚£ä¹ˆPythonå¦‚ä½•å®ç°å‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š

##### Step1:å¯¼å…¥ç›¸å…³åº“

```python
import numpy as np
from scipy.stats import chi
import pandas as pd
from pandas import DataFrame,Series
import scipy

```

##### Step2:è®¡ç®—å¡æ–¹å€¼

```python
def chi3(arr):
   '''
  è®¡ç®—å¡æ–¹å€¼
  arr:é¢‘æ•°ç»Ÿè®¡è¡¨,äºŒç»´numpyæ•°ç»„ã€‚
  '''
   assert(arr.ndim==2)
   #è®¡ç®—æ¯è¡Œæ€»é¢‘æ•°
   R_N = arr.sum(axis=1)
   #æ¯åˆ—æ€»é¢‘æ•°
   C_N = arr.sum(axis=0)
   #æ€»é¢‘æ•°
   N = arr.sum()
   # è®¡ç®—æœŸæœ›é¢‘æ•° C_i * R_j / Nã€‚
   E = np.ones(arr.shape)* C_N / N
   E = (E.T * R_N).T
   square = (arr-E)**2 / E
   #æœŸæœ›é¢‘æ•°ä¸º0æ—¶ï¼Œåšé™¤æ•°æ²¡æœ‰æ„ä¹‰ï¼Œä¸è®¡å…¥å¡æ–¹å€¼
   square[E==0] = 0
   #å¡æ–¹å€¼
   v = square.sum()
   return v

```

##### Step3:ç¡®å®šå¡æ–¹åˆ†ç®±ç‚¹

```python
def chiMerge(df,col,target,max_groups=None,threshold=None):

   '''
  å¡æ–¹åˆ†ç®±
  df: pandas dataframeæ•°æ®é›†
  col: éœ€è¦åˆ†ç®±çš„å˜é‡åï¼ˆæ•°å€¼å‹ï¼‰
  target: ç±»æ ‡ç­¾
  max_groups: æœ€å¤§åˆ†ç»„æ•°ã€‚
  threshold: å¡æ–¹é˜ˆå€¼ï¼Œå¦‚æœæœªæŒ‡å®šmax_groupsï¼Œé»˜è®¤ä½¿ç”¨ç½®ä¿¡åº¦95%è®¾ç½®thresholdã€‚
  return: åŒ…æ‹¬å„ç»„çš„èµ·å§‹å€¼çš„åˆ—è¡¨.
  '''

   freq_tab = pd.crosstab(df[col],df[target])

   #è½¬æˆnumpyæ•°ç»„ç”¨äºè®¡ç®—ã€‚
   freq = freq_tab.values

   #åˆå§‹åˆ†ç»„åˆ‡åˆ†ç‚¹ï¼Œæ¯ä¸ªå˜é‡å€¼éƒ½æ˜¯åˆ‡åˆ†ç‚¹ã€‚æ¯ç»„ä¸­åªåŒ…å«ä¸€ä¸ªå˜é‡å€¼.

   #åˆ†ç»„åŒºé—´æ˜¯å·¦é—­å³å¼€çš„ï¼Œå¦‚cutoffs = [1,2,3]ï¼Œåˆ™è¡¨ç¤ºåŒºé—´ [1,2) , [2,3) ,[3,3+)ã€‚
   cutoffs = freq_tab.index.values

   #å¦‚æœæ²¡æœ‰æŒ‡å®šæœ€å¤§åˆ†ç»„
   if max_groups is None:    
       #å¦‚æœæ²¡æœ‰æŒ‡å®šå¡æ–¹é˜ˆå€¼ï¼Œå°±ä»¥95%çš„ç½®ä¿¡åº¦ï¼ˆè‡ªç”±åº¦ä¸ºç±»æ•°ç›®-1ï¼‰è®¾å®šé˜ˆå€¼ã€‚
       if threshold is None:
           #ç±»æ•°ç›®
           cls_num = freq.shape[-1]
           threshold = chi2.isf(0.05,df= cls_num - 1)

   while True:
       minvalue = None
       minidx = None
       #ä»ç¬¬1ç»„å¼€å§‹ï¼Œä¾æ¬¡å–ä¸¤ç»„è®¡ç®—å¡æ–¹å€¼ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦å°äºå½“å‰æœ€å°çš„å¡æ–¹
       for i in range(len(freq) - 1):
           v = chi3(freq[i:i+2])
           if minvalue is None or (minvalue > v): #å°äºå½“å‰æœ€å°å¡æ–¹ï¼Œæ›´æ–°æœ€å°å€¼
               minvalue = v
               minidx = i

       #å¦‚æœæœ€å°å¡æ–¹å€¼å°äºé˜ˆå€¼ï¼Œåˆ™åˆå¹¶æœ€å°å¡æ–¹å€¼çš„ç›¸é‚»ä¸¤ç»„ï¼Œå¹¶ç»§ç»­å¾ªç¯
       if (max_groups is not None and  max_groups< len(freq) ) or (threshold is not None and minvalue < threshold):
           #minidxåä¸€è¡Œåˆå¹¶åˆ°minidx
           tmp = freq[minidx] + freq[minidx+1]
           freq[minidx] = tmp
           #åˆ é™¤minidxåä¸€è¡Œ
           freq = np.delete(freq,minidx+1,0)
           #åˆ é™¤å¯¹åº”çš„åˆ‡åˆ†ç‚¹
           cutoffs = np.delete(cutoffs,minidx+1,0)

       else: #æœ€å°å¡æ–¹å€¼ä¸å°äºé˜ˆå€¼ï¼Œåœæ­¢åˆå¹¶ã€‚
           break
   return cutoffs

```

##### Step4:ç”Ÿæˆåˆ†ç»„åçš„æ–°å˜é‡

```python
def value2group(x,cutoffs):

   '''
  å°†å˜é‡çš„å€¼è½¬æ¢æˆç›¸åº”çš„ç»„ã€‚
  x: éœ€è¦è½¬æ¢åˆ°åˆ†ç»„çš„å€¼
  cutoffs: å„ç»„çš„èµ·å§‹å€¼ã€‚
  return: xå¯¹åº”çš„ç»„ï¼Œå¦‚group1ã€‚ä»group1å¼€å§‹ã€‚
  '''
   #åˆ‡åˆ†ç‚¹ä»å°åˆ°å¤§æ’åºã€‚
   cutoffs = sorted(cutoffs)
   num_groups = len(cutoffs)

   #å¼‚å¸¸æƒ…å†µï¼šå°äºç¬¬ä¸€ç»„çš„èµ·å§‹å€¼ã€‚è¿™é‡Œç›´æ¥æ”¾åˆ°ç¬¬ä¸€ç»„ã€‚
   #å¼‚å¸¸å€¼å»ºè®®åœ¨åˆ†ç»„ä¹‹å‰å…ˆå¤„ç†å¦¥å–„ã€‚
   if x < cutoffs[0]:
       return 'group1'

   for i in range(1,num_groups):
       if cutoffs[i-1] <= x < cutoffs[i]:
           return 'group{}'.format(i)

   #æœ€åä¸€ç»„ï¼Œä¹Ÿå¯èƒ½ä¼šåŒ…æ‹¬ä¸€äº›éå¸¸å¤§çš„å¼‚å¸¸å€¼ã€‚
   return 'group{}'.format(num_groups)

```

##### Step5:å®ç°WOEç¼–ç 

```python
def calWOE(df ,var ,target):

   '''
  è®¡ç®—WOEç¼–ç 
  param dfï¼šæ•°æ®é›†pandas.dataframe
  param varï¼šå·²åˆ†ç»„çš„åˆ—åï¼Œæ— ç¼ºå¤±å€¼
  param targetï¼šå“åº”å˜é‡ï¼ˆ0,1ï¼‰
  returnï¼šç¼–ç å­—å…¸
  '''
   eps = 0.000001  #é¿å…é™¤ä»¥0
   gbi = pd.crosstab(df[var],df[target]) + eps
   gb = df[target].value_counts() + eps
   gbri = gbi/gb
   gbri['woe'] = np.log(gbri[1]/gbri[0])
   return gbri['woe'].to_dict()

```

##### Step6:å®ç°IVå€¼è®¡ç®—

```python
def calIV(df,var,target):

   '''
  è®¡ç®—IVå€¼
  param dfï¼šæ•°æ®é›†pandas.dataframe
  param varï¼šå·²åˆ†ç»„çš„åˆ—åï¼Œæ— ç¼ºå¤±å€¼
  param targetï¼šå“åº”å˜é‡ï¼ˆ0,1ï¼‰
  returnï¼šIVå€¼
  '''
   eps = 0.000001  #é¿å…é™¤ä»¥0
   gbi = pd.crosstab(df[var],df[target]) + eps
   gb = df[target].value_counts() + eps
   gbri = gbi/gb
   gbri['woe'] = np.log(gbri[1]/gbri[0])
   gbri['iv'] = (gbri[1] - gbri[0])*gbri['woe']
   return gbri['iv'].sum()
```

##### Step7:Pythonä»£ç ä½¿ç”¨

```python
cutoffs = chiMerge(data,'MAX_AMOUNT','target',max_groups=8)
'''

PSï¼šç»å¤§æ•°æƒ…å†µä¸‹ï¼Œä¼šå°†ç¼ºå¤±å€¼NaNå½’ç±»åˆ°æœ€åä¸€ç»„ï¼Œå¦‚æœä¸æƒ³è¿™ä¹ˆç®€å•ç²—æš´çš„ï¼Œéœ€è¦åœ¨æœ€å¼€å§‹çš„æ—¶å€™å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¡«å……ã€‚

'''py
data['MAX_AMOUNT_chigroup'] = data['MAX_AMOUNT'].apply(value2group,args=(cutoffs,))
r = data.loc[:,['MAX_ã€AMOUNT','MAX_AMOUNT_chigroup','target']]
woe_map = calWOE(data,'MAX_AMOUNT_chigroup','target')
iv = calIV(data,'MAX_AMOUNT_chigroup','target')
iv
```


#### ğŸ“– Reference

[1] Pythonè¯„åˆ†å¡å»ºæ¨¡â€”å¡æ–¹åˆ†ç®±ï¼ˆ1ï¼‰

[2] Pythonè¯„åˆ†å¡å»ºæ¨¡â€”å¡æ–¹åˆ†ç®±ï¼ˆ2ï¼‰ä¹‹ä»£ç å®ç°

[3] pythonè¯„åˆ†å¡å»ºæ¨¡â€”å®ç°WOEç¼–ç åŠIVå€¼è®¡ç®—


<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip26ï¼šä»Šå¤©ä¸€èµ·ææ‡‚æœºå™¨å­¦ä¹ é‡Œçš„L1ä¸L2æ­£åˆ™åŒ–

ä»Šå¤©æˆ‘ä»¬æ¥è®²è®²ä¸€ä¸ªç†è®ºçŸ¥è¯†ï¼Œä¹Ÿæ˜¯è€ç”Ÿå¸¸è°ˆçš„å†…å®¹ï¼Œåœ¨æ¨¡å‹å¼€å‘ç›¸å…³å²—ä½ä¸­å‡ºåœºç‡è¾ƒé«˜çš„ï¼Œé‚£å°±æ˜¯L1ä¸L2æ­£åˆ™åŒ–äº†ï¼Œè¿™ä¸ªçœ‹ä¼¼ç®€å•å´ååˆ†é‡è¦çš„æ¦‚å¿µï¼Œè¿˜æ˜¯éœ€è¦æ·±å…¥äº†è§£çš„ã€‚ç½‘ä¸Šæœ‰è›®å¤šçš„å­¦ä¹ èµ„æ–™ï¼Œä»Šå¤©æˆ‘å°±ç€è‡ªå·±çš„ç†è§£ä¹Ÿå†™ä¸€ä¸‹ç¬”è®°ã€‚ğŸ“’

ä»è¥¿ç“œä¹¦ğŸ“–é‡Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°æ­£åˆ™é¡¹çš„ä½œç”¨ï¼Œé‚£å°±æ˜¯é™ä½æ¨¡å‹è¿‡æ‹Ÿåˆçš„é£é™©ï¼Œé€šå¸¸å¸¸ç”¨çš„æœ‰L1èŒƒæ•°æ­£åˆ™åŒ–ä¸L2èŒƒæ•°æ­£åˆ™åŒ–ï¼Œä½œä¸ºå•ç‹¬ä¸€é¡¹ï¼ˆæ­£åˆ™é¡¹ï¼‰åŠ å…¥åˆ°æŸå¤±å‡½æ•°ä¸­ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ä½œä¸ºæŸå¤±å‡½æ•°ã€‚ğŸ

#### ğŸ“– L1 and L2 èŒƒæ•°

åœ¨äº†è§£L1å’ŒL2èŒƒæ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ¥äº†è§£ä¸€ä¸‹èŒƒæ•°ï¼ˆnormï¼‰çš„å®šä¹‰ï¼Œæ ¹æ®å‚è€ƒæ–‡çŒ®[2]çš„è¯´æ˜ï¼š

> A norm is a mathematical thing that is applied to a vector (like the vector `Î²` above). The norm of a vector maps vector values to values in `[0,âˆ)`. In machine learning, norms are useful because they are used to express distances: this vector and this vector are so-and-so far apart, according to this-or-that norm.

ç®€å•æ¥è¯´ä¹Ÿå°±æ˜¯èŒƒæ•°å…¶å®åœ¨ `[0,âˆ)`èŒƒå›´å†…çš„å€¼ï¼Œæ˜¯å‘é‡çš„æŠ•å½±å¤§å°ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ä¸€èˆ¬ä¼šå‹‡äºè¡¡é‡å‘é‡çš„è·ç¦»ã€‚èŒƒæ•°æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬å¸¸è§çš„æœ‰L1-normå’ŒL2-normï¼Œå…¶å®è¿˜æœ‰L3-normã€L4-normç­‰ç­‰ï¼Œæ‰€ä»¥æŠ½è±¡æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬ä¼šå†™ä½œ`Lp-norm`ï¼Œä¸€èˆ¬è¡¨ç¤ºä¸º $||x||_p$ :

$||x||_p = \displaystyle (\sum^{}_{i}{|x_i|^p})^{1/p}$

å¯¹äºä¸Šé¢è¿™ä¸ªæŠ½è±¡çš„å…¬å¼ï¼Œå¦‚æœæˆ‘ä»¬ä»£å…¥på€¼ï¼Œ

è‹¥pä¸º1ï¼Œåˆ™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„L1-normï¼š

$||x||_1 = \displaystyle \sum^{}_{i}{|x_i|} = |x_1|+|x_2|+...+|x_i|$

è‹¥pä¸º2ï¼Œåˆ™æ˜¯æˆ‘ä»¬å¸¸è¯´çš„L2-normï¼š

$||x||_2 = \displaystyle \sqrt{(\sum^{}_{i}{|x_i|^2})} = \displaystyle \sqrt{x1^2+x2^2+...+x_i^2}$

æˆ‘ä»¬å¼•ç”¨æ–‡ç« é‡Œçš„å›¾ç‰‡ï¼ŒL2-normçš„è·ç¦»å°±æ˜¯ä¸¤ä¸ªé»‘ç‚¹ä¹‹é—´çš„ç»¿çº¿ï¼Œè€Œå¦å¤–çš„3æ¡çº¿ï¼Œéƒ½æ˜¯L1-normçš„å¤§å°ã€‚

![image-20200926210610300](./arrests/56.png)


#### âœï¸ L1 and L2æ­£åˆ™é¡¹

åœ¨ä¸Šé¢æˆ‘ä»¬æœ‰æåŠåˆ°ï¼ŒL1ã€L2èŒƒæ•°å¯ä»¥ç”¨äºæŸå¤±å‡½æ•°é‡Œçš„ä¸€ä¸ªæ­£åˆ™åŒ–é¡¹ï¼Œä½œç”¨å°±æ˜¯é™ä½æ¨¡å‹å¤æ‚åº¦ï¼Œå‡å°è¿‡æ‹Ÿåˆçš„é£é™©ã€‚è¿™é‡Œçš„æ­£åˆ™åŒ–é¡¹ï¼Œå­˜åœ¨çš„ç›®çš„å°±æ˜¯ä½œä¸ºä¸€ä¸ªâ€œæƒ©ç½šé¡¹â€ï¼Œå¯¹æŸå¤±å‡½æ•°ä¸­çš„æŸä¸€äº›å‚æ•°åšä¸€äº›é™åˆ¶ï¼Œæ˜¯ç»“æ„é£é™©æœ€å°åŒ–ç­–ç•¥çš„ä½“ç°ï¼Œå°±æ˜¯é€‰æ‹©ç»éªŒé£é™©ï¼ˆå¹³å‡æŸå¤±å‡½æ•°ï¼‰å’Œæ¨¡å‹å¤æ‚åº¦åŒæ—¶è¾ƒå°çš„æ¨¡å‹ã€‚

é’ˆå¯¹çº¿æ€§å›å½’æ¨¡å‹ï¼Œå‡è®¾å¯¹å…¶ä»£ä»·å‡½æ•°é‡ŒåŠ å…¥æ­£åˆ™åŒ–é¡¹ï¼Œå…¶ä¸­L1å’ŒL2æ­£åˆ™åŒ–é¡¹çš„è¡¨ç¤ºåˆ†åˆ«å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­`Î» >= 0`ï¼Œæ˜¯ç”¨æ¥å¹³è¡¡æ­£åˆ™åŒ–é¡¹å’Œç»éªŒé£é™©çš„ç³»æ•°ã€‚

ï¼ˆ1ï¼‰ä½¿ç”¨L1èŒƒæ•°æ­£åˆ™åŒ–ï¼Œå…¶æ¨¡å‹ä¹Ÿè¢«å«ä½œLassoå›å½’ï¼ˆLeast Absolute Shrinkage and Selection Operatorï¼Œæœ€å°ç»å¯¹æ”¶ç¼©é€‰æ‹©ç®—å­ï¼‰ã€‚

ï¼ˆ2ï¼‰ä½¿ç”¨L2èŒƒæ•°æ­£åˆ™åŒ–ï¼Œå…¶æ¨¡å‹è¢«å«åšRidgeå›å½’ï¼Œä¸­æ–‡ä¸ºå²­å›å½’ã€‚

![image-20200926212526709](./arrests/57.png)

#### ğŸš™ æœºå™¨å­¦ä¹ ä¸­ä¸€èˆ¬æ€ä¹ˆé€‰æ‹©æ­£åˆ™é¡¹

ä¸Šé¢ä»‹ç»çš„L1å’ŒL2èŒƒæ•°æ­£åˆ™åŒ–éƒ½æœ‰ç€é™ä½è¿‡æ‹Ÿåˆé£é™©çš„åŠŸèƒ½ï¼Œä½†å®ƒä»¬æœ‰ä»€ä¹ˆä¸åŒï¼Ÿæˆ‘ä»¬åˆ°åº•åº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªå‘¢ï¼Œä¸¤è€…ä¹‹é—´å„æœ‰ä»€ä¹ˆä¼˜åŠ¿å’Œé€‚ç”¨åœºæ™¯ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬ä¸€ä¸€æ¥å±•å¼€è®²è®²ã€‚

##### Q1ï¼šL1å’ŒL2æ­£åˆ™åŒ–é¡¹çš„åŒºåˆ«ï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬ä»ä¸Šé¢é‚£å¼ äºŒç»´çš„å›¾å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºL2-normï¼Œå…¶è§£æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯ç»¿è‰²çš„é‚£æ¡ï¼›è€Œå¯¹äºL1-normï¼Œå…¶è§£ä¸å”¯ä¸€ï¼Œå› æ­¤L1æ­£åˆ™åŒ–é¡¹ï¼Œå…¶è®¡ç®—éš¾åº¦é€šå¸¸ä¼šé«˜äºL2çš„ã€‚

å…¶æ¬¡ï¼Œ**L1é€šå¸¸æ˜¯æ¯”L2æ›´å®¹æ˜“å¾—åˆ°ç¨€ç–è¾“å‡ºçš„**ï¼Œä¼šæŠŠä¸€äº›ä¸é‡è¦çš„ç‰¹å¾ç›´æ¥ç½®é›¶ï¼Œè‡³äºä¸ºä»€ä¹ˆL1æ­£åˆ™åŒ–ä¸ºä»€ä¹ˆæ›´å®¹æ˜“å¾—åˆ°ç¨€ç–è§£ï¼Œå¯ä»¥çœ‹ä¸‹å›¾ï¼š

![image-20200926215608638](./arrests/58.png)

ä¸Šå›¾ä»£è¡¨çš„æ„æ€å°±æ˜¯ç›®æ ‡å‡½æ•°-å¹³æ–¹è¯¯å·®é¡¹çš„ç­‰å€¼çº¿å’ŒL1ã€L2èŒƒæ•°ç­‰å€¼çº¿ï¼ˆå·¦è¾¹æ˜¯L1ï¼‰ï¼Œæˆ‘ä»¬æ­£åˆ™åŒ–åçš„ä»£ä»·å‡½æ•°éœ€è¦æ±‚è§£çš„ç›®æ ‡å°±æ˜¯åœ¨ç»éªŒé£é™©å’Œæ¨¡å‹å¤æ‚åº¦ä¹‹é—´çš„å¹³è¡¡å–èˆï¼Œåœ¨å›¾ä¸­å½¢è±¡åœ°è¡¨ç¤ºå°±æ˜¯é»‘è‰²çº¿ä¸å½©è‰²çº¿çš„äº¤å‰ç‚¹ã€‚
- å¯¹äºL1èŒƒæ•°ï¼Œå…¶å›¾å½¢ä¸ºè±å½¢ï¼ŒäºŒç»´å±æ€§çš„ç­‰å€¼çº¿æœ‰4ä¸ªè§’ï¼ˆé«˜ç»´çš„ä¼šæœ‰æ›´å¤šï¼‰ï¼Œâ€œçªå‡ºæ¥çš„è§’â€æ›´å®¹æ˜“ä¸å¹³æ–¹è¯¯å·®é¡¹è¿›è¡Œäº¤å‰ï¼Œè€Œè¿™äº›â€œçªå‡ºæ¥çš„è§’â€éƒ½æ˜¯åœ¨åæ ‡è½´ä¸Šï¼Œå³W1æˆ–åˆ™W2ä¸º0ï¼›
- å¯¹äºL2èŒƒæ•°ï¼Œäº¤å‰ç‚¹ä¸€èˆ¬éƒ½æ˜¯åœ¨æŸä¸ªè±¡é™ä¸­ï¼Œå¾ˆå°‘æœ‰ç›´æ¥åœ¨åæ ‡è½´ä¸Šäº¤å‰çš„ã€‚

å› æ­¤L1èŒƒæ•°æ­£åˆ™åŒ–é¡¹æ¯”L2çš„æ›´å®¹æ˜“å¾—åˆ°ç¨€ç–è§£ã€‚


##### Q2ï¼šå„æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Œå¦‚ä½•ä½œé€‰æ‹©ï¼Ÿ

ç›´æ¥ä¸Šç»“è®ºï¼š
- 1ï¼‰å› ä¸ºL1èŒƒæ•°æ­£åˆ™åŒ–é¡¹çš„â€œç¨€ç–è§£â€ç‰¹æ€§ï¼ŒL1æ›´é€‚åˆç”¨äºç‰¹å¾é€‰æ‹©ï¼Œæ‰¾å‡ºè¾ƒä¸ºâ€œå…³é”®â€çš„ç‰¹å¾ï¼Œè€ŒæŠŠä¸€äº›ä¸é‚£ä¹ˆé‡è¦çš„ç‰¹å¾ç½®ä¸ºé›¶ã€‚
- 2ï¼‰L2èŒƒæ•°æ­£åˆ™åŒ–é¡¹å¯ä»¥äº§ç”Ÿå¾ˆå¤šå‚æ•°å€¼å¾ˆå°çš„æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç±»çš„æ¨¡å‹æŠ—å¹²æ‰°çš„èƒ½åŠ›å¾ˆå¼ºï¼Œå¯ä»¥é€‚åº”ä¸åŒçš„æ•°æ®é›†ï¼Œé€‚åº”ä¸åŒçš„â€œæç«¯æ¡ä»¶â€ã€‚


#### ğŸ¤” å¦‚ä½•ä½œä¸ºLoss Function

è®²å®Œäº†ä½œä¸ºæ­£åˆ™åŒ–é¡¹çš„å†…å®¹äº†ï¼Œé‚£ä¹ˆè®²è®²L1ã€L2èŒƒæ•°ä½œä¸ºæŸå¤±å‡½æ•°çš„æƒ…å†µã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªçº¿æ€§å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°æ¨¡å‹çš„æ•ˆæœï¼Œå¾ˆå¸¸è§„çš„ï¼Œæˆ‘ä»¬ä¼šç”¨â€œè·ç¦»â€æ¥è¡¡é‡è¯¯å·®ï¼

è‹¥ä½¿ç”¨L1-normæ¥è¡¡é‡è·ç¦»ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„LADï¼ˆLeast Absolute Deviationï¼Œæœ€å°ç»å¯¹åå·®ï¼‰ï¼Œå…¶ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š

$S = \displaystyle \sum^{n}_{i=1}{|y_i-f(x_i)|}$

å®é™…æ„ä¹‰ä¸Šçš„è§£é‡Šå°±æ˜¯é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„ç»å¯¹å€¼ã€‚

è‹¥ä½¿ç”¨L2-normï¼Œé‚£å°±æ˜¯æˆ‘ä»¬çš„LSEï¼ˆLeast Squares Errorï¼Œæœ€å°äºŒä¹˜è¯¯å·®ï¼‰ï¼Œå…¶ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š

$S = \displaystyle \sum^{n}_{i=1}{(y_i-f(x_i))^2}$

é’ˆå¯¹ä¸¤è€…çš„å·®å¼‚ï¼Œå¯ä»¥çœ‹ä¸‹è¡¨ï¼š

![image-20200926222805570](./arrests/59.png)

L1æŸå¤±å‡½æ•°çš„ç»“æœæ›´å…·é²æ£’æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºå¼‚å¸¸å€¼æ›´åŠ ä¸æ•æ„Ÿã€‚è€Œæ ¹æ®å…¶èŒƒæ•°â€œå¤©æ€§â€ï¼ŒL2çš„æ±‚è§£æ›´ä¸ºç®€å•ä¸â€œå”¯ä¸€â€ã€‚

#### ğŸ“– Reference

[1] Differences between L1 and L2 as Loss Function and Regularization

http://www.chioka.in/differences-between-l1-and-l2-as-loss-function-and-regularization/

[2] L1 Norms versus L2 Norms

https://www.kaggle.com/residentmario/l1-norms-versus-l2-norms


<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>


## Tip27ï¼šé‡‘èé£æ§é‡Œçš„WOEå‰çš„åˆ†ç®±ä¸€å®šè¦å•è°ƒå—

#### ğŸš— Index

* âœï¸ èƒŒæ™¯äº¤ä»£
* ğŸ¥ WOEå›é¡¾
* ğŸ¤” LRæ¨¡å‹çš„å…¥å‚ä¸€å®šè¦WOEå—ï¼Ÿ
* ğŸ¤” WOEä¸å•è°ƒå¯ä»¥è¿›LRæ¨¡å‹å—ï¼Ÿ
  * é’ˆå¯¹ä¸åŒç±»å‹çš„å˜é‡
  * ä¸ºä»€ä¹ˆéœ€è¦WOEå…·å¤‡å•è°ƒæ€§
* ğŸ† ç»“è®ºå¤ç›˜

ä»Šå¤©æˆ‘ä»¬æ¥è®²è®²ä¸€ä¸ªé‡‘èé£æ§é‡Œçš„â€œå¸¸è¯†ç‚¹â€ï¼Œå°±æ˜¯é‚£ç§æˆ‘ä»¬ä¹ ä»¥ä¸ºå¸¸ä½†è‹¥è¦è®²å‡ºä¸ªæ‰€ä»¥ç„¶æ¥æ¯”è¾ƒå›°éš¾çš„ç‚¹ï¼Œæ­£å¦‚æ ‡é¢˜æ‰€è¨€ï¼š**WOEå‰çš„åˆ†ç®±ä¸€å®šè¦å•è°ƒå—ï¼Ÿ**ğŸ¤”

#### âœï¸ èƒŒæ™¯äº¤ä»£

ç›¸ä¿¡æ¯ä¸€ä¸ªåœ¨é‡‘èé£æ§é¢†åŸŸåšè¿‡æ¨¡å‹çš„äººï¼Œåº”è¯¥å¯¹åˆ†ç®±æ»¡è¶³badrateå•è°ƒæ€§æœ‰ä¸€å®šçš„è®¤çŸ¥ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”¨é€»è¾‘å›å½’åšAå¡çš„æ—¶å€™ï¼Œè€å¸æœºä»¬ä¼šç»å¸¸å¯¹æˆ‘ä»¬è¯´å˜é‡è¦æ»¡è¶³å•è°ƒæ€§ï¼Œå½“å˜é‡å•è°ƒäº†ï¼Œå†è¿›è¡ŒWOEè½¬æ¢ï¼Œç„¶åä½œä¸ºLRçš„å…¥å‚å–‚ç»™æ¨¡å‹ï¼Œç®€å•è®­ç»ƒä¸€ä¸‹å°±æ”¶å·¥ã€‚ä½†ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„é£æ§å»ºæ¨¡å¤§å¸ˆï¼Œä»…ä»…çŸ¥é“è¿™äº›å¥—è·¯è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥å»æ€è€ƒä¸€ä¸‹å½“ä¸­çš„åŸç†ï¼Œæˆ–è€…è¯´æ˜¯æ›´è¿›ä¸€æ­¥å»è¿½é—®ä¸€ä¸‹è‡ªå·±ï¼š

> LRæ¨¡å‹çš„å…¥å‚ä¸€å®šè¦WOEå—ï¼Ÿ
>
> WOEè½¬åŒ–å‰çš„å˜é‡åˆ†ç®±ç»“æœçš„badrateä¸€å®šéœ€è¦æ»¡è¶³å•è°ƒæ€§å—ï¼Ÿ
>
> è¿ç»­å˜é‡éš¾é“å°±ä¸å¯ä»¥ç›´æ¥è¿›LRæ¨¡å‹å—ï¼Ÿ


#### ğŸ¥ WOEå›é¡¾

åœ¨æˆ‘ä»¬å¼€å§‹æ‹†è§£é—®é¢˜å‰ï¼Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹éœ€è¦å›é¡¾ä¸€ä¸‹ï¼Œé‚£å°±æ˜¯WOEã€‚

> WOEæ˜¯weight of evidenceçš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§ç¼–ç å½¢å¼ï¼Œé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“WOEæ˜¯é’ˆå¯¹ç±»åˆ«å˜é‡è€Œè¨€çš„ï¼Œæ‰€ä»¥è¿ç»­æ€§å˜é‡éœ€è¦æå‰åšå¥½åˆ†ç»„ï¼ˆè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è€ƒç‚¹ï¼Œä¹Ÿæœ‰ä¼šè¯´åˆ†ç®±ã€ç¦»æ•£åŒ–çš„ï¼Œå˜é‡ä¼˜åŒ–ä¹Ÿå¯ä»¥ä»è¿™ä¸ªè§’åº¦å‡ºå‘ï¼‰ã€‚

å…ˆç»™å‡ºæ•°å­¦è®¡ç®—å…¬å¼ï¼Œå¯¹äºç¬¬iç»„çš„WOEå¯ä»¥è¿™ä¹ˆè®¡ç®—ï¼š

$$WOE_i = ln(\frac{y_i/y_{all}}{n_i/n_{all}})$$

ä»å…¬å¼ä¸Šå¯ä»¥çœ‹å‡ºï¼Œç¬¬iç»„çš„WOEå€¼ç­‰äºè¿™ä¸ªç»„çš„å“åº”å®¢æˆ·å æ‰€æœ‰å“åº”å®¢æˆ·çš„æ¯”ä¾‹ä¸æœªå“åº”å®¢æˆ·å æ‰€æœ‰æœªå“åº”å®¢æˆ·çš„æ¯”ä¾‹çš„æ¯”å€¼å–å¯¹æ•°ã€‚å¯¹äºä¸Šé¢çš„å…¬å¼æˆ‘ä»¬è¿˜å¯ä»¥ ç®€å•åšä¸€ä¸‹è½¬åŒ–ï¼š

$$WOE_i = ln(\frac{y_i/y_{all}}{n_i/n_{all}}) = ln(\frac{y_i/n_i}{y_{all}/n_{all}})$$

æ‰€ä»¥ï¼ŒWOEä¸»è¦å°±æ˜¯ä½“ç°ç»„å†…çš„å¥½åå æ¯”ä¸æ•´ä½“çš„å·®å¼‚åŒ–ç¨‹åº¦å¤§å°ï¼ŒWOEè¶Šå¤§ï¼Œå·®å¼‚è¶Šå¤§ã€‚

æ›´å¤šçš„å†…å®¹å¯ä»¥æµè§ˆä¸€ä¸‹ä¹‹å‰çš„æ–‡ç« ã€Šç‰¹å¾é”¦å›Šï¼šå½»åº•äº†è§£ä¸€ä¸‹WOEå’ŒIVã€‹ã€‚



#### ğŸ¤” LRæ¨¡å‹çš„å…¥å‚ä¸€å®šè¦WOEå—ï¼Ÿ

The answer is noï¼å¹¶éæ‰€æœ‰LRçš„å…¥å‚éƒ½éœ€è¦WOEçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›´æ¥åŸå§‹å€¼å…¥æ¨¡å‹çš„ã€‚ä½†å­˜åœ¨å³åˆç†ï¼Œä¸ºä»€ä¹ˆå¤§å®¶éƒ½åœ¨è¯´è¦å¯¹å˜é‡è¿›è¡ŒWOEç¼–ç å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¼•å‡ºä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼š

* ä»€ä¹ˆæƒ…å†µä¸‹ç”¨WOEæ¯”è¾ƒåˆé€‚ï¼Ÿ
* ä»¥åŠç”¨WOEæœ‰ä»€ä¹ˆå¥½å¤„

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨é£æ§é¢†åŸŸçš„å˜é‡å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼Œå°±æ˜¯æ•°å€¼å‹å˜é‡ä»¥åŠç±»åˆ«å‹å˜é‡ï¼Œå‰è€…å°±æ˜¯ç±»ä¼¼äºå¹´é¾„ã€é€¾æœŸå¤©æ•°ç­‰ï¼Œåè€…å°±æ˜¯èŒä¸šç±»åˆ«ã€è¡Œä¸šç±»åˆ«ç­‰ã€‚

é’ˆå¯¹ç±»åˆ«å‹å˜é‡ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¯ä»¥æƒ³åˆ°ä½¿ç”¨one-hotç¼–ç æ¥ï¼Œä½†æ˜¯è¿™ç§ç¼–ç æ–¹å¼æœ‰ä¸€å®šçš„ç¼ºé™·ï¼Œé‚£å°±æ˜¯å¯¹äºæšä¸¾å€¼ç‰¹åˆ«å¤šçš„å˜é‡ï¼Œç‹¬çƒ­ç¼–ç ä¹‹åååˆ†ç¨€ç–ä»è€Œç‰¹å¾ç©ºé—´å¾ˆå¤§ï¼Œå¦å¤–å¦‚æœä¸¢å¼ƒä¸€éƒ¨åˆ†ç»´åº¦åˆ™ä¼šé€ æˆä¿¡æ¯ä¸¢å¤±ï¼ŒæŒ‡ä¸å®šè¿™äº›æ˜¯å…³é”®çš„ä¿¡æ¯ã€‚ä»¥ä¸Šçš„ä¿¡æ¯è¯´æ˜äº†æ”¾å…¥LRä¸­å¾ˆéš¾æœ‰å¾ˆå¥½çš„æ•ˆæœã€‚

è€Œé’ˆå¯¹æ•°å€¼å‹å˜é‡ï¼Œå¾ˆå¤šåŒå­¦åˆ™ä¼šæœ‰æ›´å¤§çš„ç–‘é—®ï¼Œé‚£å°±æ˜¯ä¸ºä»€ä¹ˆè¦åˆ†ç®±ç„¶ååˆè¿›è¡ŒWOEè½¬æ¢è¿™ä¹ˆéº»çƒ¦ï¼Œåæ­£éƒ½å¯ä»¥ç›´æ¥å…¥æ¨¡å‹çš„ï¼Œä½•å¿…å¤šæ­¤ä¸€ä¸¾ï¼Ÿ

å½“ç„¶äº†ï¼è¿™ä¸ªæƒ³æ³•ä¹Ÿæ˜¯æ²¡é”™çš„ï¼Œåœ¨æœ¬å°èŠ‚å¼€å¤´ä¹Ÿå·²ç»è¯´æ˜äº†ï¼Œå¹¶éè¦æ±‚æ‰€æœ‰çš„å˜é‡éƒ½è¦è¿›è¡ŒWOEç¼–ç ç„¶åè¿›å…¥æ¨¡å‹ã€‚**è€Œä»€ä¹ˆæƒ…å†µä¸‹ååˆ†é€‚åˆWOEè½¬æ¢å‘¢ï¼Œé‚£å°±æ˜¯å˜é‡æœ¬èº«ä¸yå€¼å¹¶éå­˜åœ¨ç›´æ¥çº¿æ€§å…³ç³»çš„æ—¶å€™ã€‚**

![image-20201018152118144](./arrests/60.png)

æˆ‘ä»¬çœ‹ä¸Šé¢çš„å›¾ï¼Œâ€œå¹´é¾„â€è¿™ä¸ªå­—æ®µç»å¸¸æ€§åœ°ä¼šå‡ºç°åœ¨æˆ‘ä»¬çš„Aå¡æ¨¡å‹é‡Œï¼Œä½œä¸ºé¢„æµ‹ä¸€ä¸ªå®¢æˆ·ä¿¡ç”¨æ°´å¹³çš„è¡¡é‡æŒ‡æ ‡ã€‚æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçŸ¥é“ï¼Œageè¿™ä¸ªå˜é‡çš„badrateåˆ†å¸ƒï¼Œç»å¸¸æ€§ä¼šå‘ˆç°â€œUå‹â€ï¼Œä¸šåŠ¡è§£é‡Šå°±æ˜¯ï¼šå¹´è½»äººå’Œè€å¹´äººçš„è¿˜æ¬¾èƒ½åŠ›ä¼šæ¯”ä¸­å¹´äººçš„è¦ä½ï¼Œé£é™©ä¹Ÿå› æ­¤æ›´é«˜ã€‚ä»ç»Ÿè®¡è§’åº¦çœ‹ï¼Œå¹´é¾„ä¸è¿çº¦ç‡ï¼Œä¾¿ä¸æ˜¯ä¸€ä¸ªçº¿æ€§å…³ç³»ï¼

æˆ‘ä»¬å›å¿†ä¸€ä¸‹LRæ¨¡å‹ï¼ˆLogistic Regressionï¼‰ï¼Œä»æœ¬è´¨ä¸Šè®²ï¼ŒLRå°±æ˜¯ç»è¿‡å¯¹è®­ç»ƒé›†çš„å­¦ä¹ ï¼Œå¾—åˆ°ä¸€ç»„æƒå€¼wï¼Œå½“æœ‰æ–°çš„ä¸€ç»„æ•°æ®xè¾“å…¥æ—¶ï¼Œæ ¹æ®å…¬å¼è®¡ç®—å‡ºç»“æœï¼Œç„¶åç»è¿‡Sigmoidå‡½æ•°åˆ¤æ–­è¿™ä¸ªæ•°æ®æ‰€å±çš„ç±»åˆ«ã€‚

$$h_w(x) = w_0+w_1x_1+w_2x_2+...+w_nx_n$$

å‡å¦‚æˆ‘ä»¬çš„å¹´é¾„å°±æ˜¯ä¸Šé¢çš„x1ï¼Œå¹¶ä¸”æ¨¡å‹åªæœ‰ä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆéšç€x1çš„å˜å¤§ï¼Œ$h_w(x)$çš„å€¼ä¹Ÿä¼šä¸æ–­å˜å¤§ï¼Œè€Œä¸æ˜¯åƒä¸Šå›¾ä¸€æ ·å‘ˆç°â€œUå‹â€ï¼Œè¯´æ˜äº†è¿™æ˜¯ä¸€ä¸ªéçº¿æ€§çš„é—®é¢˜ï¼Œä½†å¦‚æœæˆ‘ä»¬å¯¹å¹´é¾„è¿›è¡ŒWOEè½¬æ¢ï¼Œå°±å¯ä»¥çœ‹åˆ°å¦‚å³å›¾æ‰€ç¤ºçš„é‚£æ ·ï¼Œéšç€WOEçš„å¢å¤§ï¼Œgoodrateä¹Ÿå¢å¤§è¿™ç§çº¿æ€§å…³ç³»ï¼ˆbadrate=1-goodrateï¼Œå› æ­¤å’Œbadrateä¹Ÿæ˜¯çº¿å½¢å…³ç³»ï¼‰ã€‚

ä»¥ä¸Šä¹Ÿæ˜¯ä½¿ç”¨WOEç¼–ç çš„ä¸€ä¸ªæœ€å¤§å¥½å¤„ï¼Œä¹Ÿå°±æ˜¯æŠŠbadrateå‘ˆç°éçº¿æ€§çš„å˜é‡è½¬æ¢ä¸ºçº¿å½¢ï¼Œä¾¿äºç†è§£ä¹Ÿä¾¿äºåç»­æ¨¡å‹æ±‚è§£ã€‚æ­¤å¤–ï¼ŒWOEç¼–ç è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œé‚£å°±æ˜¯å…·æœ‰â€œå®¹é”™æ€§â€ï¼Œå› ä¸ºWOEç¼–ç å…¶å®ä¹Ÿå¯ä»¥ç†è§£ä¸ºéœ€è¦é¢„å…ˆåˆ†ç®±ï¼Œé‚£ä¹ˆå¯¹äºå¼‚å¸¸å€¼æ²¡é‚£ä¹ˆæ•æ„Ÿï¼Œå¯¹äºå•ä¸ªå˜é‡çš„å¼‚å¸¸æ³¢åŠ¨ä¸ä¼šæœ‰å¤ªå¤§ååº”ã€‚



#### ğŸ¤” WOEä¸å•è°ƒå¯ä»¥è¿›LRæ¨¡å‹å—ï¼Ÿ

é‚£ä¹ˆæˆ‘ä»¬å›åˆ°æœ€åˆçš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æ ‡é¢˜æ‰€è¯´çš„ï¼šWOEå‰çš„åˆ†ç®±ä¸€å®šè¦å•è°ƒå—ï¼Ÿç»“è®ºæ˜¯ä¸ä¸€å®šéœ€è¦å•è°ƒã€‚è¦æ·±å…¥äº†è§£è¿™ç­”æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸‹é¢ä¸¤ä¸ªè®¨è®ºï¼š

##### 01 é’ˆå¯¹ä¸åŒç±»å‹çš„å˜é‡

1ï¼‰é’ˆå¯¹ç±»åˆ«å˜é‡ğŸ˜‹

ç±»åˆ«å˜é‡å¯ä»¥åˆ†æœ‰åºå’Œæ— åºå˜é‡ã€‚

é’ˆå¯¹æœ‰åºç±»åˆ«å˜é‡ï¼Œæ¯”å¦‚åƒå­¦å†ï¼Œæˆ‘ä»¬åˆ†ç®±çš„æ—¶å€™è¦ä¿è¯åŸå§‹é¡ºåºçš„å‰æä¸‹ï¼Œè¿›è¡Œä¸åŒåŸå§‹ç»„åˆ«çš„åˆå¹¶ï¼Œå®Œæˆåˆ†ç®±ï¼Œç„¶åéœ€è¦çœ‹åˆ†ç®±çš„badrateå•è°ƒæ€§ï¼Œæœ€åæ‰æ¥çœ‹WOEå•è°ƒæ€§æƒ…å†µã€‚

é’ˆå¯¹æ— åºç±»åˆ«å˜é‡ï¼Œæ— åºç±»åˆ«å˜é‡åˆå¯ä»¥æ ¹æ®æšä¸¾å€¼çš„å¤šå°‘æ‹†åˆ†ä¸ºä¸¤ç±»ï¼šå¤šæšä¸¾æ— åºç±»åˆ«å˜é‡å’Œå°‘æšä¸¾æ— åºç±»åˆ«å˜é‡ã€‚æ— è®ºæ˜¯å“ªä¸€ç§ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æ ¹æ®å¯¹æ¯ä¸ªæšä¸¾å€¼çš„badrateç»Ÿè®¡å¾—åˆ°å…¶é‡åŒ–æŒ‡æ ‡ï¼Œç„¶åæ ¹æ®badrateè¿›è¡Œé€‚å½“çš„ç±»åˆ«åˆå¹¶ï¼Œå®Œæˆåˆ†ç®±æ“ä½œï¼Œè¿™æ—¶å€™çš„åˆ†ç®±ç»“æœï¼Œå¤©ç„¶å•è°ƒï¼è€Œé’ˆå¯¹å°‘æšä¸¾æ— åºç±»åˆ«å˜é‡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®ä¸šåŠ¡è®¤è¯†ï¼Œè¿›è¡Œç±»åˆ«çš„åˆå¹¶ï¼Œæ¯”å¦‚åƒä¸­å›½å¤§åŒºå­—æ®µï¼ˆåå—ã€ååŒ—ç­‰ï¼‰ï¼ŒWOEç¼–ç åï¼Œä¹Ÿä¸åšä¸¥æ ¼çš„å•è°ƒæ€§è¦æ±‚ã€‚

2ï¼‰é’ˆå¯¹æ•°å€¼å˜é‡ğŸ˜†

è¿›è¡Œåˆé€‚çš„åˆ†ç®±ç®—æ³•è¿›è¡Œåˆ†ç®±åçš„binï¼Œéœ€è¦æ»¡è¶³badrateå•è°ƒæ€§ï¼Œç„¶åæ‰è¿›è¡ŒWOEç¼–ç ã€‚ä¸è¿‡å‘¢ï¼Œè¿™ä¸ªä¹Ÿä¸æ˜¯ä¸¥æ ¼è¦æ±‚çš„ã€‚

##### 02 ä¸ºä»€ä¹ˆéœ€è¦WOEå…·å¤‡å•è°ƒæ€§

WOEä¸ä¸€å®šéƒ½éœ€è¦æ˜¯å•è°ƒçš„ï¼Œåªè¦ä»ä¸šåŠ¡è§’åº¦å¯ä»¥è§£é‡Šå¾—é€šï¼Œé‚£å°±æ²¡æœ‰é—®é¢˜ï¼å°±å¥½åƒä¸Šé¢çš„é‚£ä¸ªæ —å­ï¼Œå¹´é¾„å­—æ®µï¼ŒWOEå°±ä¸æ˜¯å•è°ƒçš„ï¼Œä½†ä»ä¸šåŠ¡ä¸Šå¯ä»¥è§£é‡Šå¾—é€šï¼Œé‚£å°±æ²¡æœ‰é—®é¢˜ï¼

å¦‚æœä»ä¸šåŠ¡ä¸Šè§£é‡Šæ˜¯éœ€è¦å•è°ƒæ€§ï¼Œä½†åˆ†ç»„åçš„WOEå¹¶æ²¡æœ‰å•è°ƒï¼Œé‚£ä¹ˆè¿™æ—¶å€™æœ‰ä¸¤æ¡è·¯å¯ä»¥é€‰æ‹©ï¼Œä¸€æ˜¯é‡æ–°åˆ†ç»„ç„¶åé‡æ–°è®¡ç®—WOEï¼ŒäºŒæ˜¯æ”¾å¼ƒè¿™ä¸ªå˜é‡ã€‚

æœ€åæä¸€ä¸‹ï¼Œå¦‚æœä¸å•è°ƒçš„å˜é‡ä¸è¿›è¡ŒWOEç¼–ç ç›´æ¥è¿›å…¥LRæ¨¡å‹ï¼Œä¸€èˆ¬éƒ½æ˜¯å¾ˆéš¾æ±‚è§£çš„ï¼Œå› ä¸ºå¾ˆéš¾æ‰¾åˆ°ä¸€ä¸ªçº¿æ€§å…¬å¼æ¥æè¿°å…³ç³»ã€‚



#### ğŸ† ç»“è®ºå¤ç›˜

1ï¼‰LRæ¨¡å‹çš„å…¥å‚ä¸ä¸€å®šéƒ½è¦WOEè½¬æ¢ï¼Œç›´æ¥è¿›è¡Œæ¨¡å‹ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªæ˜¯é‡ä¸Šä¸å•è°ƒçš„å˜é‡ä¼šæ¯”è¾ƒéš¾æ±‚è§£ç½¢äº†ï¼Œå¯é€‰æ‹©ä¸¢å¼ƒã€‚

2ï¼‰ä½¿ç”¨WOEç¼–ç çš„ä¸€ä¸ªæœ€å¤§å¥½å¤„æ˜¯æŠŠbadrateå‘ˆç°éçº¿æ€§çš„å˜é‡è½¬æ¢ä¸ºçº¿å½¢ï¼Œä¾¿äºç†è§£ä¹Ÿä¾¿äºåç»­æ¨¡å‹æ±‚è§£ï¼Œè¿›è¡Œäº†WOEç¼–ç çš„æ¨¡å‹å¯¹äºå¼‚å¸¸å€¼æ²¡é‚£ä¹ˆæ•æ„Ÿï¼Œå•ä¸ªå˜é‡çš„å¼‚å¸¸æ³¢åŠ¨ä¸ä¼šå¯¹æ¨¡å‹é€ æˆå¾ˆå¤§ååº”ã€‚

3ï¼‰WOEå¹¶ä¸ä¸€å®šéƒ½éœ€è¦æ˜¯å•è°ƒçš„ï¼Œåªè¦ä»ä¸šåŠ¡è§’åº¦å¯ä»¥è§£é‡Šå¾—é€šå³å¯ã€‚

<a href="#ç›®å½•Keep-updating">ğŸ˜‹ ç‚¹æˆ‘å¯ä»¥å›åˆ°ç›®å½•å“¦ ğŸš—</a>

## Tip28ï¼šå¦‚ä½•åœ¨Pythonä¸­å¤„ç†ä¸å¹³è¡¡æ•°æ®

#### ğŸš™ Index

- 1ã€åˆ°åº•ä»€ä¹ˆæ˜¯ä¸å¹³è¡¡æ•°æ®
- 2ã€å¤„ç†ä¸å¹³è¡¡æ•°æ®çš„ç†è®ºæ–¹æ³•
- 3ã€Pythoné‡Œæœ‰ä»€ä¹ˆåŒ…å¯ä»¥å¤„ç†ä¸å¹³è¡¡æ ·æœ¬
- 4ã€Pythonä¸­å…·ä½“å¦‚ä½•å¤„ç†å¤±è¡¡æ ·æœ¬

å°è±¡ä¸­å¾ˆä¹…ä¹‹å‰æœ‰ä½æœ‹å‹è¯´è¦æˆ‘å†™ä¸€ç¯‡å¦‚ä½•å¤„ç†ä¸å¹³è¡¡æ•°æ®çš„æ–‡ç« ï¼Œæ•´ç†ç›¸å…³çš„ç†è®ºä¸å®è·µçŸ¥è¯†ï¼ˆå¯æƒœæœ¬äººå¤ªæ‡’äº†ï¼Œç°åœ¨æ‰å¼€å§‹å†™ï¼‰ï¼Œäºæ˜¯ä¹æœ‰äº†ä»Šå¤©çš„æ–‡ç« ã€‚å¤±è¡¡æ ·æœ¬åœ¨æˆ‘ä»¬çœŸå®ä¸–ç•Œä¸­æ˜¯ååˆ†å¸¸è§çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰ä¸­ä½¿ç”¨è¿™äº›å¤±è¡¡æ ·æœ¬æ•°æ®ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå¦‚ä½•å¤„ç†è¿™äº›å¤±è¡¡æ ·æœ¬å‘¢ï¼Ÿä»¥ä¸‹çš„å†…å®¹å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼

#### ğŸ¤” åˆ°åº•ä»€ä¹ˆæ˜¯ä¸å¹³è¡¡æ•°æ®

å¤±è¡¡æ•°æ®å‘ç”Ÿåœ¨åˆ†ç±»åº”ç”¨åœºæ™¯ä¸­ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œç±»åˆ«ä¹‹é—´çš„åˆ†å¸ƒä¸å‡åŒ€å°±æ˜¯å¤±è¡¡çš„æ ¹æœ¬ï¼Œå‡è®¾æœ‰ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œtargetä¸ºyï¼Œé‚£ä¹ˆyçš„å–å€¼èŒƒå›´ä¸º0å’Œ1ï¼Œå½“å…¶ä¸­ä¸€æ–¹ï¼ˆæ¯”å¦‚y=1ï¼‰çš„å æ¯”è¿œå°äºå¦ä¸€æ–¹ï¼ˆy=0ï¼‰çš„æ—¶å€™ï¼Œå°±æ˜¯å¤±è¡¡æ ·æœ¬äº†ã€‚

é‚£ä¹ˆåˆ°åº•æ˜¯éœ€è¦å·®å¼‚å¤šå°‘ï¼Œæ‰ç®—æ˜¯å¤±è¡¡å‘¢ï¼Œæ ¹æœ¬Google Developerçš„è¯´æ³•ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥æŠŠå¤±è¡¡åˆ†ä¸º3ä¸ªç¨‹åº¦ï¼š

* è½»åº¦ï¼š20-40%
* ä¸­åº¦ï¼š1-20%
* æåº¦ï¼š<1%

ä¸€èˆ¬æ¥è¯´ï¼Œå¤±è¡¡æ ·æœ¬åœ¨æˆ‘ä»¬æ„å»ºæ¨¡å‹çš„æ—¶å€™çœ‹ä¸å‡ºä»€ä¹ˆé—®é¢˜ï¼Œè€Œä¸”å¾€å¾€æˆ‘ä»¬è¿˜å¯ä»¥å¾—åˆ°å¾ˆé«˜çš„accuracyï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæåº¦å¤±è¡¡çš„æ ·æœ¬ï¼Œy=1çš„å æ¯”ä¸º1%ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹ï¼Œä¼šåå‘äºæŠŠæµ‹è¯•é›†é¢„æµ‹ä¸º0ï¼Œè¿™æ ·å­æ¨¡å‹æ•´ä½“çš„é¢„æµ‹å‡†ç¡®æ€§å°±ä¼šæœ‰ä¸€ä¸ªå¾ˆå¥½çœ‹çš„æ•°å­—ï¼Œå¦‚æœæˆ‘ä»¬åªæ˜¯å…³æ³¨è¿™ä¸ªæŒ‡æ ‡çš„è¯ï¼Œå¯èƒ½å°±ä¼šè¢«éª—äº†ã€‚

#### ğŸ“– å¤„ç†ä¸å¹³è¡¡æ•°æ®çš„ç†è®ºæ–¹æ³•

åœ¨æˆ‘ä»¬å¼€å§‹ç”¨Pythonå¤„ç†å¤±è¡¡æ ·æœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€æ³¢å…³äºå¤„ç†å¤±è¡¡æ ·æœ¬çš„ä¸€äº›ç†è®ºçŸ¥è¯†ï¼Œå‰è¾ˆä»¬å…³äºè¿™ç±»é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ï¼š

* ä»æ•°æ®è§’åº¦ï¼šé€šè¿‡åº”ç”¨ä¸€äº›æ¬ é‡‡æ ·orè¿‡é‡‡æ ·æŠ€æœ¯æ¥å¤„ç†å¤±è¡¡æ ·æœ¬ã€‚æ¬ é‡‡æ ·å°±æ˜¯å¯¹å¤šæ•°ç±»è¿›è¡ŒæŠ½æ ·ï¼Œä¿ç•™å°‘æ•°ç±»çš„å…¨é‡ï¼Œä½¿å¾—ä¸¤ç±»çš„æ•°é‡ç›¸å½“ï¼Œè¿‡é‡‡æ ·å°±æ˜¯å¯¹å°‘æ•°ç±»è¿›è¡Œå¤šæ¬¡é‡å¤é‡‡æ ·ï¼Œä¿ç•™å¤šæ•°ç±»çš„å…¨é‡ï¼Œä½¿å¾—ä¸¤ç±»çš„æ•°é‡ç›¸å½“ã€‚ä½†æ˜¯ï¼Œè¿™ç±»åšæ³•ä¹Ÿæœ‰å¼Šç«¯ï¼Œæ¬ é‡‡æ ·ä¼šå¯¼è‡´æˆ‘ä»¬ä¸¢å¤±ä¸€éƒ¨åˆ†çš„ä¿¡æ¯ï¼Œå¯èƒ½åŒ…å«äº†ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼Œè¿‡é‡‡æ ·åˆ™ä¼šå¯¼è‡´åˆ†ç±»å™¨å®¹æ˜“è¿‡æ‹Ÿåˆã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸¤ç§æŠ€æœ¯çš„ç›¸äº’ç»“åˆã€‚
* ä»ç®—æ³•è§’åº¦ï¼šç®—æ³•è§’åº¦çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å¯ä»¥é€šè¿‡å¯¹æ¯ç±»çš„è®­ç»ƒå®ä¾‹ç»™äºˆä¸€å®šæƒå€¼çš„è°ƒæ•´ã€‚æ¯”å¦‚åƒåœ¨SVMè¿™æ ·å­çš„æœ‰å‚åˆ†ç±»å™¨ä¸­ï¼Œå¯ä»¥åº”ç”¨grid searchï¼ˆç½‘æ ¼æœç´¢ï¼‰ä»¥åŠäº¤å‰éªŒè¯ï¼ˆcross validationï¼‰æ¥ä¼˜åŒ–Cä»¥åŠgammaå€¼ã€‚è€Œå¯¹äºå†³ç­–æ ‘è¿™ç±»çš„éå‚æ•°æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´æ ‘å¶èŠ‚ç‚¹ä¸Šçš„æ¦‚ç‡ä¼°è®¡ä»è€Œå®ç°æ•ˆæœä¼˜åŒ–ã€‚

æ­¤å¤–ï¼Œä¹Ÿæœ‰ç ”ç©¶å‘˜ä»æ•°æ®ä»¥åŠç®—æ³•çš„ç»“åˆè§’åº¦æ¥çœ‹å¾…è¿™ç±»é—®é¢˜ï¼Œæå‡ºäº†ä¸¤è€…ç»“åˆä½“çš„AdaOUBoostï¼ˆadaptive over-sampling and undersampling boostï¼‰ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•çš„æ–°é¢–ä¹‹å¤„åœ¨äºè‡ªé€‚åº”åœ°å¯¹å°‘æ•°ç±»æ ·æœ¬è¿›è¡Œè¿‡é‡‡æ ·ï¼Œç„¶åå¯¹å¤šæ•°ç±»æ ·æœ¬è¿›è¡Œæ¬ é‡‡æ ·ï¼Œä»¥å½¢æˆä¸åŒçš„åˆ†ç±»å™¨ï¼Œå¹¶æ ¹æ®å…¶å‡†ç¡®åº¦å°†è¿™äº›å­åˆ†ç±»å™¨ç»„åˆåœ¨ä¸€èµ·ä»è€Œå½¢æˆå¼ºå¤§çš„åˆ†ç±»å™¨ï¼Œæ›´å¤šçš„è¯·å‚è€ƒï¼š

> AdaOUBoostï¼šhttps://dl.acm.org/doi/10.1145/1743384.1743408

#### ğŸš€ Pythoné‡Œæœ‰ä»€ä¹ˆåŒ…å¯ä»¥å¤„ç†ä¸å¹³è¡¡æ ·æœ¬

è¿™é‡Œä»‹ç»ä¸€ä¸ªå¾ˆä¸é”™çš„åŒ…ï¼Œå« **imbalanced-learn**ï¼Œå¤§å®¶å¯ä»¥åœ¨ç”µè„‘ä¸Šå®‰è£…ä¸€ä¸‹ä½¿ç”¨ã€‚

> å®˜æ–¹æ–‡æ¡£ï¼šhttps://imbalanced-learn.readthedocs.io/en/stable/index.html

```shell
pip install -U imbalanced-learn
```

![image-20201114201826826](./arrests/61.png)

ä½¿ç”¨ä¸Šé¢çš„åŒ…ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°æ ·æœ¬çš„æ¬ é‡‡æ ·ã€è¿‡é‡‡æ ·ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨pipelineçš„æ–¹å¼æ¥å®ç°ä¸¤è€…çš„ç»“åˆï¼Œååˆ†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¸‹ä¸€èŠ‚æ¥ç®€å•ä½¿ç”¨ä¸€ä¸‹å§ï¼

#### ğŸ¦ˆ Pythonä¸­å…·ä½“å¦‚ä½•å¤„ç†å¤±è¡¡æ ·æœ¬

ä¸ºäº†æ›´å¥½æ»´ç†è§£ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªæ•°æ®é›†ï¼Œæ¥è‡ªäºUCIæœºå™¨å­¦ä¹ å­˜å‚¨åº“çš„è¥é”€æ´»åŠ¨æ•°æ®é›†ã€‚(æ•°æ®é›†å¤§å®¶å¯ä»¥è‡ªå·±å»å®˜ç½‘ä¸‹è½½ï¼šhttps://archive.ics.uci.edu/ml/machine-learning-databases/00222/  ä¸‹è½½bank-additional.zip æˆ–è€…åˆ°å…¬ä¼—å·åå°å›å¤å…³é”®å­—â€œbankâ€æ¥è·å–å§ã€‚)

æˆ‘ä»¬åœ¨å®Œæˆimblearnåº“çš„å®‰è£…ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹ç®€å•çš„æ“ä½œäº†ï¼ˆå…¶ä½™æ›´åŠ å¤æ‚çš„æ“ä½œå¯ä»¥ç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼‰ï¼Œä»¥ä¸‹æˆ‘ä¼šä»4æ–¹é¢æ¥æ¼”ç¤ºå¦‚ä½•ç”¨Pythonå¤„ç†å¤±è¡¡æ ·æœ¬ï¼Œåˆ†åˆ«æ˜¯ï¼š

ğŸŒˆ1ã€éšæœºæ¬ é‡‡æ ·çš„å®ç°

ğŸŒˆ2ã€ä½¿ç”¨SMOTEè¿›è¡Œè¿‡é‡‡æ ·

ğŸŒˆ3ã€æ¬ é‡‡æ ·å’Œè¿‡é‡‡æ ·çš„ç»“åˆï¼ˆä½¿ç”¨pipelineï¼‰

ğŸŒˆ4ã€å¦‚ä½•è·å–æœ€ä½³çš„é‡‡æ ·ç‡ï¼Ÿ



##### ğŸš—ğŸš—ğŸš— é‚£æˆ‘ä»¬å¼€å§‹å§ï¼

```python
# å¯¼å…¥ç›¸å…³çš„åº“ï¼ˆä¸»è¦å°±æ˜¯imblearnåº“ï¼‰
from collections import Counter
from sklearn.model_selection import train_test_split
from sklearn.model_selection import cross_val_score
import pandas as pd
import numpy as np
import warnings
warnings.simplefilter(action='ignore', category=FutureWarning)

from sklearn.svm import SVC
from sklearn.metrics import classification_report, roc_auc_score
from numpy import mean

# å¯¼å…¥æ•°æ®
df = pd.read_csv(r'./data/bank-additional/bank-additional-full.csv', ';') # '';'' ä¸ºåˆ†éš”ç¬¦
df.head()

```

![image-20201114203736871](./arrests/62.png)



æ•°æ®é›†æ˜¯è‘¡è„ç‰™é“¶è¡Œçš„æŸæ¬¡è¥é”€æ´»åŠ¨çš„æ•°æ®ï¼Œå…¶è¥é”€ç›®æ ‡å°±æ˜¯è®©å®¢æˆ·è®¢é˜…ä»–ä»¬çš„äº§å“ï¼Œç„¶åä»–ä»¬é€šè¿‡ä¸å®¢æˆ·çš„ç”µè¯æ²Ÿé€šä»¥åŠå…¶ä»–æ¸ é“è·å–åˆ°çš„å®¢æˆ·ä¿¡æ¯ï¼Œç»„æˆäº†è¿™ä¸ªæ•°æ®é›†ã€‚

å…³äºå­—æ®µé‡Šä¹‰ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„æˆªå›¾ï¼š

![image-20201114203827825](./arrests/63.png)

æˆ‘ä»¬å¯ä»¥å¤§è‡´çœ‹çœ‹æ•°æ®é›†æ˜¯ä¸æ˜¯å¤±è¡¡æ ·æœ¬ï¼š

```python
df['y'].value_counts()/len(df)
#no     0.887346
#yes    0.112654
#Name: y, dtype: float64
```

å¯ä»¥çœ‹å‡ºå°‘æ•°ç±»çš„å æ¯”ä¸º11.2%ï¼Œå±äº**ä¸­åº¦å¤±è¡¡æ ·æœ¬**ã€‚

```python
# åªä¿ç•™æ•°å€¼å‹å˜é‡ï¼ˆç®€å•æ“ä½œï¼‰
df = df.loc[:,
['age', 'duration', 'campaign', 'pdays',
       'previous', 'emp.var.rate', 'cons.price.idx',
       'cons.conf.idx', 'euribor3m', 'nr.employed','y']]
# targetç”± yes/no è½¬ä¸º 0/1
df['y'] = df['y'].apply(lambda x: 1 if x=='yes' else 0)
df['y'].value_counts()
#0    36548
#1     4640
#Name: y, dtype: int64
```

##### ğŸŒˆ1ã€éšæœºæ¬ é‡‡æ ·çš„å®ç°

æ¬ é‡‡æ ·åœ¨imblearnåº“ä¸­ä¹Ÿæ˜¯æœ‰æ–¹æ³•å¯ä»¥ç”¨çš„ï¼Œé‚£å°±æ˜¯ `under_sampling.RandomUnderSampler`ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŠŠæ–¹æ³•å¼•å…¥ï¼Œç„¶åè°ƒç”¨å®ƒã€‚å¯è§ï¼ŒåŸå…ˆ0çš„æ ·æœ¬æœ‰21942ï¼Œæ¬ é‡‡æ ·ä¹‹åå°±å˜æˆäº†ä¸1ä¸€æ ·çš„æ•°é‡äº†ï¼ˆå³2770ï¼‰ï¼Œå®ç°äº†50%/50%çš„ç±»åˆ«åˆ†å¸ƒã€‚

```python
# 1ã€éšæœºæ¬ é‡‡æ ·çš„å®ç°
# å¯¼å…¥ç›¸å…³çš„æ–¹æ³•
from imblearn.under_sampling import RandomUnderSampler

# åˆ’åˆ†å› å˜é‡å’Œè‡ªå˜é‡
X = df.iloc[:,:-1]
y = df.iloc[:,-1]

# åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.40)

# ç»Ÿè®¡å½“å‰çš„ç±»åˆ«å æ¯”æƒ…å†µ
print("Before undersampling: ", Counter(y_train))

# è°ƒç”¨æ–¹æ³•è¿›è¡Œæ¬ é‡‡æ ·
undersample = RandomUnderSampler(sampling_strategy='majority')

# è·å¾—æ¬ é‡‡æ ·åçš„æ ·æœ¬
X_train_under, y_train_under = undersample.fit_resample(X_train, y_train)

# ç»Ÿè®¡æ¬ é‡‡æ ·åçš„ç±»åˆ«å æ¯”æƒ…å†µ
print("After undersampling: ", Counter(y_train_under))

# è°ƒç”¨æ”¯æŒå‘é‡æœºç®—æ³• SVC
model=SVC()

clf = model.fit(X_train, y_train)
pred = clf.predict(X_test)
print("ROC AUC score for original data: ", roc_auc_score(y_test, pred))

clf_under = model.fit(X_train_under, y_train_under)
pred_under = clf_under.predict(X_test)
print("ROC AUC score for undersampled data: ", roc_auc_score(y_test, pred_under))

# Outputï¼š
#Before undersampling:  Counter({0: 21942, 1: 2770})
#After undersampling:  Counter({0: 2770, 1: 2770})
#ROC AUC score for original data:  0.603521152028
#ROC AUC score for undersampled data:  0.829234085179
```

ğŸŒˆ2ã€ä½¿ç”¨SMOTEè¿›è¡Œè¿‡é‡‡æ ·

è¿‡é‡‡æ ·æŠ€æœ¯ä¸­ï¼ŒSMOTEè¢«è®¤ä¸ºæ˜¯æœ€ä¸ºæµè¡Œçš„æ•°æ®é‡‡æ ·ç®—æ³•ä¹‹ä¸€ï¼Œå®ƒæ˜¯åŸºäºéšæœºè¿‡é‡‡æ ·ç®—æ³•çš„ä¸€ç§æ”¹è‰¯ç‰ˆæœ¬ï¼Œç”±äºéšæœºè¿‡é‡‡æ ·åªæ˜¯é‡‡å–äº†ç®€å•å¤åˆ¶æ ·æœ¬çš„ç­–ç•¥æ¥è¿›è¡Œæ ·æœ¬çš„æ‰©å¢ï¼Œè¿™æ ·å­ä¼šå¯¼è‡´ä¸€ä¸ªæ¯”è¾ƒç›´æ¥çš„é—®é¢˜å°±æ˜¯è¿‡æ‹Ÿåˆã€‚å› æ­¤ï¼ŒSMOTEçš„åŸºæœ¬æ€æƒ³å°±æ˜¯å¯¹å°‘æ•°ç±»æ ·æœ¬è¿›è¡Œåˆ†æå¹¶åˆæˆæ–°æ ·æœ¬æ·»åŠ åˆ°æ•°æ®é›†ä¸­ã€‚

> ç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š
>
> (1)å¯¹äºå°‘æ•°ç±»ä¸­æ¯ä¸€ä¸ªæ ·æœ¬xï¼Œä»¥æ¬§æ°è·ç¦»ä¸ºæ ‡å‡†è®¡ç®—å®ƒåˆ°å°‘æ•°ç±»æ ·æœ¬é›†ä¸­æ‰€æœ‰æ ·æœ¬çš„è·ç¦»ï¼Œå¾—åˆ°å…¶kè¿‘é‚»ã€‚
>
> (2)æ ¹æ®æ ·æœ¬ä¸å¹³è¡¡æ¯”ä¾‹è®¾ç½®ä¸€ä¸ªé‡‡æ ·æ¯”ä¾‹ä»¥ç¡®å®šé‡‡æ ·å€ç‡Nï¼Œå¯¹äºæ¯ä¸€ä¸ªå°‘æ•°ç±»æ ·æœ¬xï¼Œä»å…¶kè¿‘é‚»ä¸­éšæœºé€‰æ‹©è‹¥å¹²ä¸ªæ ·æœ¬ï¼Œå‡è®¾é€‰æ‹©çš„è¿‘é‚»ä¸ºxnã€‚
>
> (3)å¯¹äºæ¯ä¸€ä¸ªéšæœºé€‰å‡ºçš„è¿‘é‚»xnï¼Œåˆ†åˆ«ä¸åŸæ ·æœ¬æŒ‰ç…§å¦‚ä¸‹çš„å…¬å¼æ„å»ºæ–°çš„æ ·æœ¬ã€‚

![image-20201114230817992](./arrests/64.png)

```python
# 2ã€ä½¿ç”¨SMOTEè¿›è¡Œè¿‡é‡‡æ ·
# å¯¼å…¥ç›¸å…³çš„æ–¹æ³•
from imblearn.over_sampling import SMOTE

# åˆ’åˆ†å› å˜é‡å’Œè‡ªå˜é‡
X = df.iloc[:,:-1]
y = df.iloc[:,-1]

# åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†
X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.40)

# ç»Ÿè®¡å½“å‰çš„ç±»åˆ«å æ¯”æƒ…å†µ
print("Before oversampling: ", Counter(y_train))

# è°ƒç”¨æ–¹æ³•è¿›è¡Œè¿‡é‡‡æ ·
SMOTE = SMOTE()

# è·å¾—è¿‡é‡‡æ ·åçš„æ ·æœ¬
X_train_SMOTE, y_train_SMOTE = SMOTE.fit_resample(X_train, y_train)

# ç»Ÿè®¡è¿‡é‡‡æ ·åçš„ç±»åˆ«å æ¯”æƒ…å†µ
print("After oversampling: ",Counter(y_train_SMOTE))

# è°ƒç”¨æ”¯æŒå‘é‡æœºç®—æ³• SVC
model=SVC()

clf = model.fit(X_train, y_train)
pred = clf.predict(X_test)
print("ROC AUC score for original data: ", roc_auc_score(y_test, pred))

clf_SMOTE= model.fit(X_train_SMOTE, y_train_SMOTE)
pred_SMOTE = clf_SMOTE.predict(X_test)
print("ROC AUC score for oversampling data: ", roc_auc_score(y_test, pred_SMOTE))

# Outputï¼š
#Before oversampling:  Counter({0: 21980, 1: 2732})
#After oversampling:  Counter({0: 21980, 1: 21980})
#ROC AUC score for original data:  0.602555700614
#ROC AUC score for oversampling data:  0.844305732561
```

ğŸŒˆ3ã€æ¬ é‡‡æ ·å’Œè¿‡é‡‡æ ·çš„ç»“åˆï¼ˆä½¿ç”¨pipelineï¼‰

é‚£å¦‚æœæˆ‘ä»¬éœ€è¦åŒæ—¶ä½¿ç”¨è¿‡é‡‡æ ·ä»¥åŠæ¬ é‡‡æ ·ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ä½¿ç”¨ `pipeline`æ¥å®ç°ã€‚

```python
#  3ã€æ¬ é‡‡æ ·å’Œè¿‡é‡‡æ ·çš„ç»“åˆï¼ˆä½¿ç”¨pipelineï¼‰
# å¯¼å…¥ç›¸å…³çš„æ–¹æ³•
from imblearn.over_sampling import SMOTE
from imblearn.under_sampling import RandomUnderSampler
from imblearn.pipeline import Pipeline

# åˆ’åˆ†å› å˜é‡å’Œè‡ªå˜é‡
X = df.iloc[:,:-1]
y = df.iloc[:,-1]

#  å®šä¹‰ç®¡é“
model = SVC()
over = SMOTE(sampling_strategy=0.4)
under = RandomUnderSampler(sampling_strategy=0.5)
steps = [('o', over), ('u', under), ('model', model)]
pipeline = Pipeline(steps=steps)

# è¯„ä¼°æ•ˆæœ
scores = cross_val_score(pipeline, X, y, scoring='roc_auc', cv=5, n_jobs=-1)
score = mean(scores)
print('ROC AUC score for the combined sampling method: %.3f' % score)

# Outputï¼š
#ROC AUC score for the combined sampling method: 0.937
```

ğŸŒˆ4ã€å¦‚ä½•è·å–æœ€ä½³çš„é‡‡æ ·ç‡ï¼Ÿ

åœ¨ä¸Šé¢çš„æ —å­ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é»˜è®¤ç»è¿‡é‡‡æ ·å˜æˆ50ï¼š50ï¼Œä½†æ˜¯è¿™æ ·å­çš„é‡‡æ ·æ¯”ä¾‹å¹¶éæœ€ä¼˜é€‰æ‹©ï¼Œå› æ­¤æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªå« `æœ€ä½³é‡‡æ ·ç‡`çš„æ¦‚å¿µï¼Œç„¶åæˆ‘ä»¬é€šè¿‡è®¾ç½®é‡‡æ ·çš„æ¯”ä¾‹ï¼Œé‡‡æ ·ç½‘æ ¼æœç´¢çš„æ–¹æ³•å»æ‰¾åˆ°è¿™ä¸ªæœ€ä¼˜ç‚¹ã€‚

```python
# 4ã€å¦‚ä½•è·å–æœ€ä½³çš„é‡‡æ ·ç‡ï¼Ÿ
# å¯¼å…¥ç›¸å…³çš„æ–¹æ³•
from imblearn.over_sampling import SMOTE
from imblearn.under_sampling import RandomUnderSampler
from imblearn.pipeline import Pipeline
# åˆ’åˆ†å› å˜é‡å’Œè‡ªå˜é‡
X = df.iloc[:,:-1]
y = df.iloc[:,-1]
# values to evaluate
over_values = [0.3,0.4,0.5]
under_values = [0.7,0.6,0.5]
for o in over_values:
  for u in under_values:
    # define pipeline
    model = SVC()
    over = SMOTE(sampling_strategy=o)
    under = RandomUnderSampler(sampling_strategy=u)
    steps = [('over', over), ('under', under), ('model', model)]
    pipeline = Pipeline(steps=steps)
    # evaluate pipeline
    scores = cross_val_score(pipeline, X, y, scoring='roc_auc', cv=5, n_jobs=-1)
    score = mean(scores)
    print('SMOTE oversampling rate:%.1f, Random undersampling rate:%.1f , Mean ROC AUC: %.3f' % (o, u, score))
# Outputï¼š    
#SMOTE oversampling rate:0.3, Random undersampling rate:0.7 , Mean ROC AUC: 0.938
#SMOTE oversampling rate:0.3, Random undersampling rate:0.6 , Mean ROC AUC: 0.936
#SMOTE oversampling rate:0.3, Random undersampling rate:0.5 , Mean ROC AUC: 0.937
#SMOTE oversampling rate:0.4, Random undersampling rate:0.7 , Mean ROC AUC: 0.938
#SMOTE oversampling rate:0.4, Random undersampling rate:0.6 , Mean ROC AUC: 0.937
#SMOTE oversampling rate:0.4, Random undersampling rate:0.5 , Mean ROC AUC: 0.938
#SMOTE oversampling rate:0.5, Random undersampling rate:0.7 , Mean ROC AUC: 0.939
#SMOTE oversampling rate:0.5, Random undersampling rate:0.6 , Mean ROC AUC: 0.938
#SMOTE oversampling rate:0.5, Random undersampling rate:0.5 , Mean ROC AUC: 0.938
```

ä»ç»“æœæ—¥å¿—æ¥çœ‹ï¼Œæœ€ä¼˜çš„é‡‡æ ·ç‡å°±æ˜¯è¿‡é‡‡æ ·0.5ï¼Œæ¬ é‡‡æ ·0.7ã€‚

æœ€åï¼Œæƒ³å’Œå¤§å®¶è¯´çš„æ˜¯æ²¡æœ‰ç»å¯¹çš„å¥—è·¯ï¼Œåªæœ‰åˆé€‚çš„å¥—è·¯ï¼Œæ— è®ºæ˜¯æ¬ é‡‡æ ·è¿˜æ˜¯è¿‡é‡‡æ ·ï¼Œåªæœ‰åˆé€‚æ‰æœ€é‡è¦ã€‚è¿˜æœ‰ï¼Œæ¬ é‡‡æ ·çš„ç¡®ä¼šæ¯”è¿‡é‡‡æ ·â€œçœé’±â€å“ˆï¼ˆä»è®­ç»ƒæ—¶é—´ä¸Šå¾ˆç›´è§‚å¯ä»¥æ„Ÿå—åˆ°ï¼‰ã€‚


#### ğŸ“– References

- [1] SMOTEç®—æ³• https://www.jianshu.com/p/13fc0f7f5565
- [2] How to deal with imbalanced data in Python



# å®è·µ

## æ¡ˆä¾‹æµ‹è¯•


### æ€è€ƒé¢˜1ï¼šå¦‚ä½•åº¦é‡ç”¨æˆ·çš„è´­ä¹°åŠ›ï¼Ÿå¦‚ä½•ç»™ç”¨æˆ·çš„è´­ä¹°åŠ›åˆ’åˆ†æ¡£ä½ï¼Ÿ

- èƒŒæ™¯ï¼šç”¨æˆ·çš„è´­ä¹°åŠ›è¡¡é‡çš„ç”¨æˆ·çš„æ¶ˆè´¹å€¾å‘ï¼Œåº¦é‡ç”¨æˆ·æ˜¯æ„¿æ„èŠ±é«˜ä»·ä¹°é«˜è´¨é‡å•†å“è¿˜æ˜¯æ„¿æ„èŠ±ä½ä»·ä¹°ä¾¿å®œå•†å“ã€‚è´­ä¹°åŠ›å±äºç”¨æˆ·ç”»åƒçš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯æ¯”è¾ƒé•¿æœŸçš„ç¨³å®šçš„ï¼Œè·Ÿè¿‘æœŸç”¨æˆ·åœ¨å¹³å°ä¸Šçš„æ¶ˆè´¹é‡‘é¢æ— å…³ã€‚
- å‚è€ƒç­”æ¡ˆï¼š 
  - ç¬¬ä¸€æ­¥æ˜¯ç»™å•†å“åˆ’åˆ†ä»·æ ¼æ¡£ä½ã€‚æ ¹æ®å•†å“çš„ç±»ç›®åˆ†ç»„ï¼Œç»„ç±»æŒ‰ç…§å•†å“ä»·æ ¼æ’åºï¼Œå¹¶æŒ‰ç…§ç­‰é¢‘æˆ–è€…ç­‰å®½çš„åˆ†ç®±æ–¹å¼ï¼Œå¾—åˆ°ä»·æ ¼æ¡£ä½ã€‚ 
  - ç¬¬äºŒæ­¥æ˜¯èšåˆç”¨æˆ·çš„è´­ä¹°åŠ›æ¡£ä½ã€‚æ ¹æ®ç”¨æˆ·çš„å†å²æ¶ˆè´¹è¡Œä¸ºï¼ŒæŠŠè´­ä¹°å•†å“çš„ä»·æ ¼æ¡£ä½èšåˆåˆ°ç”¨æˆ·èº«ä¸Šã€‚

### æ€è€ƒé¢˜2ï¼šåœ°ç†ä½ç½®ï¼ˆç»çº¬åº¦ï¼‰å¦‚ä½•åšåˆ†ç®±ï¼Ÿ

- å‚è€ƒç­”æ¡ˆï¼šä¸€ä¸ªç‰©ç†é‡å¦‚ä½•æœ‰å¤šä¸ªç»´åº¦æ‰èƒ½è¡¨ç¤ºï¼Œé‚£ä¹ˆåœ¨åšåˆ†ç®±æ—¶ä¸èƒ½æ‹†åˆ†æˆç‹¬ç«‹çš„å¤šä¸ªå˜é‡æ¥å•ç‹¬åšåˆ†ç®±ï¼Œè€Œè¦è¿™äº›å˜é‡å½“æˆä¸€ä¸ªæ•´ä½“æ¥è€ƒè™‘ã€‚ç»çº¬åº¦çš„åˆ†ç®±æœ‰ä¸€ä¸ªæˆç†Ÿçš„ç®—æ³•å«åšGeoHashï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚
- <img src="https://pic1.zhimg.com/50/v2-39b463ea256b30a475a19b06c3f7a1ff_720w.jpg?source=1940ef5c"/>
- åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çš„ç»Ÿè®¡ç‰¹å¾éœ€è¦æŒ‰ç…§ç”¨æˆ·åˆ†ç»„åå†åš**åˆ†ç®±**ï¼Œä¸å»ºè®®**å…¨å±€**åšåˆ†ç®±ã€‚
- åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒBobå¯¹ä¸åŒCategoryçš„è¡Œä¸ºæ¬¡æ•°éƒ½æ¯”è¾ƒé«˜ï¼Œä½†å´â€œé›¨éœ²å‡æ²¾â€ï¼Œä¸å¦‚Aliceå¯¹Beautyç±»ç›®é‚£ä¹ˆä¸“æ³¨ã€‚å¦‚æœå…¨å±€åˆ†ç®±ï¼Œ\< Alice, Beauty\>ã€< Bob, Sport\>çš„æ¡¶å·æ˜¯ä¸åŒçš„ï¼Œç„¶è€ŒAliceå¯¹Beautyç±»ç›®çš„åå¥½ç¨‹åº¦ä¸Bobå¯¹Sportç±»ç›®çš„åå¥½ç¨‹åº¦æ˜¯å·®ä¸å¤šçš„ï¼Œè¿™ä¸¤ä¸ªç±»ç›®éƒ½æ˜¯å½¼æ­¤çš„é¦–é€‰ã€‚å…¨å±€åˆ†ç®±ä¼šè®©æ¨¡å‹å­¦ä¹ æ—¶æ¯”è¾ƒå›°æƒ‘ã€‚

### æ€è€ƒé¢˜1ï¼š å¦‚ä½•é‡åŒ–çŸ­è§†é¢‘çš„æµè¡Œåº¦ï¼ˆå‡è®¾å°±ç”¨æ’­æ”¾æ¬¡æ•°æ¥ä»£æ›¿ï¼‰ï¼Ÿ

å‚è€ƒç­”æ¡ˆï¼š
- çŸ­è§†é¢‘çš„æ’­æ”¾æ¬¡æ•°åœ¨æ•´ä¸ªæ ·æœ¬ç©ºé—´ä¸Šéµå¾ª`å¹‚å¾‹åˆ†å¸ƒ`ï¼Œå°‘é‡çƒ­é—¨çš„è§†é¢‘æ’­æ”¾æ¬¡æ•°ä¼šå¾ˆé«˜ï¼Œå¤§é‡é•¿å°¾çš„è§†é¢‘æ’­æ”¾æ¬¡æ•°éƒ½è¾ƒå°‘ã€‚
- è¿™ä¸ªæ—¶å€™æ¯”è¾ƒå¥½çš„åšæ³•æ˜¯å…ˆåš**log basedçš„å˜æ¢**ï¼Œä¹Ÿå°±æ˜¯å…ˆå¯¹æ’­æ”¾æ¬¡æ•°å–logï¼Œå†å¯¹logå˜æ¢ä¹‹åçš„å€¼åšz-scoreæ ‡å‡†åŒ–å˜æ¢ã€‚
- å¦‚æœä¸å…ˆåšlogå˜æ¢ï¼Œå°±ç›´æ¥åšz-scoreæˆ–è€…min-maxå˜æ¢ï¼Œä¼šå¯¼è‡´ç‰¹å¾å€¼è¢«å‹ç¼©åˆ°ä¸€ä¸ªéå¸¸ç‹­çª„çš„åŒºåŸŸã€‚


#### æ€è€ƒé¢˜2ï¼šå¦‚ä½•é‡åŒ–å•†å“â€œè´µâ€æˆ–è€…â€œä¾¿å®œâ€çš„ç¨‹åº¦ï¼Ÿ

å‚è€ƒç­”æ¡ˆï¼š
- å•†å“çš„ä»·æ ¼æœ¬èº«æ— æ³•è¡¡é‡å•†å“â€œè´µâ€æˆ–â€œä¾¿å®œâ€çš„ç¨‹åº¦ï¼Œå› ä¸ºä¸åŒå“ç±»çš„å•†å“ä»·æ ¼åŒºé—´æœ¬æ¥å°±å¯èƒ½å·®å¼‚å¾ˆå¤§ï¼ŒåŒæ ·çš„ä»·æ ¼ä¹°ä¸åŒç±»å‹çš„äº§å“ç»™é¡¾å®¢çš„æ„Ÿå—ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„
  - æ¯”å¦‚ï¼Œ1000å—é’±ä¹°åˆ°ä¸€éƒ¨æ‰‹æœºï¼Œé¡¾å®¢æ„Ÿè§‰å¾ˆä¾¿å®œï¼›ä½†åŒæ ·1000å—é’±ä¹°ä¸€åªé¼ æ ‡ï¼Œé¡¾å®¢å°±ä¼šè§‰å¾—è¿™ä¸ªå•†å“çš„å®šä»·å¾ˆè´µã€‚
- å› æ­¤ï¼Œé‡åŒ–å•†å“â€œè´µâ€æˆ–è€…â€œä¾¿å®œâ€çš„ç¨‹åº¦æ—¶å°±å¿…é¡»è¦è€ƒè™‘å•†å“çš„å“ç±»ï¼Œè¿™é‡Œæ¨èçš„åšæ³•æ˜¯åš**z-scoreæ ‡å‡†åŒ–**å˜åŒ–ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯å•†å“ä»·æ ¼çš„å‡å€¼å’Œæ ‡å‡†å·®çš„è®¡ç®—éƒ½éœ€è¦é™åˆ¶åœ¨åŒå“ç±»çš„å•†å“é›†åˆå†…ã€‚

### æ€è€ƒé¢˜3ï¼šå¦‚ä½•é‡åŒ–ç”¨æˆ·å¯¹æ–°é—»é¢˜æçš„åå¥½åº¦ï¼Ÿ

å‚è€ƒç­”æ¡ˆï¼š
- ä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾ç”¨æˆ·ä¸€æ®µæ—¶é—´å†…å¯¹æŸç±»æ–°é—»çš„é˜…è¯»æ•°é‡è¡¨ç¤ºç”¨æˆ·å¯¹è¯¥ç±»æ–°é—»é¢˜æçš„åå¥½åº¦ã€‚å› ä¸ºä¸åŒç”¨æˆ·çš„æ´»è·ƒåº¦æ˜¯ä¸åŒçš„ï¼Œæœ‰äº›é«˜æ´»è·ƒåº¦ç”¨æˆ·å¯èƒ½ä¼šå¯¹å¤šä¸ªä¸åŒé¢˜æçš„æ–°é—»é˜…è¯»é‡éƒ½å¾ˆå¤§ï¼Œè€Œå¦ä¸€äº›ä½æ´»è·ƒåº¦çš„ç”¨æˆ·å¯èƒ½åªå¯¹æœ‰é™çš„å‡ ç§ç±»å‹çš„æ–°é—»æœ‰ä¸­ç­‰çš„é˜…è¯»é‡ï¼Œæˆ‘ä»¬ä¸èƒ½å› ä¸ºé«˜æ´»è·ƒåº¦çš„ç”¨æˆ·å¯¹æŸé¢˜æçš„é˜…è¯»é‡å¤§äºä½æ´»è·ƒåº¦ç”¨æˆ·å¯¹ç›¸åŒé¢˜æçš„çš„é˜…è¯»é‡ï¼Œå°±å¾—å‡ºé«˜æ´»è·ƒåº¦ç”¨æˆ·å¯¹è¿™ç§ç±»å‹çš„åå¥½åº¦å¤§äºä½æ´»è·ƒåº¦ç”¨æˆ·å¯¹åŒç±»å‹é¢˜æçš„åå¥½åº¦ï¼Œè¿™æ˜¯å› ä¸ºä½æ´»è·ƒåº¦ç”¨æˆ·çš„è™½ç„¶é˜…è¯»é‡è¾ƒå°‘ï¼Œä½†å´å‡ ä¹æŠŠæœ‰é™ç²¾åŠ›å…¨éƒ¨è´¡çŒ®ç»™äº†è¯¥ç±»å‹çš„é¢˜æï¼Œé«˜æ´»è·ƒåº¦çš„ç”¨æˆ·è™½ç„¶é˜…è¯»é‡è¾ƒå¤§ï¼Œä½†å´å¯¹å¤šç§é¢˜æâ€œé›¨éœ²å‡æ²¾â€ã€‚
- å»ºè®®åš**min-maxå½’ä¸€åŒ–**ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯è®¡ç®—æœ€å°å€¼å’Œæœ€å¤§å€¼æ—¶éƒ½é™åˆ¶åœ¨å½“å‰ç”¨æˆ·çš„æ•°æ®ä¸Šï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§ç”¨æˆ·åˆ†ç»„ï¼Œç»„å†…å†åšmin-maxå½’ä¸€åŒ–ã€‚

### æ€è€ƒé¢˜4ï¼šå½“å­˜åœ¨å¼‚å¸¸å€¼æ—¶å¦‚ä½•åšç‰¹å¾ç¼©æ”¾ï¼Ÿ

å½“å­˜åœ¨**å¼‚å¸¸å€¼**æ—¶ï¼Œé™¤äº†ç¬¬6ç§gauss rankç‰¹å¾å˜æ¢æ–¹æ³•å¤–ï¼Œå…¶ä»–çš„ç‰¹å¾ç¼©æ”¾æ–¹æ³•éƒ½å¯èƒ½æŠŠè½¬æ¢åçš„ç‰¹å¾å€¼å‹ç¼©åˆ°ä¸€ä¸ªéå¸¸ç‹­çª„çš„åŒºé—´å†…ï¼Œä»è€Œä½¿å¾—è¿™äº›ç‰¹å¾å¤±å»åŒºåˆ†åº¦ï¼Œå¦‚ä¸‹å›¾ã€‚
- è¿™é‡Œä»‹ç»ä¸€ç§æ–°çš„ç§°ä¹‹ä¸º**Robust scaling**çš„ç‰¹å¾å˜æ¢æ–¹æ³•ã€‚
- xscaled=xâˆ’median(x)/IQR
- $ x_{scaled}=\frac{x-median(x)}{IQR} $
-  å››åˆ†ä½è·ï¼ˆinterquartile range, IQRï¼‰ï¼Œåˆç§°å››åˆ†å·®ã€‚æ˜¯æè¿°ç»Ÿè®¡å­¦ä¸­çš„ä¸€ç§æ–¹æ³•ï¼Œä»¥ç¡®å®šç¬¬ä¸‰å››åˆ†ä½æ•°å’Œç¬¬ä¸€å››åˆ†ä½æ•°çš„å·®å€¼ã€‚ - <img src="https://pic2.zhimg.com/50/v2-1f4f1e692819d0103d90773f2a679d7d_720w.jpg?source=1940ef5c">

å‚è€ƒç­”æ¡ˆï¼š
- å­˜åœ¨å¼‚å¸¸å€¼ï¼Œä½¿ç”¨**Robust scaling**æˆ–è€…**gauss rank**çš„ç‰¹å¾ç¼©æ”¾æ–¹æ³•ã€‚

## æœå¹¿æ¨

æœæ¨å¹¿åœºæ™¯ä¸‹çš„ç‰¹å¾å·¥ç¨‹
- ![](https://pic2.zhimg.com/80/v2-2a4694e9ec776a6b79b6f3e877b1cb49_1440w.jpg?source=1940ef5c)

åœ¨æœç´¢ã€æ¨èã€å¹¿å‘Šåœºæ™¯ä¸‹é«˜åŸºæ•°(high-cardinality)å±æ€§è¡¨ç¤ºä¸ºç‰¹å¾æ—¶çš„æŒ‘æˆ˜
- Scalable: to billions of attribute values
- Efficient: ~10^(5+) predictions/sec/node
- Flexible: for a variety of downstream learners
- Adaptive: to distribution change

ä¸ºäº†å…‹æœè¿™äº›æŒ‘æˆ˜ï¼Œä¸šç•Œæœ€å¸¸ç”¨çš„åšæ³•æ˜¯å¤§é‡ä½¿ç”¨ç»Ÿè®¡ç‰¹å¾
- ![](https://picx.zhimg.com/80/v2-1544cd080932d08d08487092ff42cd56_1440w.jpg)

å¯¹å„ç§ç±»åˆ«å‹ç‰¹å¾æˆ–ç¦»æ•£åŒ–ä¹‹åçš„æ•°å€¼å‹ç‰¹å¾ï¼Œä»¥åŠè¿™äº›ç‰¹å¾ä¹‹é—´çš„äºŒé˜¶æˆ–é«˜é˜¶äº¤å‰ç»„åˆï¼ŒæŒ‰ç…§ä¸åŒè¡Œä¸ºç±»å‹ã€ä¸åŒæ—¶é—´åŒºé—´ã€ä¸åŒç›®æ ‡ï¼ˆé’ˆå¯¹å¤šç›®æ ‡ä»»åŠ¡ï¼‰åˆ†åˆ«ç»Ÿè®¡æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬çš„æ•°é‡ã€‚è¿™äº›ç»Ÿè®¡é‡ç»è¿‡ç‰¹å¾ç¼©æ”¾/åˆ†ç®±å’Œç›®æ ‡ç¼–ç åå¯ä»¥ä½œä¸ºæœ€ç»ˆç‰¹å¾å‘é‡çš„ä¸€éƒ¨åˆ†ã€‚æ¨èçš„ç‰¹å¾ç¼©æ”¾æ–¹æ³•ä¸ºgauss rankï¼Œæˆ–è€…ä½¿ç”¨åˆ†ç®±æ“ä½œã€‚æ¨èçš„ç›®æ ‡ç¼–ç æ–¹æ³•åŒ…æ‹¬Target Encodingã€ä¼˜åŠ¿æ¯”ã€WOEç­‰ã€‚
- ![](https://picx.zhimg.com/80/v2-cb7c64fafa59669a8c3a640632a54769_1440w.jpg?source=1940ef5c)

åœ¨ç»Ÿè®¡æ­£è´Ÿæ ·æœ¬æ•°é‡ä¹‹å‰ï¼Œéœ€è¦å¯¹ä»»åŠ¡æ¶‰åŠçš„ä¸åŒå®ä½“ï¼ˆå¦‚ï¼Œç”¨æˆ·ã€ç‰©å“ã€ä¸Šä¸‹æ–‡ç­‰ï¼‰è¿›è¡Œåˆ†ç®±ï¼Œå†ç»Ÿè®¡åˆ†ç®±å˜é‡çš„æ­£è´Ÿæ ·æœ¬æ•°é‡ã€‚è¯¥æ“ä½œæ–¹æ³•å«åšbin countingã€‚è¿™é‡Œçš„binningæ“ä½œå¯ä»¥æ˜¯ä»»æ„çš„æ˜ å°„å‡½æ•°ï¼Œæœ€å¸¸ç”¨çš„æŒ‰ç…§å®ä½“çš„è‡ªç„¶å±æ€§æ¥åˆ†ç®±ï¼Œæ¯”å¦‚å•†å“å¯ä»¥æŒ‰ç…§ç±»ç›®ã€å“ç‰Œã€åº—é“ºã€ä»·æ ¼ã€å¥½è¯„ç‡ç­‰å±æ€§åˆ†ç®±ï¼Œç”¨æˆ·å¯ä»¥æŒ‰ç…§å¹´é¾„ã€æ€§åˆ«ã€èŒä¸šã€çˆ±å¥½ã€è´­ä¹°åŠ›ç­‰åˆ†ç®±ã€‚

å¦å¤–ï¼Œä¸ºäº†é˜²æ­¢label leakageï¼Œå„ç§ç»Ÿè®¡é‡çš„ç»Ÿè®¡æ—¶é—´æ®µéƒ½éœ€è¦æ”¾åœ¨åœ¨æ ·æœ¬äº‹ä»¶çš„ä¸šåŠ¡æ—¶é—´ä¹‹å‰ï¼ˆæ³¨æ„å›¾ç‰‡ä¸‹æ–¹çš„æ—¶é—´è½´ï¼‰ã€‚æœ€åæŠŠå„ç§ç²’åº¦çš„ç»Ÿè®¡é‡å¤„ç†ï¼ˆç¼©æ”¾ã€åˆ†ç®±ã€ç¼–ç ç­‰ï¼‰åçš„å€¼æ‹¼æ¥èµ·æ¥ä½œä¸ºç‰¹å¾å‘é‡çš„ä¸€éƒ¨åˆ†ã€‚
- ![](https://picx.zhimg.com/80/v2-f7a62e4cafc21245014c5ab9b0b2a32b_1440w.jpg?source=1940ef5c)

é‚£ä¹ˆï¼Œæ€ä¹ˆæ ·æ‰èƒ½æŠŠæ‰€æœ‰å¯èƒ½çš„ç‰¹å¾éƒ½æƒ³å…¨äº†ï¼Œåšåˆ°ä¸é‡ä¸æ¼å‘¢ï¼Ÿå¯ä»¥æŒ‰ç…§å¦‚ä¸‹æè¿°çš„ç»“æ„åŒ–æ–¹æ³•æ¥æšä¸¾ç‰¹å¾ã€‚
- åˆ—å­˜å®ä½“ï¼ˆentityï¼‰ï¼›å¦‚æœå¹¿å‘Šä¸šåŠ¡åœºæ™¯çš„ç”¨æˆ·ã€å¹¿å‘Šã€æœç´¢è¯ã€å¹¿å‘Šå¹³å°ã€‚
- å®ä½“åˆ†ç®± & å•ç»´åº¦ç»Ÿè®¡/ç¼–ç 
- ç‰¹å¾äº¤å‰ & å¤šç»´åº¦ç»Ÿè®¡/ç¼–ç 
- ![](https://pic4.zhimg.com/80/v2-8f3aa30c191b9560808c5b69e3568ca0_1440w.jpg?source=1940ef5c)

å¯¹å®ä½“åˆ†ç®±å¯ä»¥ç©å‡ºå¾ˆå¤šèŠ±æ ·ï¼Œæ¯”å¦‚å¯ä»¥ä»æ–‡æœ¬æè¿°ä¿¡æ¯ä¸­æŠ½å–å…³é”®è¯ä½œä¸ºåˆ†ç®±ç»“æœï¼›æˆ–è€…å¯ä»¥åŸºäºembeddingå‘é‡èšç±»ï¼Œèšç±»çš„ç»“æœç°‡ä½œä¸ºåˆ†ç®±ç»“æœã€‚ç„¶åéœ€è¦å¯¹è¿™äº›åˆ†ç®±ç»“æœè¿›è¡Œå¤šè½®ä¸¤ä¸¤äº¤å‰å¾—åˆ°äºŒé˜¶ã€ä¸‰é˜¶æˆ–æ›´é«˜é˜¶çš„ç»„åˆç‰¹å¾ã€‚æœ€åï¼Œå¯¹è¿™äº›å•ç»´åº¦ï¼ˆä¸€é˜¶ï¼‰ç‰¹å¾å’Œå„ç§é«˜é˜¶ç»„åˆç‰¹å¾åˆ†åˆ«ç»Ÿè®¡ä¸åŒè¡Œä¸ºç±»å‹ï¼ˆç‚¹å‡»ã€æ”¶è—ã€åˆ†äº«ã€è´­ä¹°ç­‰ï¼‰ã€ä¸åŒæ—¶é—´å‘¨æœŸï¼ˆæœ€è¿‘1å¤©ã€3å¤©ã€7å¤©ã€30å¤©ç­‰ï¼‰ã€ä¸åŒå­¦ä¹ ç›®æ ‡ï¼ˆç‚¹å‡»ã€è½¬åŒ–ç­‰ï¼‰ä¸‹çš„æ­£ã€è´Ÿæ ·æœ¬æ•°é‡ï¼Œå¯¹è¿™äº›ç»Ÿè®¡é‡è¿›è¡Œç‰¹å¾ç¼©æ”¾ã€åˆ†ç®±ã€ç¼–ç åä½œä¸ºæœ€ç»ˆçš„ç‰¹å¾ã€‚


## Tensorflow feature columnç”¨æ³•

### èƒŒæ™¯ä»‹ç»

Feature Columnæ˜¯TensorFlowæä¾›çš„ç”¨äºå¤„ç†ç»“æ„åŒ–æ•°æ®çš„å·¥å…·ï¼Œæ˜¯å°†æ ·æœ¬ç‰¹å¾æ˜ å°„åˆ°ç”¨äºè®­ç»ƒæ¨¡å‹ç‰¹å¾çš„æ¡¥æ¢ã€‚å®ƒæä¾›äº†å¤šç§ç‰¹å¾å¤„ç†æ–¹æ³•ï¼Œè®©ç®—æ³•äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“å°†å„ç§åŸå§‹ç‰¹å¾è½¬æ¢ä¸ºæ¨¡å‹çš„è¾“å…¥ï¼Œæ¥è¿›è¡Œæ¨¡å‹å®éªŒã€‚

![](https://img-blog.csdnimg.cn/img_convert/cf98e84681aaacadc02f7023fe966c2e.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ‰€æœ‰Feature Columnéƒ½æºè‡ªFeatureColumnç±»ï¼Œå¹¶ç»§æ‰¿äº†ä¸‰ä¸ªå­ç±»CategoricalColumnã€DenseColumnå’ŒSequenceDenseColumnï¼Œåˆ†åˆ«å¯¹åº”ç¨€ç–ç‰¹å¾ã€ç¨ å¯†ç‰¹å¾ã€åºåˆ—ç¨ å¯†ç‰¹å¾ã€‚ç®—æ³•äººå‘˜å¯ä»¥æŒ‰ç…§æ ·æœ¬ç‰¹å¾çš„ç±»å‹æ‰¾åˆ°å¯¹åº”çš„æ¥å£ç›´æ¥é€‚é…ã€‚

è€Œä¸” Feature Column å’Œ TF Estimator æ¥å£æœ‰å¾ˆå¥½çš„é›†æˆï¼Œé€šè¿‡å®šä¹‰å¥½å¯¹åº”çš„ç‰¹å¾è¾“å…¥å°±å¯ä»¥ç›´æ¥åœ¨é¢„å®šä¹‰çš„ Estimator æ¨¡å‹ä¸­ä½¿ç”¨ã€‚TF Estimator åœ¨æ¨èç®—æ³•çš„ä½¿ç”¨éå¸¸æ™®éï¼Œç‰¹åˆ«æ˜¯å®ƒå°è£…äº†åˆ†å¸ƒå¼è®­ç»ƒçš„åŠŸèƒ½ã€‚
 
ä¸‹å›¾æ˜¯ä¸€ä¸ªä½¿ç”¨Feature Columnå¤„ç†ç‰¹å¾ï¼Œè¿›å…¥åˆ° Estimator DNN Classifierçš„ç¤ºä¾‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/779703f3920ecde96972cd2f1614417d.png)
 
è™½ç„¶Feature Columnä½¿ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œæ¨¡å‹ä»£ç ç¼–å†™æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯åœ¨çˆ±å¥‡è‰ºæ¨èç±»ä¸šåŠ¡çš„çº¿ä¸ŠæœåŠ¡è½åœ°è¿‡ç¨‹ä¸­ï¼Œä¸€äº›æ€§èƒ½é—®é¢˜é€æ¸å‡¸æ˜¾ï¼Œä¸‹é¢å°†é€ä¸ªä»‹ç»æˆ‘ä»¬åœ¨å®é™…ä¸­ç¢°åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•ä¼˜åŒ–ã€‚
 
### æ•´å‹ç‰¹å¾å“ˆå¸Œä¼˜åŒ–
 
æ¨èç±»æ¨¡å‹é€šå¸¸éƒ½ä¼šå°†IDç±»ç‰¹å¾å“ˆå¸Œåˆ°ä¸€å®šæ•°é‡çš„bucket åˆ†æ¡¶ï¼Œç„¶åè½¬æ¢æˆ Embeddingå†ä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œæ¯”å¦‚è§†é¢‘ç±»IDç‰¹å¾ï¼Œç”¨æˆ·IDç‰¹å¾ï¼Œå•†å“IDç‰¹å¾ç­‰ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/071c506b4a5179d6fbd7bb2bf3f1afc1.png)
 
åœ¨` categorical_column_with_hash_bucket `çš„æ–‡æ¡£[2]é‡Œé¢è¯´åˆ°ï¼šå¯¹äºStringç±»å‹çš„è¾“å…¥ï¼Œä¼šæ‰§è¡Œ\`output_id = Hash(input_feature_string) % bucket_size\`åšå“ˆå¸Œæ“ä½œï¼Œè€Œå¯¹äºæ•´æ•°ç±»å‹çš„è¾“å…¥ä¼šå…ˆè½¬æˆStringç±»å‹ç„¶åå†è¿›è¡ŒåŒæ ·çš„å“ˆå¸Œæ“ä½œã€‚é€šè¿‡æŸ¥çœ‹æºä»£ç [3]å¯ä»¥çœ‹åˆ°è¿™æ ·çš„é€»è¾‘ï¼š
![](https://img-blog.csdnimg.cn/img_convert/3799b20a61c2d96ae0ea98eefec50f97.png)

åœ¨æ¨èä¸šåŠ¡ä¸­ï¼Œé€šå¸¸è¿™ç±»IDéƒ½æ˜¯å·²ç»è¿‡æŸç§æ–¹å¼çš„å“ˆå¸Œï¼Œå½¢æˆ64bitçš„æ•´å‹ç‰¹å¾æ”¾åˆ°æ ·æœ¬é‡Œé¢ï¼Œå› æ­¤å¿…ç„¶è¦æ‰§è¡Œæ•´å‹è½¬åŒ–æˆStringçš„æ“ä½œã€‚ä½†æ˜¯åœ¨TensorFlow çš„ Timelineä¸­å¯ä»¥çœ‹åˆ°å‡½æ•°\`as_string\`æ‰€å¯¹åº”çš„TFå†…éƒ¨çš„\`AsString\` OPå…¶å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œç»è¿‡åˆ†æå¯¹æ¯”å‘ç°\`AsString\` OPçš„è€—æ—¶é€šå¸¸æ˜¯åé¢çš„å“ˆå¸Œæ“ä½œçš„3å€ä»¥ä¸Šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![](https://img-blog.csdnimg.cn/img_convert/5ba899ac18ae4164521bd87380441b26.png)
 
è¿›ä¸€æ­¥åˆ†æ\`AsString\` OPå†…éƒ¨çš„ä»£ç ï¼Œå¯ä»¥å‘ç°è¿™ä¸ªOPå†…éƒ¨è¿˜æ¶‰åŠåˆ°äº†å†…å­˜åˆ†é…å’Œæ‹·è´æ“ä½œï¼Œå› æ­¤æ¯”çº¯å“ˆå¸Œè®¡ç®—æ…¢å°±å¯ä»¥ç†è§£äº†ã€‚
 
å¾ˆè‡ªç„¶ï¼Œå›¢é˜Ÿè€ƒè™‘å»æ‰ç›¸å…³æ“ä½œæ¥åšä¼˜åŒ–ï¼Œå› æ­¤ä¸“é—¨ç¼–å†™äº†ä¸€ä¸ªç»™æ•´å‹åšå“ˆå¸Œçš„å‡½æ•°æ¥åšä¼˜åŒ–ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
![](https://img-blog.csdnimg.cn/img_convert/df002c80ea3fe3ddd368dc41a7f87f04.png)
 
ç»è¿‡è¿™æ ·åšåŒºåˆ†ç±»å‹çš„å“ˆå¸Œæ–¹å¼ï¼Œå®Œå…¨ä¼˜åŒ–äº†åŸå…ˆè€—æ—¶é•¿çš„ç±»å‹è½¬æ¢æ“ä½œã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æ–°åŠ çš„å“ˆå¸Œå‡½æ•°å¯¹åº”çš„æ–°OPåŒæ ·éœ€è¦åŠ åˆ° TF Serving ä¸­ã€‚

### å®šé•¿ç‰¹å¾è½¬æ¢ä¼˜åŒ–

å®šé•¿ç‰¹å¾æ˜¯æŒ‡ä½¿ç”¨æ¥å£\`tf.io.FixedLenFeature\`æ¥è§£æçš„ç‰¹å¾ï¼Œæ¯”å¦‚ç”¨æˆ·çš„æ€§åˆ«ï¼Œå¹´é¾„ç­‰ï¼Œè¿™ç±»ç‰¹å¾çš„é•¿åº¦é€šå¸¸éƒ½æ˜¯å®šé•¿çš„ï¼Œå¹¶ä¸”å›ºå®šä¸º 1 ç»´æˆ–å¤šç»´ã€‚è¿™ç±»ç‰¹å¾ç»è¿‡æ¥å£\`tf.io.parse_example\` è§£ææˆ Dense Tensorï¼Œç„¶åç»è¿‡Feature Columnå¤„ç†ï¼Œå†è¿›å…¥åˆ°æ¨¡å‹çš„è¾“å…¥å±‚ã€‚å¸¸è§çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

![](https://img-blog.csdnimg.cn/img_convert/f9ffd1309fe16b22e3f8b320aa0d0243.png)

ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹å­ï¼Œä¸¾ä¾‹è§£æä¸€ä¸‹ TensorFlow å†…éƒ¨çš„Tensor è½¬æ¢é€»è¾‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸¤ä¸ªæ ·æœ¬user_nameåˆ†åˆ«ä¸ºbobå’Œwandaï¼Œç»è¿‡æ ·æœ¬è§£ææˆshapeä¸º2çš„Dense Tensorï¼Œç„¶åç»è¿‡\`categorical_column_with_vocabulary_list\`è½¬æ¢ï¼ŒæŸ¥æ‰¾è¯è¡¨åˆ†åˆ«è½¬æˆ0å’Œ2ï¼Œå†ç»è¿‡\`indicator_column\`è½¬æ¢æˆOne hotç¼–ç çš„Denseè¾“å…¥ã€‚

![](https://img-blog.csdnimg.cn/img_convert/94341e5e7d231ab28218a7b083d437bb.png)

ä»ä¸Šé¢çš„æ ·æœ¬å¤„ç†æ¥çœ‹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç„¶åå†æ¥çœ‹ä¸€ä¸‹Feature Columnä»£ç å†…éƒ¨çš„è½¬æ¢å¤„ç†é€»è¾‘ï¼š

![](https://img-blog.csdnimg.cn/img_convert/793a8133d744cab5cd66b016632259ab.png)
 
å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ä»£ç ä¸­Vocabulary Categorical Column ä¼šå…ˆå»é™¤æ‰ä¸€äº›éæ³•å€¼ï¼Œç„¶åæŠŠè¾“å…¥çš„Dense Tensor è½¬æ¢æˆ Sparse Tensorï¼Œåœ¨Indicator Columnä¸­ä¼šå†æ¬¡æŠŠTensorä»Sparseè½¬æˆDenseï¼Œæœ€åè½¬æˆéœ€è¦çš„One Hot Tensorã€‚

å…ˆæ¥æ€è€ƒä¸€ä¸‹ä¸Šé¢ä¸¤ä¸ªè½¬æ¢æ“ä½œçš„ç›®çš„ï¼Œä¸€æ–¹é¢æ˜¯ä¸ºäº†å»é™¤æ ·æœ¬æ•°æ®ä¸­ä¸€äº›å¼‚å¸¸çš„å€¼ï¼Œå¦å¤–ä¸€æ–¹é¢æ˜¯è¿™æ ·çš„å¤„ç†å…¶å®æ˜¯åŒæ—¶å…¼é¡¾äº†è¾“å…¥æ˜¯ Sparse Tensor çš„æƒ…å†µï¼Œå¦‚æœè¾“å…¥æ˜¯Spare Tensorå°±ç›´æ¥åšVocabularyè¯è¡¨æŸ¥æ‰¾ï¼Œç„¶åå†è½¬æˆDense Tensorã€‚è¿™æ ·è½¬æ¢è™½ç„¶è¾¾åˆ°ä»£ç å¤ç”¨çš„ä½œç”¨ï¼Œä½†æ˜¯åœ¨æ€§èƒ½ä¸Šå´æœ‰æŸå¤±ã€‚å¦‚æœèƒ½ç›´æ¥å°†åŸå§‹çš„Input Tensorè½¬æ¢æˆOne Hot Tensorï¼Œå°±å¯ä»¥çœå»ä¸¤ä¸ªè½¬æ¢è¿‡ç¨‹ï¼Œè€Œä¸”Sparse Tensor å’ŒDense Tensorä¹‹é—´çš„è½¬æ¢å…¶å®æ˜¯éå¸¸è€—æ—¶çš„æ“ä½œã€‚

å†å›åˆ°å®šé•¿ç‰¹å¾çš„åŸå§‹æ€§è´¨ï¼Œå¯¹äºè¿™ç±»å®šé•¿ç‰¹å¾æ¥è®²ï¼Œåœ¨æ ·æœ¬å¤„ç†çš„æ—¶å€™å¦‚æœæ²¡æœ‰å€¼ï¼Œä¼šè¢«å¡«å……æˆé»˜è®¤å€¼ï¼Œè€Œä¸”åœ¨ç”Ÿæˆæ ·æœ¬çš„æ—¶å€™éƒ½ä¼šè¢«ä¿è¯ä¸ä¼šå‡ºç°æœ‰ç©ºå€¼æˆ–è€… -1çš„æƒ…å†µï¼Œå› æ­¤å¼‚å¸¸å€¼çš„å¤„ç†å…¶å®æ˜¯å¯ä»¥è¢«çœç•¥çš„ã€‚æœ€åä¼˜åŒ–åçš„å†…éƒ¨è½¬æ¢é€»è¾‘å¦‚ä¸‹å›¾ï¼Œçœå»äº†ä¸¤æ¬¡Sparse Tensor å’ŒDense Tensorä¹‹é—´çš„è½¬æ¢ã€‚
 
![](https://img-blog.csdnimg.cn/img_convert/e224560dfd379964f61d0a14471c4679.png)
 
é™¤äº†ä¸Šé¢çš„Vocabulary Categorical Columnï¼Œè¿˜æœ‰åˆ«çš„ç±»ä¼¼Feature Columnä¹Ÿæœ‰åŒæ ·çš„é—®é¢˜ï¼Œå› æ­¤é’ˆå¯¹è¿™ç±»ç‰¹å¾ï¼Œå¹³å°ä¸“é—¨å¼€å‘äº†ä¸€å¥—ä¼˜åŒ–çš„Feature Columnæ¥å£æä¾›ç»™ä¸šåŠ¡ä½¿ç”¨ï¼Œä¼˜åŒ–æ€§èƒ½æ•ˆæœè¿˜ä¸é”™ã€‚
 
### ç”¨æˆ·ç‰¹å¾å»é‡ä¼˜åŒ–

æ¨èç±»ç®—æ³•æ¨¡å‹éƒ½æœ‰ä¸ªå¾ˆå…¸å‹çš„ç‰¹ç‚¹ï¼Œé‚£å°±æ˜¯æ¨¡å‹ä¸­ä¼šåŒ…å«ç”¨æˆ·ä¾§ç‰¹å¾å’Œè¦æ¨èçš„Itemä¾§ç‰¹å¾ï¼Œæ¯”å¦‚è§†é¢‘çš„ç‰¹å¾ã€å•†å“çš„ç‰¹å¾ç­‰ã€‚æ¨¡å‹åœ¨çº¿ä¸ŠæœåŠ¡éƒ¨ç½²çš„æ—¶å€™ï¼Œä¼šç»™ä¸€ä¸ªç”¨æˆ·æ¨èå¤šä¸ªè§†é¢‘æˆ–å•†å“ï¼Œæ¨¡å‹ä¼šè¿”å›è¿™å¤šä¸ªè§†é¢‘æˆ–å•†å“çš„æ‰“åˆ†ï¼Œç„¶åæŒ‰ç…§æ‰“åˆ†çš„å¤§å°æ¨èç»™ç”¨æˆ·ã€‚ç”±äºæ˜¯ç»™å•ä¸ªç”¨æˆ·åšæ¨èï¼Œè¿™ä¸ªæ—¶å€™è¯¥ç”¨æˆ·çš„ç‰¹å¾ä¼šæ ¹æ®æ¨èItemçš„æ•°é‡é‡å¤å¤šæ¬¡ï¼Œå†å‘é€ç»™æ¨¡å‹ã€‚å¦‚ä¸‹æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¨èç®—æ³•æ’åºæ¨¡å‹çº¿ä¸Šæ¨ç†çš„ç¤ºæ„å›¾ï¼š

![](https://img-blog.csdnimg.cn/img_convert/3fa70304f95043d8a701cccd69ccf0fd.png)

å›¾ç¤ºçš„æ¨¡å‹è¾“å…¥æœ‰3ä¸ªUserç‰¹å¾ï¼Œ3ä¸ªItemç‰¹å¾ï¼Œå‡å®šåœ¨å¯¹æŸä¸ªç”¨æˆ·åšæ¨èï¼Œè¯¥ç”¨æˆ·çš„3ä¸ªç‰¹å¾åˆ†åˆ«å¯¹åº”ä¸ºu1ï¼Œu2å’Œu3ã€‚è¿™æ—¶è¦å¯¹ä¸¤ä¸ªä¸åŒçš„Itemåšæ¨èè¯„åˆ†è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè¯·æ±‚é‡Œé¢æœ‰ä¸¤ä¸ªItemï¼Œè¿™ä¸¤ä¸ªItemåˆ†åˆ«ä¸ºI1å’ŒI2ï¼Œè¿™ä¸¤ä¸ªItemåˆ†åˆ«æœ‰ä¸‰ä¸ªç‰¹å¾ï¼ŒI1å¯¹åº”I11ï¼ŒI12ï¼ŒI13ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·æ„æˆä¸€ä¸ªbatch sizeä¸º2çš„æ¨ç†è¯·æ±‚ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºæ˜¯ç»™åŒä¸€ä¸ªç”¨æˆ·æ¨èä¸¤ä¸ªä¸åŒçš„Itemï¼ŒItemä¾§çš„ç‰¹å¾æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ç”¨æˆ·çš„ç‰¹å¾è¢«é‡å¤äº†ä¸¤æ¬¡ã€‚
 
ä¸Šé¢çš„ä¾‹å­åªä»¥2ä¸ªItemä¸ºä¾‹ï¼Œä½†æ˜¯å®é™…çº¿ä¸Šçš„æœåŠ¡ä¸€ä¸ªæ¨ç†è¯·æ±‚ä¼šå¸¦100ä¸ªItemç”šè‡³æ›´å¤šï¼Œå› æ­¤ç”¨æˆ·çš„ç‰¹å¾ä¹Ÿä¼šè¢«é‡å¤100æ¬¡ç”šè‡³æ›´å¤šï¼Œé‡å¤çš„ç”¨æˆ·ç‰¹å¾ä¸ä»…å¢åŠ äº†ä¼ è¾“çš„å¸¦å®½ï¼Œè€Œä¸”å¢åŠ äº†ç‰¹å¾å¤„ç†æ—¶çš„è®¡ç®—é‡ï¼Œå› æ­¤ä¸šåŠ¡éå¸¸å¸Œæœ›èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
 
è¿™ä¸ªé—®é¢˜çš„æœ¬æºè¦ä»TensorFlow çš„æ¨¡å‹è®­ç»ƒä»£ç è¯´èµ·ã€‚TensorFlow è®­ç»ƒæ—¶çš„æ¯ä¸€æ¡æ ·æœ¬æ˜¯æŸä¸ªç”¨æˆ·å¯¹æŸä¸ªItemçš„è¡Œä¸ºï¼Œç„¶åç»è¿‡shuffleå’Œbatchåè¿›å…¥åˆ°è®­ç»ƒæ¨¡å‹ï¼Œè¿™æ—¶å€™ä¸€ä¸ªbatché‡Œé¢çš„æ•°æ®è‚¯å®šåŒ…å«äº†å¤šä¸ªç”¨æˆ·è¡Œä¸ºçš„æ ·æœ¬ï¼Œè¿™ä¸ªå’Œçº¿ä¸Šæ¨ç†æœåŠ¡çš„è¾“å…¥æ•°æ®æ ¼å¼æ˜¯å®Œå…¨ä¸åŒçš„ã€‚
 
å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿæœ€ç®€å•çš„æƒ³æ³•ï¼Œå¦‚æœåœ¨çº¿ä¸ŠæœåŠ¡å°±åªå‘é€ä¸€æ¡ç”¨æˆ·ç‰¹å¾ä¼šæ€ä¹ˆæ ·ï¼Ÿå¿«é€Ÿçš„å°è¯•å°±å¯ä»¥çŸ¥é“ç‰¹å¾æ•°æ®è¿›å…¥åˆ°æ¨¡å‹è¾“å…¥å±‚çš„æ—¶å€™ä¼š concatå¤±è´¥ã€‚è¿™æ˜¯å› ä¸ºItemç‰¹å¾çš„batch sizeæ˜¯å¤šä¸ªï¼Œè€Œç”¨æˆ·ç‰¹å¾çš„batch sizeåªæœ‰1ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š
 
![](https://img-blog.csdnimg.cn/img_convert/53ad9dabb0db1d2e8cf02997f324662b.png)
 
ä¸ºäº†è§£å†³concatå¤±è´¥çš„é—®é¢˜ï¼Œå•çº¯å…ˆä»æ¨¡å‹çš„è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥è€ƒè™‘åœ¨è¿›å…¥åˆ°è¾“å…¥å±‚ä¹‹å‰æŠŠç”¨æˆ·ç‰¹å¾è¿˜åŸåˆ°å’ŒItemç‰¹å¾åŒæ ·çš„batch sizeï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](https://img-blog.csdnimg.cn/img_convert/9be29f5066865a63468a5141918f85e9.png)
 
æ˜¾ç„¶è¿™ä¸ªä»æ•°å­¦æ¨¡å‹ä¸Šæ˜¯å¯è¡Œçš„ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ€ä¹ˆåœ¨TensorFlow çš„ä»£ç é‡Œé¢å®ç°è¿™ä¸ªæƒ³æ³•ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¤åˆ¶çš„æ“ä½œåªèƒ½åœ¨çº¿ä¸ŠæœåŠ¡çš„æ¨¡å‹é‡Œé¢ï¼Œä¸èƒ½åœ¨è®­ç»ƒçš„æ¨¡å‹é‡Œé¢ã€‚
 
ç›®å‰TF Estimator æ¥å£åœ¨æ¨èç±»ç®—æ³•çš„åº”ç”¨æ¯”è¾ƒå¸¸è§ï¼Œè€ŒEstimator æ¥å£æä¾›äº†å¾ˆå¥½çš„æ¨¡å‹åŒºåˆ†æ–¹æ³•ï¼Œé€šè¿‡åˆ¤æ–­ModeKeysä¸º\`tf.estimator.ModeKeys.PREDICT\`æ—¶æ˜¯çº¿ä¸Šçš„æœåŠ¡æ¨¡å‹ï¼ŒModeKeysä¸º\`tf.estimator.ModeKeys.TRAIN\`æ—¶æ˜¯è®­ç»ƒæ¨¡å‹ï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹ä»£ç ï¼š
 
![](https://img-blog.csdnimg.cn/img_convert/88ea882ae235d4a45ccdd4781cad0851.png)
 
åœ¨å®é™…çš„æ¨¡å‹ä¸Šï¼Œéœ€è¦å°†Userå’ŒItemçš„feature columnåŒºåˆ†å¼€æ¥åˆ†åˆ«ä¼ å…¥ï¼Œè¿™ä¸ªå¯¹åŸæ¥çš„æ¨¡å‹ä»£ç æ”¹åŠ¨æ¯”è¾ƒå¤§ï¼Œbatch sizeçš„è·å–å¯ä»¥é€šè¿‡åˆ¤æ–­Itemç‰¹å¾çš„é•¿åº¦æ¥è·å–ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚

åœ¨å®é™…çš„ä¸Šçº¿è¿‡ç¨‹ä¸­ï¼Œå›¢é˜Ÿç»å†äº†ä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åªå¯¹ç®—æ³•æ¨¡å‹ä»£ç åšä¿®æ”¹ï¼Œåœ¨å¤„ç†ç”¨æˆ·ç‰¹å¾æ—¶åªå–ç¬¬ä¸€ç»´ï¼Œä½†æ˜¯å®é™…å‘é€çš„æ¨ç†è¯·æ±‚è¿˜æ˜¯ä¼šæŠŠç”¨æˆ·ç‰¹å¾é‡å¤å¤šæ¬¡ï¼›ç¬¬äºŒä¸ªé˜¶æ®µæ‰æŠŠå‘é€çš„æ¨èè¯·æ±‚ä¼˜åŒ–æˆåªå‘é€ä¸€ä»½ç”¨æˆ·ç‰¹å¾ï¼Œè¿™ä¸ªæ—¶å€™æ¨¡å‹ä»£ç ä¸éœ€è¦å†åšä¿®æ”¹ï¼Œå·²ç»è‡ªåŠ¨é€‚é…ã€‚
 
![](https://img-blog.csdnimg.cn/img_convert/937ea89e460503042d68894f7357088b.png)
 
å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬ä¸€é˜¶æ®µçš„æ—¶å€™ç”¨æˆ·ç‰¹å¾çš„è¾“å…¥è¿˜æ˜¯é‡å¤å¤šæ¬¡ï¼Œåœ¨æ¨¡å‹ä¸­ï¼Œå¯¹ç”¨æˆ·ç‰¹å¾åªå–ç¬¬ä¸€ç»´å†è¿›è¡Œç‰¹å¾å¤„ç†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
![](https://img-blog.csdnimg.cn/img_convert/7797f8f9cf1abf87ca21128ae10a52c3.png)
 
ä¸Šé¢çš„æ¨¡å‹ä»£ç å¯ä»¥åŒæ—¶é€‚é…æ¨ç†è¯·æ±‚å‘é€é‡å¤çš„ç”¨æˆ·ç‰¹å¾ï¼Œæˆ–è€…åªå‘é€ä¸€æ¡ç”¨æˆ·ç‰¹å¾ã€‚å› æ­¤åœ¨ç¬¬äºŒé˜¶æ®µçš„æ—¶å€™ï¼Œä¸éœ€è¦å†ä¿®æ”¹æ¨¡å‹ä»£ç ï¼Œåªéœ€è¦ä¼˜åŒ–å‘é€æ¨ç†è¯·æ±‚çš„å¼•æ“ä¾§ä»£ç ã€‚
 
ç»è¿‡è¿™æ ·çš„ä¼˜åŒ–ï¼Œçº¿ä¸Šæ¨ç†æœåŠ¡ä¸éœ€è¦é‡å¤å‘é€ç”¨æˆ·ç‰¹å¾ï¼Œä¸ä»…èŠ‚çº¦äº†å¸¦å®½ï¼Œè€Œä¸”å‡å°‘äº†åºåˆ—åŒ–çš„æ¶ˆè€—ã€‚å¯¹ä¸€ä¸ª batch ä¸­çš„ç”¨æˆ·ç‰¹å¾åªåšä¸€ä»½æ•°æ®çš„Feature Columnè½¬æ¢ï¼Œç„¶ååšå¤åˆ¶æ“ä½œï¼Œå¤åˆ¶æ¶ˆè€—çš„æ—¶é—´è¿œè¿œå°äºè½¬æ¢çš„æ—¶é—´ã€‚

è¿™é‡Œå…¶å®è¿˜å¯ä»¥åšè¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå°†å¤åˆ¶æ“ä½œå»¶ååˆ°ç¬¬ä¸€å±‚ç¥ç»ç½‘ç»œçš„çŸ©é˜µä¹˜åé¢ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç¬¬ä¸€ä¸ªçŸ©é˜µä¹˜çš„éƒ¨åˆ†è®¡ç®—æ¶ˆè€—ã€‚å¦‚æœç”¨æˆ·ç‰¹å¾çš„ç»´åº¦å æ¯”æ¯”è¾ƒé«˜ï¼Œä¼˜åŒ–çš„æ•ˆæœä¼šæ¯”è¾ƒæ˜æ˜¾ã€‚
 


# ç»“æŸ


